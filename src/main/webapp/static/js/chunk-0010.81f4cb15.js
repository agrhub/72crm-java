(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0010"],{NoVw:function(e,t,a){"use strict";a.r(t);var n=a("ViDN"),i=a("utuE"),r=a("d8QR"),o=a("7Qib"),s={components:{CreateView:n.a,membersDep:i.a},data:function(){var e=this,t=function(t,a,n){"startTime"==t.field&&!e.formData.startTime&&e.formData.endTime||"endTime"==t.field&&!e.formData.endTime&&e.formData.startTime?n(new Error("Vui lòng chọn thời gian")):e.formData.startTime&&e.formData.endTime&&Object(o.e)(e.formData.startTime)>=Object(o.e)(e.formData.endTime)&&n(new Error("Thời gian bắt đầu phải nhỏ hơn thời gian kết thúc")),n()};return{formList:[{label:"Tên",field:"title"},{label:"Phòng ban",field:"dep",type:"plus"},{label:"Ngay bắt đầu",field:"startTime",type:"date"},{label:"Ngày kết thúc",field:"endTime",type:"date"},{label:"Nội dung",field:"content",type:"textarea"}],formData:{dep:{staff:[],dep:[]}},rules:{title:[{required:!0,message:"Tên không được trống",trigger:"blur"},{max:50,message:"Tên tối đa 50 ký tự",trigger:"blur"}],content:[{required:!0,message:"Nội dung không được trống",trigger:"blur"}],startTime:[{required:!0,message:"Phải chọn ngày",trigger:"blur"},{validator:t,trigger:"blur"}],endTime:[{required:!0,message:"Phải chọn ngày",trigger:"blur"},{validator:t,trigger:"blur"}]},loading:!1}},methods:{onSubmit:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return!1;e.loading=!0,Object(r.a)({title:e.formData.title,content:e.formData.content,startTime:e.formData.startTime,endTime:e.formData.endTime,deptIds:e.formData.dep.dep.map(function(e){return e.id}).join(","),ownerUserIds:e.formData.dep.staff.map(function(e){return e.userId}).join(",")}).then(function(t){e.$message.success("Thông báo mới đã gởi thành công"),1==e.$route.query.routerKey?e.$router.push("notice"):e.$emit("onSubmit"),e.loading=!1}).catch(function(){e.$message.error("Không gởi được thông báo mới"),e.loading=!1})})},close:function(){1==this.$route.query.routerKey?this.$router.go(-1):this.$emit("close")},popoverSubmit:function(e,t){this.$set(this.formData,"dep",{staff:e,dep:t})},deleteuser:function(e){this.formData.dep.staff.splice(e,1)},deleteDepuser:function(e){this.formData.dep.dep.splice(e,1)}}},l=(a("gJ79"),a("KHd+")),d=Object(l.a)(s,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("create-view",{attrs:{"body-style":{height:"100%"}}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"details-box"},[n("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[n("span",{staticClass:"text"},[e._v("Thông báo mới")]),e._v(" "),n("img",{staticClass:"el-icon-close rt",attrs:{src:a("cjwK"),alt:""},on:{click:e.close}})]),e._v(" "),n("div",{staticClass:"content"},[n("el-form",{ref:"form",attrs:{model:e.formData,rules:e.rules}},e._l(e.formList,function(t,a){return n("el-form-item",{key:a,class:"el-form-item"+t.field,attrs:{label:t.label,prop:t.field}},["date"==t.type?[n("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"Chọn"},model:{value:e.formData[t.field],callback:function(a){e.$set(e.formData,t.field,a)},expression:"formData[item.field]"}})]:"textarea"==t.type?[n("el-input",{attrs:{autosize:{minRows:6},type:"textarea",placeholder:"Nhập thông tin"},model:{value:e.formData[t.field],callback:function(a){e.$set(e.formData,t.field,a)},expression:"formData[item.field]"}})]:"plus"==t.type?[n("members-dep",{attrs:{"popover-display":"block",title:"Thông báo cho bộ phận","user-checked-data":e.formData[t.field].staff,"dep-checked-data":e.formData[t.field].dep},on:{popoverSubmit:e.popoverSubmit}},[n("flexbox",{staticClass:"user-container",attrs:{slot:"membersDep",wrap:"wrap"},slot:"membersDep"},[e._l(e.formData[t.field].staff,function(t,a){return n("div",{key:"user"+a,staticClass:"user-item",on:{click:function(t){t.stopPropagation(),e.deleteuser(a)}}},[e._v(e._s(t.realname)+"\n                  "),n("i",{staticClass:"delete-icon el-icon-close"})])}),e._v(" "),e._l(e.formData[t.field].dep,function(t,a){return n("div",{key:"dep"+a,staticClass:"user-item",on:{click:function(t){t.stopPropagation(),e.deleteDepuser(a)}}},[e._v(e._s(t.name)+"\n                  "),n("i",{staticClass:"delete-icon el-icon-close"})])}),e._v(" "),n("div",{staticClass:"add-item"},[e._v("+Thêm mới")])],2)],1)]:n("el-input",{model:{value:e.formData[t.field],callback:function(a){e.$set(e.formData,t.field,a)},expression:"formData[item.field]"}})],2)}))],1),e._v(" "),n("div",{staticClass:"btn-box"},[n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("Lưu")]),e._v(" "),n("el-button",{on:{click:e.close}},[e._v("Hủy")])],1)])])},[],!1,null,"d520ebd0",null);d.options.__file="newDialog.vue";t.default=d.exports},d8QR:function(e,t,a){"use strict";a.d(t,"d",function(){return i}),a.d(t,"a",function(){return r}),a.d(t,"b",function(){return o}),a.d(t,"c",function(){return s});var n=a("t3Un");function i(e){return Object(n.a)({url:"OaAnnouncement/queryList",method:"post",data:e})}function r(e){return Object(n.a)({url:"OaAnnouncement/saveAndUpdate",method:"post",data:e})}function o(e){return Object(n.a)({url:"OaAnnouncement/delete",method:"post",data:e})}function s(e){return Object(n.a)({url:"OaAnnouncement/readAnnouncement",method:"post",data:e})}},gJ79:function(e,t,a){"use strict";var n=a("mNnO");a.n(n).a},mNnO:function(e,t,a){}}]);