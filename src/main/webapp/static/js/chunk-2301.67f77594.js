(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2301","chunk-4f77","chunk-1c8d"],{"+6uu":function(t,e,i){},"+9th":function(t,e,i){"use strict";i.d(e,"k",function(){return n}),i.d(e,"a",function(){return s}),i.d(e,"d",function(){return l}),i.d(e,"e",function(){return o}),i.d(e,"g",function(){return c}),i.d(e,"h",function(){return r}),i.d(e,"b",function(){return d}),i.d(e,"f",function(){return u}),i.d(e,"c",function(){return h}),i.d(e,"j",function(){return m}),i.d(e,"i",function(){return p});var a=i("t3Un");function n(t){return Object(a.a)({url:"task/queryTaskList",method:"post",data:t})}function s(t){return Object(a.a)({url:"task/setTask",method:"post",data:t})}function l(t){return Object(a.a)({url:"task/deleteTask",method:"post",data:t})}function o(t){return Object(a.a)({url:"task/queryTaskInfo",method:"post",data:t})}function c(t){return Object(a.a)({url:"task/setTask",method:"post",data:t})}function r(t){return Object(a.a)({url:"task/saveTaskRelation",method:"post",data:t})}function d(t){return Object(a.a)({url:"taskLabel/setLabel",method:"post",data:t})}function u(t){return Object(a.a)({url:"taskLabel/setLabel",method:"post",data:t})}function h(t){return Object(a.a)({url:"taskLabel/deleteLabel",method:"post",data:t})}function m(t){return Object(a.a)({url:"taskLabel/getLabelList",method:"post",data:t})}function p(t){return Object(a.a)({url:"task/queryWorkTaskLog",method:"post",data:t})}},"+NTD":function(t,e,i){"use strict";var a=i("mX3o"),n=i("EgJF"),s=i("vG5h"),l=i("6zBA"),o=i("ooHJ"),c=i("7Qib"),r={name:"RelativeReturnMoney",components:{CRMCreateView:n.default,CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-660d"),i.e("chunk-4b7d"),i.e("chunk-7962")]).then(i.bind(null,"uMjE"))}},mixins:[a.a],props:{id:[String,Number],crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1},detail:{type:Object,default:function(){return{}}}},data:function(){return{list:[],fieldList:[],tableHeight:"250px",showFullDetail:!1,showFullCrmType:"receivables",showFullId:"",createCrmType:"receivables_plan",isCreate:!1,palnList:[],planFieldList:[],createActionInfo:{}}},computed:{},watch:{id:function(t){this.list=[],this.palnList=[],this.getList(),this.getPlanList()}},mounted:function(){this.planFieldList=[{prop:"num",width:"200",label:"Số kỳ"},{prop:"customerName",width:"200",label:"Tên khách hàng"},{prop:"contractNum",width:"200",label:"Mã hợp đồng"},{prop:"money",width:"200",label:"Số tiền thanh toán"},{prop:"returnDate",width:"200",label:"Ngày thành toán"},{prop:"returnType",width:"200",label:"Phương thức thanh toán"},{prop:"remind",width:"200",label:"Nhắc trước vài ngày"},{prop:"remark",width:"200",label:"Mô tả"}],this.getPlanList(),this.fieldList=[{prop:"receivablesNum",width:"200",label:"Mã biên nhận"},{prop:"contractName",width:"200",label:"Hợp đồng"},{prop:"contractMoney",width:"200",label:"Số tiền trên hợp đồng"},{prop:"receivablesMoney",width:"200",label:"Số tiền thanh toán"},{prop:"planNum",width:"200",label:"Số kỳ"},{prop:"ownerUserName",width:"200",label:"Người thanh toán"},{prop:"checkStatus",width:"200",label:"Trạng thái"},{prop:"returnTime",width:"200",label:"Ngày thanh toán"}],this.getList()},methods:{getPlanList:function(){var t=this;this.loading=!0,(0,{customer:s.s,contract:l.h}[this.crmType])(this.getParams()).then(function(e){t.loading=!1,t.palnList=e.data}).catch(function(){t.loading=!1})},getList:function(){var t=this;this.loading=!0,(0,{customer:s.r,contract:l.g}[this.crmType])(this.getParams()).then(function(e){t.loading=!1,t.list=e.data}).catch(function(){t.loading=!1})},getParams:function(){return"customer"===this.crmType?{customerId:this.id,pageType:0}:"contract"===this.crmType?{contractId:this.id,pageType:0}:{}},handleRowClick:function(t,e,i){this.showFullId=t.receivablesId,this.showFullCrmType="receivables",this.showFullDetail=!0},cellStyle:function(t){t.row,t.column,t.rowIndex;return 0==t.columnIndex?{color:"#3E84E9",textAlign:"center",cursor:"pointer"}:{textAlign:"center"}},planCellStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}},createClick:function(t){this.createActionInfo={type:"relative",crmType:this.crmType,data:{}},"money"==t?("contract"===this.crmType?(this.createActionInfo.data.customer=Object(c.k)(this.detail),this.createActionInfo.data.contract=Object(c.k)(this.detail)):"customer"===this.crmType&&(this.createActionInfo.data.customer=this.detail),this.createCrmType="receivables",this.isCreate=!0):"plan"==t&&("contract"===this.crmType?(this.createActionInfo.data.customer=Object(c.k)(this.detail),this.createActionInfo.data.contract=Object(c.k)(this.detail)):"customer"===this.crmType&&(this.createActionInfo.data.customer=this.detail),this.createCrmType="receivables_plan",this.isCreate=!0)},saveSuccess:function(){"receivables"==this.createCrmType?this.getList():this.getPlanList()},handleFile:function(t,e){var i=this;"edit"==t?(this.createActionInfo={type:"update",id:e.row.planId},this.createCrmType="receivables_plan",this.isCreate=!0):"delete"==t&&this.$confirm("Xác nhận xóa?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){Object(o.e)({planIds:e.row.planId}).then(function(t){i.palnList.splice(e.$index,1),i.$message.success("Thành công")}).catch(function(){})}).catch(function(){i.$message({type:"info",message:"Không thành công"})})},fieldFormatter:function(t,e,i){return"checkStatus"===e.property?this.getStatusName(t.checkStatus):["contractMoney","receivablesMoney","money"].includes(e.property)?Object(c.j)(i):i},getStatusName:function(t){return 0==t?"Đang chờ xử lý":1==t?"Đã duyệt":2==t?"Từ chối":3==t?"Đang xem xét":4==t?"Rút lại":5==t?"Chưa gởi":6==t?"Hủy":""},headerRowStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}},detailHandle:function(t){"delete"===t.type&&this.getList()}}},d=(i("ZiYz"),i("KHd+")),u=Object(d.a)(r,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"rc-cont"},[t.isSeas?t._e():i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){t.createClick("plan")}}},[t._v("Kế hoạch thanh toán mới")])],1),t._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:t.palnList,height:t.tableHeight,"header-cell-style":t.headerRowStyle,"cell-style":t.planCellStyle,stripe:""}},[t._l(t.planFieldList,function(e,a){return i("el-table-column",{key:a,attrs:{prop:e.prop,label:e.label,formatter:t.fieldFormatter,"show-overflow-tooltip":""}})}),t._v(" "),i("el-table-column",{attrs:{label:"Tùy chọn",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("flexbox",{attrs:{justify:"center"}},[i("el-button",{attrs:{type:"text"},nativeOn:{click:function(i){t.handleFile("edit",e)}}},[t._v("Chỉnh sửa")]),t._v(" "),i("el-button",{attrs:{type:"text"},nativeOn:{click:function(i){t.handleFile("delete",e)}}},[t._v("Xóa")])],1)]}}])})],2),t._v(" "),i("flexbox",{staticClass:"rc-head",staticStyle:{"margin-top":"15px"},attrs:{direction:"row-reverse"}},[t.isSeas?t._e():i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){t.createClick("money")}}},[t._v("Thanh toán mới")])],1),t._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:t.list,height:t.tableHeight,"header-cell-style":t.headerRowStyle,"cell-style":t.cellStyle,stripe:""},on:{"row-click":t.handleRowClick}},t._l(t.fieldList,function(e,a){return i("el-table-column",{key:a,attrs:{prop:e.prop,formatter:t.fieldFormatter,label:e.label,"show-overflow-tooltip":""}})})),t._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,"crm-type":t.showFullCrmType,id:t.showFullId},on:{"update:visible":function(e){t.showFullDetail=e},handle:t.detailHandle}}),t._v(" "),t.isCreate?i("c-r-m-create-view",{attrs:{"crm-type":t.createCrmType,action:t.createActionInfo},on:{"save-success":t.saveSuccess,"hiden-view":function(e){t.isCreate=!1}}}):t._e()],1)},[],!1,null,"17ec48d0",null);u.options.__file="RelativeReturnMoney.vue";e.a=u.exports},"/BxL":function(t,e,i){},"/U9q":function(t,e,i){"use strict";var a=i("mX3o"),n=i("EgJF"),s=i("vG5h"),l=i("UcQx"),o=i("mkuN"),c={name:"RelativeContacts",components:{CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-660d"),i.e("chunk-4b7d"),i.e("chunk-7962")]).then(i.bind(null,"uMjE"))},CRMCreateView:n.default,CrmRelative:o.a},mixins:[a.a],props:{id:[String,Number],crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1},detail:{type:Object,default:function(){return{}}}},data:function(){return{nopermission:!1,list:[],fieldList:[],tableHeight:"400px",showFullDetail:!1,isCreate:!1,contactsId:"",createActionInfo:{type:"relative",crmType:this.crmType,data:{}},showRelativeView:!1,selectionList:[]}},computed:{customerId:function(){return this.detail.customerId},canRelation:function(){return"business"==this.crmType}},watch:{id:function(t){this.list=[],this.getDetail()}},mounted:function(){this.getDetail()},activated:function(){},deactivated:function(){},methods:{checkRelativeInfos:function(t){var e=this;if(t.data.length>0){var i={businessId:this.id};i.contactsIds=t.data.map(function(t){return t.contactsId}).join(","),Object(l.l)(i).then(function(t){e.getDetail(),e.$message.success("Thành công")}).catch(function(){})}},unRelevanceHandleClick:function(){var t=this;0==this.selectionList.length?this.$message.error("Chưa chọn liên lạc"):this.$confirm("Xác nhận xóa?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){var e={businessId:t.id};e.contactsIds=t.selectionList.map(function(t){return t.contactsId}).join(","),Object(l.t)(e).then(function(e){t.getDetail(),t.$message.success("Thành công")}).catch(function(){})}).catch(function(){t.$message.info("Không thành công")})},getFieldList:function(){this.fieldList.push({prop:"name",width:"200",label:"Tên liên hệ"}),this.fieldList.push({prop:"mobile",width:"200",label:"Số điện thoại di động"}),this.fieldList.push({prop:"post",width:"200",label:"Số điện thoại bàn"})},getDetail:function(){var t=this;this.loading=!0;var e={customer:s.o,business:l.g}[this.crmType],i={};i[this.crmType+"Id"]=this.id,e(i).then(function(e){0==t.fieldList.length&&t.getFieldList(),t.nopermission=!1,t.loading=!1,t.list=e.data.list}).catch(function(e){102==e.code&&(t.nopermission=!0),t.loading=!1})},handleRowClick:function(t,e,i){this.contactsId=t.contactsId,this.showFullDetail=!0},headerRowStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}},cellStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}},createClick:function(){"customer"==this.crmType?this.createActionInfo.data.customer=this.detail:"business"==this.crmType&&(this.createActionInfo.data.customer=this.detail,this.createActionInfo.relativeData={businessId:this.detail.businessId}),this.isCreate=!0},createSaveSuccess:function(){this.canRelation?this.$refs.crmrelative.refreshList():this.getDetail()}}},r=(i("so1z"),i("KHd+")),d=Object(r.a)(c,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"empty",rawName:"v-empty",value:t.nopermission,expression:"nopermission"}],staticClass:"rc-cont",attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"Không có quyền"}},[t.isSeas?t._e():i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){return t.createClick(e)}}},[t._v("Thêm liên lạc mới")]),t._v(" "),t.canRelation?i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){return t.unRelevanceHandleClick(e)}}},[t._v("Xóa liên lạc")]):t._e(),t._v(" "),t.canRelation?i("el-popover",{staticStyle:{"margin-right":"20px"},attrs:{placement:"bottom",width:"700","popper-class":"no-padding-popover",trigger:"click"},model:{value:t.showRelativeView,callback:function(e){t.showRelativeView=e},expression:"showRelativeView"}},[i("crm-relative",{ref:"crmrelative",attrs:{show:t.showRelativeView,radio:!1,action:{type:"condition",data:{moduleType:"customer",customerId:t.customerId}},"selected-data":{contacts:t.list},"crm-type":"contacts"},on:{close:function(e){t.showRelativeView=!1},changeCheckout:t.checkRelativeInfos},model:{value:t.showRelativeView,callback:function(e){t.showRelativeView=e},expression:"showRelativeView"}}),t._v(" "),i("el-button",{staticClass:"rc-head-item",staticStyle:{"margin-right":"0"},attrs:{slot:"reference",type:"primary"},nativeOn:{click:function(e){t.showRelativeView=!0}},slot:"reference"},[t._v("Quan hệ")])],1):t._e()],1),t._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:t.list,height:t.tableHeight,"header-cell-style":t.headerRowStyle,"cell-style":t.cellStyle,stripe:""},on:{"row-click":t.handleRowClick,"selection-change":function(e){t.selectionList=e}}},[t.canRelation&&t.fieldList.length>0?i("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"selection",align:"center",width:"55"}}):t._e(),t._v(" "),t._l(t.fieldList,function(t,e){return i("el-table-column",{key:e,attrs:{prop:t.prop,label:t.label,"show-overflow-tooltip":""}})})],2),t._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,id:t.contactsId,"crm-type":"contacts"},on:{"update:visible":function(e){t.showFullDetail=e}}}),t._v(" "),t.isCreate?i("c-r-m-create-view",{attrs:{action:t.createActionInfo,"crm-type":"contacts"},on:{"save-success":t.createSaveSuccess,"hiden-view":function(e){t.isCreate=!1}}}):t._e()],1)},[],!1,null,"0dbbbee9",null);d.options.__file="RelativeContacts.vue";e.a=d.exports},"/bsb":function(t,e,i){},"0T5w":function(t,e,i){"use strict";var a=i("LnKz");i.n(a).a},"0lve":function(t,e,i){"use strict";var a=i("P7Ww");i.n(a).a},"1RnH":function(t,e,i){"use strict";var a=i("QbLZ"),n=i.n(a),s=i("+9th"),l=i("mkuN"),o=i("Er7M"),c=i("7Qib"),r=i("L2JU"),d={components:{CrmRelative:l.a,RelatedBusinessCell:o.a},props:{marginLeft:{type:String,default:"20px"},allData:{type:Object,default:function(){return{contacts:[],customer:[],business:[],contract:[]}}},isTask:{type:Boolean,default:!1},taskID:Number,alterable:{type:Boolean,default:!0},alterableColor:{type:String,default:"#999"}},data:function(){return{showTypes:["customer","contacts","business","contract"],showPopover:!1,relevanceAll:{customerIds:[],contractIds:[],contactsIds:[],businessIds:[]},relatedListData:{},showRelative:!1,showTaskRelative:!1}},computed:n()({},Object(r.b)(["crm"]),{showCRMPermission:function(){return this.crm}}),watch:{allData:function(){this.relatedListData=this.allData}},mounted:function(){this.relatedListData=this.allData},methods:{crmrelativeClose:function(){this.showPopover=!1},checkInfos:function(t){var e=this;this.showPopover=!1,this.relatedListData=t.data;var i=function(i){var a=t.data[i];e.relevanceAll[i+"Ids"]=a.map(function(t,e,a){return t[i+"Id"]})};for(var a in t.data)i(a);this.$emit("checkInfos",this.relevanceAll)},delRelevance:function(t,e,i){var a=this;this.$confirm("Xác nhận xóa?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning",customClass:"is-particulars"}).then(function(){var i={taskId:a.taskID},n=Object(c.k)(a.relatedListData);n[t].splice(e,1);for(var l=function(t){var e=a.showTypes[t],s=n[e]||[];i[e+"Ids"]=s.map(function(t){return t[e+"Id"]}).join(",")},o=0;o<a.showTypes.length;o++)l(o);Object(s.h)(i).then(function(i){a.relatedListData[t].splice(e,1),a.relatedListData=Object(c.k)(a.relatedListData),a.$message.success("Thành công")}).catch(function(){})}).catch(function(){a.$message.info("Không thành công")})},checkRelatedDetail:function(t,e){e.key=e[t+"Id"],this.$emit("checkRelatedDetail",t,e)}}},u=(i("uumG"),i("KHd+")),h=Object(u.a)(d,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"related-business",style:{"margin-left":t.marginLeft}},[!t.isTask&&t.alterable?a("el-popover",{attrs:{placement:"bottom",width:"800","popper-class":"no-padding-popover",trigger:"click"},model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}},[t.showRelative?a("crm-relative",{ref:"crmrelative",attrs:{show:t.showPopover,radio:!1,"selected-data":t.relatedListData,"show-types":t.showTypes},on:{close:t.crmrelativeClose,changeCheckout:t.checkInfos}}):t._e(),t._v(" "),t.showCRMPermission?a("p",{staticClass:"add-file",attrs:{slot:"reference"},on:{click:function(e){t.showRelative=!0}},slot:"reference"},[a("img",{attrs:{src:i("AFlK"),alt:""}}),t._v("\n      Cơ hội kinh doanh liên quan\n    ")]):t._e()],1):t._e(),t._v(" "),t.alterable?t._e():a("p",{staticClass:"alterable-p",style:{color:t.alterableColor}},[t._v("Cơ hội kinh doanh liên quan")]),t._v(" "),t._l(t.relatedListData,function(e,i){return a("div",{key:i},t._l(e,function(e,n){return a("related-business-cell",{key:n,attrs:{data:e,"cell-index":n,type:i,"show-foot":t.isTask},on:{unbind:t.delRelevance,detail:function(a){t.checkRelatedDetail(i,e)}}})}))}),t._v(" "),t.isTask?a("el-popover",{attrs:{placement:"bottom",width:"800","popper-class":"no-padding-popover",trigger:"click"},model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}},[t.showTaskRelative?a("crm-relative",{ref:"crmrelative",attrs:{radio:!1,show:t.showPopover,"selected-data":t.relatedListData,"show-types":t.showTypes},on:{close:t.crmrelativeClose,changeCheckout:t.checkInfos}}):t._e(),t._v(" "),t.showCRMPermission?a("p",{staticClass:"add-file",attrs:{slot:"reference"},on:{click:function(e){t.showTaskRelative=!0}},slot:"reference"},[a("img",{attrs:{src:i("AFlK"),alt:""}}),t._v("\n      Liên kết\n    ")]):t._e()],1):t._e()],2)},[],!1,null,"bcec8706",null);h.options.__file="relatedBusiness.vue";e.a=h.exports},"3vFt":function(t,e,i){},"3yi6":function(t,e,i){"use strict";var a=i("7Qib"),n=i("KzkL"),s={name:"FollowRecordCell",components:{CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-66f9"),i.e("chunk-660d"),i.e("chunk-4b7d"),i.e("chunk-4f77"),i.e("chunk-7962e")]).then(i.bind(null,"uMjE"))}},props:{item:{type:Object,default:function(){return{}}},crmType:{type:String,default:""},index:[String,Number]},data:function(){return{showFullDetail:!1,relationID:"",relationCrmType:""}},computed:{},mounted:function(){},methods:{previewImg:function(t,e){this.$bus.emit("preview-image-bus",{index:e,data:t.map(function(t,e,i){return t.url=t.filePath,t})})},downloadFile:function(t){Object(a.b)({path:t.filePath,name:t.name})},handleCommand:function(t){var e=this;this.$confirm("Xác nhận xóa?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){Object(n.p)({recordId:e.item.recordId}).then(function(i){e.$emit("on-handle",{type:t,data:{item:e.item,index:e.index}}),e.$message.success("Thành công")}).catch(function(){})}).catch(function(){e.$message({type:"info",message:"Không thành công"})})},checkRelationDetail:function(t,e){this.relationID=e,this.relationCrmType=t,this.showFullDetail=!0}}},l=(i("VPeB"),i("KHd+")),o=Object(l.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"fl-c"},[a("flexbox",{staticClass:"fl-h"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:{img:t.item.userImg,realname:t.item.realname},expression:"{img: item.userImg, realname: item.realname}"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.item.userImg),expression:"$options.filters.filterUserLazyImg(item.userImg)",arg:"background-image"}],staticClass:"div-photo fl-h-img"}),t._v(" "),a("div",{staticClass:"fl-h-b"},[a("div",{staticClass:"fl-h-name"},[t._v(t._s(t.item.realname))]),t._v(" "),a("div",{staticClass:"fl-h-time"},[t._v(t._s(t.item.createTime))])]),t._v(" "),a("flexbox",{staticClass:"fl-h-mark"},[a("img",{staticClass:"fl-h-mark-img",attrs:{src:i("N0PQ")}}),t._v(" "),a("div",{staticClass:"fl-h-mark-name"},[t._v("Hồ sơ theo dõi")])]),t._v(" "),a("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[a("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD","margin-left":"8px"}}),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"delete"}},[t._v("Xóa")])],1)],1)],1),t._v(" "),a("div",{staticClass:"fl-b"},[a("div",{staticClass:"fl-b-content"},[t._v(t._s(t.item.content))]),t._v(" "),t.item.img&&t.item.img.length>0?a("flexbox",{staticClass:"fl-b-images",attrs:{wrap:"wrap"}},t._l(t.item.img,function(e,i){return a("div",{directives:[{name:"lazy",rawName:"v-lazy:background-image",value:e.filePath,expression:"file.filePath",arg:"background-image"}],key:e.filePath,staticClass:"fl-b-img-item",on:{click:function(e){t.previewImg(t.item.img,i)}}})})):t._e(),t._v(" "),t.item.file&&t.item.file.length>0?a("div",{staticClass:"fl-b-files"},t._l(t.item.file,function(e,n){return a("flexbox",{key:n,staticClass:"cell"},[a("img",{staticClass:"cell-head",attrs:{src:i("6KEE")}}),t._v(" "),a("div",{staticClass:"cell-body"},[t._v(t._s(e.name)),a("span",{staticStyle:{color:"#ccc"}},[t._v("（"+t._s(e.size)+"）")])]),t._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:function(i){t.downloadFile(e)}}},[t._v("Tải về")])],1)})):t._e(),t._v(" "),t.item.category||t.item.nextTime?a("div",{staticClass:"follow"},[t.item.category?a("span",{staticClass:"follow-info"},[t._v(t._s(t.item.category))]):t._e(),t._v(" "),t.item.nextTime?a("span",{staticClass:"follow-info"},[t._v(t._s(t.item.nextTime))]):t._e()]):t._e(),t._v(" "),t.item.contactsList&&t.item.contactsList.length>0?a("div",{staticClass:"fl-b-other"},[a("div",{staticClass:"fl-b-other-name"},[t._v("Các địa chỉ liên hệ")]),t._v(" "),a("div",t._l(t.item.contactsList,function(e,i){return a("flexbox",{key:i,staticClass:"cell",nativeOn:{click:function(i){t.checkRelationDetail("contacts",e.contactsId)}}},[a("i",{staticClass:"wukong wukong-contacts cell-head crm-type",style:{opacity:0==i?1:0}}),t._v(" "),a("div",{staticClass:"cell-body",staticStyle:{color:"#6394E5",cursor:"pointer"}},[t._v(t._s(e.name))])])}))]):t._e(),t._v(" "),t.item.businessList&&t.item.businessList.length>0?a("div",{staticClass:"fl-b-other"},[a("div",{staticClass:"fl-b-other-name"},[t._v("Các cơ hội kinh doanh")]),t._v(" "),a("div",t._l(t.item.businessList,function(e,i){return a("flexbox",{key:i,staticClass:"cell",nativeOn:{click:function(i){t.checkRelationDetail("business",e.businessId)}}},[a("i",{staticClass:"wukong wukong-business cell-head crm-type",style:{opacity:0==i?1:0}}),t._v(" "),a("div",{staticClass:"cell-body",staticStyle:{color:"#6394E5",cursor:"pointer"}},[t._v(t._s(e.businessName))])])}))]):t._e(),t._v(" "),t._t("default")],2),t._v(" "),a("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,"crm-type":t.relationCrmType,id:t.relationID},on:{"update:visible":function(e){t.showFullDetail=e}}})],1)},[],!1,null,"6a5917be",null);o.options.__file="FollowRecordCell.vue";e.a=o.exports},"4HcF":function(t,e,i){"use strict";var a=i("4S5L");i.n(a).a},"4S5L":function(t,e,i){},"4tZP":function(t,e,i){"use strict";var a=i("ExMk"),n=i("Fpl1"),s=i("7z+D"),l=i("JXju"),o=i("QhmF"),c=i("+zsY"),r={components:{ExamineCell:n.a,ExamineDetail:s.a,CRMAllDetail:l.a,ExamineHandle:o.default,ExamineCreateView:c.a},props:{list:Array},data:function(){return{rowID:"",rowData:{},showDview:!1,relatedID:"",relatedCRMType:"",showRelatedDetail:!1,showExamineHandle:!1,isCreate:!1,createAction:{type:"update"},createInfo:{}}},watch:{list:function(){this.showRelatedDetail=!1,this.showDview=!1}},mounted:function(){},methods:{examineCellHandle:function(t){var e=this;if("edit"==t.type){var i=t.data.item;i.title=i.categoryName,this.createInfo=i,this.createAction={type:"update",id:i.examineId,data:i},this.isCreate=!0}else"delete"==t.type?this.$confirm("Xác nhận xóa?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){Object(a.d)({examineId:t.data.item.examineId}).then(function(t){e.searchBtn(),e.$message({type:"success",message:"Thành công!"})})}).catch(function(){e.$message({type:"info",message:"Không thành công"})}):"withdraw"==t.type?(this.rowID=t.data.item.examineId,this.rowData=t.data.item,this.showExamineHandle=!0):"view"==t.type?(this.showRelatedDetail=!1,this.rowID=t.data.item.examineId,this.showDview=!0):"related-detail"==t.type&&(this.showDview=!1,this.relatedID=t.data.item[t.data.type+"Id"],this.relatedCRMType=t.data.type,this.showRelatedDetail=!0)},handleResult:function(t){this.$emit("handle",t)}}},d=(i("X9SW"),i("KHd+")),u=Object(d.a)(r,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._l(t.list,function(e,a){return i("examine-cell",{key:a,attrs:{data:e},on:{"on-handle":t.examineCellHandle}})}),t._v(" "),t._t("load"),t._v(" "),t.showDview?i("examine-detail",{staticClass:"d-view",attrs:{id:t.rowID},on:{"on-examine-handle":function(e){t.handleResult("examine-detail")},"hide-view":function(e){t.showDview=!1}}}):t._e(),t._v(" "),i("c-r-m-all-detail",{attrs:{visible:t.showRelatedDetail,"crm-type":t.relatedCRMType,"listener-ids":["workbench-main-container"],"no-listener-ids":["examine-list-box"],id:t.relatedID},on:{"update:visible":function(e){t.showRelatedDetail=e}}}),t._v(" "),i("examine-handle",{attrs:{show:t.showExamineHandle,id:t.rowID,"record-id":t.rowData.examineRecordId,detail:t.rowData,"examine-type":"oa_examine",status:"4"},on:{close:function(e){t.showExamineHandle=!1},save:function(e){t.handleResult("examine-handle")}}}),t._v(" "),t.isCreate?i("examine-create-view",{attrs:{"category-id":t.createInfo.categoryId,type:t.createInfo.type,"category-title":t.createInfo.title,action:t.createAction},on:{"save-success":function(e){t.handleResult("edit")},"hiden-view":function(e){t.isCreate=!1}}}):t._e()],2)},[],!1,null,"4f1e9990",null);u.options.__file="examineSection.vue";e.a=u.exports},"5X97":function(t,e,i){},"5j45":function(t,e,i){"use strict";var a=i("mX3o"),n=i("EgJF"),s=i("vG5h"),l=i("qbf4"),o=i("mkuN"),c=i("7Qib"),r={name:"RelativeBusiness",components:{CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-660d"),i.e("chunk-4b7d"),i.e("chunk-7962")]).then(i.bind(null,"uMjE"))},CRMCreateView:n.default,CrmRelative:o.a},mixins:[a.a],props:{id:[String,Number],crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1},detail:{type:Object,default:function(){return{}}}},data:function(){return{nopermission:!1,list:[],fieldList:[],tableHeight:"400px",showFullDetail:!1,isCreate:!1,businessId:"",createActionInfo:{type:"relative",crmType:this.crmType,data:{}},showRelativeView:!1,selectionList:[]}},computed:{customerId:function(){return this.detail.customerId},canRelation:function(){return"contacts"==this.crmType}},watch:{id:function(t){this.list=[],this.getDetail()}},mounted:function(){this.getDetail()},activated:function(){},deactivated:function(){},methods:{checkRelativeInfos:function(t){var e=this;if(t.data.length>0){var i={contactsId:this.id};i.businessIds=t.data.map(function(t){return t.businessId}).join(","),Object(l.l)(i).then(function(t){e.getDetail(),e.$message.success("Thành công")}).catch(function(){})}},unRelevanceHandleClick:function(){var t=this;0==this.selectionList.length?this.$message.error("Chưa chọn cơ hội kinh doanh"):this.$confirm("Xóa cơ hội kinh doanh?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){var e={contactsId:t.id};e.businessIds=t.selectionList.map(function(t){return t.businessId}).join(","),Object(l.o)(e).then(function(e){t.getDetail(),t.$message.success("Thành công")}).catch(function(){})}).catch(function(){t.$message.info("Không thành công")})},getFieldList:function(){this.fieldList.push({prop:"businessName",width:"200",label:"Tên cơ hội"}),this.fieldList.push({prop:"money",width:"200",label:"Số tiền dự kiến"}),this.fieldList.push({prop:"customerName",width:"200",label:"Tên khách hàng"}),this.fieldList.push({prop:"typeName",width:"200",label:"Loại cơ hội"}),this.fieldList.push({prop:"statusName",width:"200",label:"Trạng thái"})},getDetail:function(){var t=this;this.loading=!0;var e={contacts:l.g,customer:s.n}[this.crmType],i={};i[this.crmType+"Id"]=this.id,e(i).then(function(e){0==t.fieldList.length&&t.getFieldList(),t.nopermission=!1,t.loading=!1,t.list=e.data.list}).catch(function(e){102==e.code&&(t.nopermission=!0),t.loading=!1})},handleRowClick:function(t,e,i){this.businessId=t.businessId,this.showFullDetail=!0},headerRowStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}},cellStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}},createClick:function(){"contacts"==this.crmType?(this.createActionInfo.data.customer=this.detail,this.createActionInfo.relativeData={contactsId:this.detail.contactsId}):"customer"==this.crmType&&(this.createActionInfo.data.customer=this.detail),this.isCreate=!0},createSaveSuccess:function(){this.canRelation?this.$refs.crmrelative.refreshList():this.getDetail()},fieldFormatter:function(t,e){return"money"==e.property?Object(c.j)(t[e.property]):t[e.property]||"--"}}},d=(i("i7tK"),i("KHd+")),u=Object(d.a)(r,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"empty",rawName:"v-empty",value:t.nopermission,expression:"nopermission"}],staticClass:"rc-cont",attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"Không có quyền"}},[t.isSeas?t._e():i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){return t.createClick(e)}}},[t._v("Thêm cơ hội kinh doanh mới")]),t._v(" "),t.canRelation?i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){return t.unRelevanceHandleClick(e)}}},[t._v("Xóa cơ hội kinh doanh")]):t._e(),t._v(" "),t.canRelation?i("el-popover",{staticStyle:{"margin-right":"20px"},attrs:{placement:"bottom",width:"700","popper-class":"no-padding-popover",trigger:"click"},model:{value:t.showRelativeView,callback:function(e){t.showRelativeView=e},expression:"showRelativeView"}},[i("crm-relative",{ref:"crmrelative",attrs:{show:t.showRelativeView,radio:!1,action:{type:"condition",data:{moduleType:"customer",customerId:t.customerId}},"selected-data":{business:t.list},"crm-type":"business"},on:{close:function(e){t.showRelativeView=!1},changeCheckout:t.checkRelativeInfos},model:{value:t.showRelativeView,callback:function(e){t.showRelativeView=e},expression:"showRelativeView"}}),t._v(" "),i("el-button",{staticClass:"rc-head-item",staticStyle:{"margin-right":"0"},attrs:{slot:"reference",type:"primary"},nativeOn:{click:function(e){t.showRelativeView=!0}},slot:"reference"},[t._v("Xem")])],1):t._e()],1),t._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:t.list,height:t.tableHeight,"header-cell-style":t.headerRowStyle,"cell-style":t.cellStyle,stripe:""},on:{"row-click":t.handleRowClick,"selection-change":function(e){t.selectionList=e}}},[t.canRelation&&t.fieldList.length>0?i("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"selection",align:"center",width:"55"}}):t._e(),t._v(" "),t._l(t.fieldList,function(e,a){return i("el-table-column",{key:a,attrs:{prop:e.prop,label:e.label,formatter:t.fieldFormatter,"show-overflow-tooltip":""}})})],2),t._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,id:t.businessId,"crm-type":"business"},on:{"update:visible":function(e){t.showFullDetail=e}}}),t._v(" "),t.isCreate?i("c-r-m-create-view",{attrs:{action:t.createActionInfo,"crm-type":"business"},on:{"save-success":t.createSaveSuccess,"hiden-view":function(e){t.isCreate=!1}}}):t._e()],1)},[],!1,null,"08a51d28",null);u.options.__file="RelativeBusiness.vue";e.a=u.exports},"62Ps":function(t,e,i){},"7F1U":function(t,e,i){},"7z+D":function(t,e,i){"use strict";var a=i("ExMk"),n=i("Ew9n"),s=i("EP+0"),l=i("3biH"),o=i("Er7M"),c=i("O1Uw"),r=i("7Qib"),d={name:"ExamineDetail",components:{SlideView:n.a,CreateSections:s.a,ExamineInfo:l.a,RelatedBusinessCell:o.a,CRMFullScreenDetail:function(){return i.e("chunk-1581").then(i.bind(null,"uMjE"))},FileCell:c.a},props:{id:[String,Number],noListenerClass:{type:Array,default:function(){return["list-box"]}}},data:function(){return{loading:!1,categoryId:"",type:"",detail:{examineRecordId:""},list:[],categoryName:"",fileList:[],imgList:[],travelList:[],travelField:[{prop:"vehicle",label:"Phương tiện"},{prop:"trip",label:"Công tác"},{prop:"startAddress",label:"Điểm đi"},{prop:"endAddress",label:"Điểm đến"},{prop:"startTime",label:"Ngày đi"},{prop:"endTime",label:"Ngày về"},{prop:"duration",label:"Thời gian (ngày)"},{prop:"description",label:"Mo tả lý do"}],expensesField:[{prop:"startAddress",label:"Điểm đi"},{prop:"endAddress",label:"Điểm đến"},{prop:"startTime",label:"Ngày đi"},{prop:"endTime",label:"Ngày về"},{prop:"traffic",label:"Đi lại (đồng)"},{prop:"stay",label:"Ở (đồng)"},{prop:"diet",label:"Ăn (đồng)"},{prop:"other",label:"Khác (đồng)"},{prop:"description",label:"Mô tả lý do"}],relatedID:"",relatedCRMType:"",showRelatedDetail:!1}},computed:{relatedListData:function(){return{contacts:this.detail.contactsList||[],customer:this.detail.customerList||[],business:this.detail.businessList||[],contract:this.detail.contractList||[]}}},watch:{id:function(t){this.getDetial()}},mounted:function(){this.getDetial()},methods:{getBaseInfo:function(){var t=this;this.loading=!0,Object(a.a)({examineId:this.id,isDetail:1}).then(function(e){t.list=e.data,t.loading=!1}).catch(function(){t.loading=!1})},getDetial:function(){var t=this;this.loading=!0,Object(a.j)({examineId:this.id}).then(function(e){t.loading=!1,t.categoryId=e.data.categoryId,t.type=e.data.type,t.getBaseInfo(),t.detail=e.data,t.categoryName=t.detail.category,t.fileList=t.detail.file,t.imgList=t.detail.img,t.travelList=t.detail.examineTravelList}).catch(function(){t.loading=!1})},hideView:function(){this.$emit("hide-view")},checkRelatedDetail:function(t,e){this.relatedID=e[t+"Id"],this.relatedCRMType=t,this.showRelatedDetail=!0},handleFile:function(t,e,i){if("preview"===t){if(e&&e.length>0){var a=e.map(function(t){return t.url=t.filePath,t});this.$bus.emit("preview-image-bus",{index:i,data:a})}}else"download"===t&&Object(r.b)({path:e.filePath,name:e.name})},imgZoom:function(t,e){this.$bus.emit("preview-image-bus",{index:e,data:t.map(function(t,e,i){return{url:t.filePath,name:t.name}})})},downloadFile:function(t){Object(r.b)({path:t.filePath,name:t.name})},examineHandle:function(t){this.$store.dispatch("GetOAMessageNum","examine"),this.$emit("on-examine-handle",t)}}},u=(i("GmC2"),i("KHd+")),h=Object(u.a)(d,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("slide-view",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"d-view",attrs:{"listener-ids":["workbench-main-container"],"no-listener-class":t.noListenerClass,"body-style":{padding:"10px 30px",height:"100%"}},on:{"side-close":t.hideView}},[a("flexbox",{staticStyle:{height:"100%"},attrs:{orient:"vertical"}},[a("flexbox",{staticClass:"detail-header"},[a("div",{staticClass:"header-name"},[t._v(t._s(t.categoryName))]),t._v(" "),a("img",{staticClass:"header-close",attrs:{src:i("cjwK")},on:{click:t.hideView}})]),t._v(" "),a("div",{staticClass:"detail-body"},[a("flexbox",{attrs:{gutter:0,align:"stretch",wrap:"wrap"}},t._l(t.list,function(e,n){return"examine_cause"!==e.formType&&"business_cause"!==e.formType?a("flexbox-item",{key:n,staticClass:"b-cell",attrs:{span:.5}},["checkbox"===e.formType?a("flexbox",{staticClass:"b-cell-b",attrs:{align:"stretch"}},[a("div",{staticClass:"b-cell-name"},[t._v(t._s(e.name))]),t._v(" "),a("div",{staticClass:"b-cell-value"},[a("flexbox",{staticStyle:{padding:"0px 10px 10px 0px"},attrs:{gutter:0,wrap:"wrap"}},t._l(e.value,function(e,i){return a("div",{key:i},[t._v("\n                  "+t._s(e)+"  \n                ")])}))],1)]):"file"===e.formType?a("flexbox",{staticClass:"b-cell-b",attrs:{align:"stretch"}},[a("div",{staticClass:"b-cell-name"},[t._v(t._s(e.name))]),t._v(" "),a("div",{staticClass:"b-cell-value"},t._l(e.value,function(n,s){return a("flexbox",{key:s,staticClass:"f-item"},[a("img",{staticClass:"f-img",attrs:{src:i("6KEE")}}),t._v(" "),a("div",{staticClass:"f-name"},[t._v(t._s(n.name.length>15?n.name.substring(0,15)+"...":n.name+"("+n.size+")"))]),t._v(" "),a("el-button",{attrs:{type:"text"},nativeOn:{click:function(i){t.handleFile("preview",e.value,s)}}},[t._v("Xem trước")]),t._v(" "),a("el-button",{attrs:{type:"text"},nativeOn:{click:function(e){t.handleFile("download",n,s)}}},[t._v("Tải")])],1)}))]):a("flexbox",{staticClass:"b-cell-b",attrs:{align:"stretch"}},[a("div",{staticClass:"b-cell-name"},[t._v(t._s(e.name))]),t._v(" "),a("div",{staticClass:"b-cell-value"},[t._v(t._s(e.value))])])],1):t._e()})),t._v(" "),t.fileList.length>0||t.imgList.length>0?a("div",{staticClass:"accessory"},[a("div",{staticClass:"upload-img-box"},t._l(t.imgList,function(e,i){return a("div",{key:i,staticClass:"img-list",on:{click:function(e){t.imgZoom(t.imgList,i)}}},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.filePath,expression:"imgItem.filePath"}],key:e.filePath})])})),t._v(" "),a("div",{staticClass:"accessory-box"},t._l(t.fileList,function(t,e){return a("file-cell",{key:e,attrs:{data:t,"cell-index":e}})}))]):t._e(),t._v(" "),t.type&&3==t.type&&t.travelList&&t.travelList.length>0?a("create-sections",{staticClass:"create-sections",attrs:{title:"Công tác"}},[a("el-table",{staticStyle:{"font-size":"13px"},attrs:{data:t.travelList,align:"center","header-align":"center",stripe:""}},t._l(t.travelField,function(e,i){return a("el-table-column",{key:i,attrs:{prop:e.prop,label:e.label,"show-overflow-tooltip":""},scopedSlots:t._u([{key:"header",fn:function(e){return[a("div",{staticClass:"table-head-name"},[t._v(t._s(e.column.label))])]}}])})}))],1):t._e(),t._v(" "),t.type&&5==t.type&&t.travelList&&t.travelList.length>0?a("create-sections",{staticClass:"create-sections",attrs:{title:"Thanh toán"}},[a("el-table",{staticStyle:{"font-size":"13px"},attrs:{data:t.travelList,align:"center","header-align":"center",stripe:""}},[t._l(t.expensesField,function(e,i){return a("el-table-column",{key:i,attrs:{prop:e.prop,label:e.label,"show-overflow-tooltip":""},scopedSlots:t._u([{key:"header",fn:function(e){return[a("div",{staticClass:"table-head-name"},[t._v(t._s(e.column.label))])]}}])})}),t._v(" "),a("el-table-column",{attrs:{label:"Hóa đơn",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("flexbox",{attrs:{justify:"center"}},[a("el-button",{attrs:{type:"text"},nativeOn:{click:function(i){t.handleFile("preview",e.row.img,0)}}},[t._v(t._s(e.row.img.length)+" hóa đơn")])],1)]}}])})],2)],1):t._e(),t._v(" "),t.relatedListData.contacts.length>0||t.relatedListData.customer.length>0||t.relatedListData.business.length>0||t.relatedListData.contract.length>0?a("create-sections",{staticClass:"create-sections",attrs:{title:"Hỗ trợ kinh doanh"}},[a("div",{staticClass:"related-business create-sections-content"},t._l(t.relatedListData,function(e,i){return a("div",{key:i},t._l(e,function(e,n){return a("related-business-cell",{key:n,attrs:{data:e,"cell-index":n,type:i,"show-foot":!1},nativeOn:{click:function(a){t.checkRelatedDetail(i,e)}}})}))}))]):t._e(),t._v(" "),a("create-sections",{staticClass:"create-sections",attrs:{title:"Xem lại thông tin"}},[a("examine-info",{staticClass:"create-sections-content",attrs:{id:t.id,"record-id":t.detail.examineRecordId,"examine-type":"oa_examine"},on:{"on-handle":t.examineHandle}})],1)],1)],1),t._v(" "),a("c-r-m-full-screen-detail",{attrs:{visible:t.showRelatedDetail,"crm-type":t.relatedCRMType,id:t.relatedID},on:{"update:visible":function(e){t.showRelatedDetail=e}}})],1)},[],!1,null,"3ab6eec2",null);h.options.__file="examineDetail.vue";e.a=h.exports},"8KPp":function(t,e,i){"use strict";var a=i("FyfS"),n=i.n(a),s=i("Qldq"),l=i("Iae0"),o=i("KzkL"),c={name:"JournalLog",components:{JournalCell:l.a,CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-660d"),i.e("chunk-4b7d"),i.e("chunk-7962")]).then(i.bind(null,"uMjE"))},NewDialog:function(){return i.e("chunk-0b2f").then(i.bind(null,"kFvY"))}},props:{id:[String,Number],crmType:{type:String,default:""}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[],rowID:"",showFullDetail:!1,detailCRMType:"",showNewDialog:!1,formData:{},dialogTitle:"",imgFileList:[],accessoryFileList:[],newLoading:!1}},computed:{},watch:{id:function(t){this.refreshList()}},mounted:function(){var t=this,e=document.getElementById("follow-log-content");e.onscroll=function(){var i=e.scrollTop+e.clientHeight-e.scrollHeight;Math.abs(i)<10&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var t=this;this.loading=!0;var e={page:this.page,limit:10};e[this.crmType+"Ids"]=this.id,Object(o.n)(e).then(function(e){t.list=t.list.concat(e.data.list),e.data.list.length<10?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.loading=!1,t.isPost=!1}).catch(function(){t.isPost=!1,t.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},jourecallCellHandle:function(t){var e=this;if("edit"==t.type){var i=t.data.item;if(this.showNewDialog=!0,this.dialogTitle="Chỉnh sửa nhật ký",this.formData=i,this.imgFileList=[],i.imgList){var a=!0,l=!1,o=void 0;try{for(var c,r=n()(i.imgList);!(a=(c=r.next()).done);a=!0){var d=c.value;d.url=d.filePath,this.imgFileList.push(d)}}catch(t){l=!0,o=t}finally{try{!a&&r.return&&r.return()}finally{if(l)throw o}}}if(this.accessoryFileList=[],i.fileList){var u=!0,h=!1,m=void 0;try{for(var p,f=n()(i.fileList);!(u=(p=f.next()).done);u=!0){var v=p.value;v.url=v.filePath,this.accessoryFileList.push(v)}}catch(t){h=!0,m=t}finally{try{!u&&f.return&&f.return()}finally{if(h)throw m}}}this.formData.depData=i.sendStructList?i.sendStructList:[],this.formData.sentWhoList=i.sendUserList?i.sendUserList:[]}else"delete"==t.type?this.$confirm("Xác nhận xóa?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){Object(s.b)({logId:t.data.item.logId}).then(function(i){for(var a in e.$message({type:"success",message:"Thành công!"}),e.list)if(e.list[a].logId==t.data.item.logId){e.list.splice(a,1);break}})}).catch(function(){e.$message({type:"info",message:"Không thành công"})}):"related-detail"==t.type&&(this.rowID=t.data.item.key,this.detailCRMType=t.data.type,this.showFullDetail=!0)},submitBtn:function(t,e,i,a){var l=this;this.newLoading=!0,console.log(a,"==relevanceAll==");var o=[],c=[],r=[];if(this.formData.depData){var d=!0,u=!1,h=void 0;try{for(var m,p=n()(this.formData.depData);!(d=(m=p.next()).done);d=!0){var f=m.value;r.push(f.id)}}catch(t){u=!0,h=t}finally{try{!d&&p.return&&p.return()}finally{if(u)throw h}}}var v=[];if(this.formData.sentWhoList){var g=!0,b=!1,y=void 0;try{for(var w,C=n()(this.formData.sentWhoList);!(g=(w=C.next()).done);g=!0){var _=w.value;v.push(_.id)}}catch(t){b=!0,y=t}finally{try{!g&&C.return&&C.return()}finally{if(b)throw y}}}var x=!0,k=!1,I=void 0;try{for(var T,L=n()(this.imgFileList);!(x=(T=L.next()).done);x=!0){var D=T.value;o.push(D.fileId)}}catch(t){k=!0,I=t}finally{try{!x&&L.return&&L.return()}finally{if(k)throw I}}var R=!0,A=!1,S=void 0;try{for(var E,j=n()(this.accessoryFileList);!(R=(E=j.next()).done);R=!0){var N=E.value;c.push(N.fileId)}}catch(t){A=!0,S=t}finally{try{!R&&j.return&&j.return()}finally{if(A)throw S}}var O={};O=a||{};var M={logId:this.formData.logId,categoryId:t,content:this.formData.content,tomorrow:this.formData.tomorrow,question:this.formData.question,file:c.concat(o),sendUserIds:v.join(","),sendStructureIds:r.join(","),customerIds:O.customerIds.join(","),contactsIds:O.contactsIds.join(","),businessIds:O.businessIds.join(","),contractIds:O.contractIds.join(",")};Object(s.c)(M).then(function(t){l.refreshList(),l.showNewDialog=!1,l.$message.success("Thành công"),l.newLoading=!1}).catch(function(){l.newLoading=!1,l.$message.error("Không thành công")})}}},r=(i("DqJb"),i("KHd+")),d=Object(r.a)(c,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length,expression:"list.length === 0"}]},[i("div",{staticClass:"log-items"},[t._l(t.list,function(e,a){return i("journal-cell",{key:a,staticClass:"list-cell",attrs:{data:e},on:{"on-handle":t.jourecallCellHandle}})}),t._v(" "),i("div",{staticClass:"load"},[i("el-button",{attrs:{loading:t.loadMoreLoading,type:"text"}},[t._v(t._s(t.loadMoreLoading?"Tải thêm":"Không có dữ liệu"))])],1)],2)]),t._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,"crm-type":t.detailCRMType,id:t.rowID},on:{"update:visible":function(e){t.showFullDetail=e}}}),t._v(" "),t.showNewDialog?i("new-dialog",{attrs:{"form-data":t.formData,"dialog-title":t.dialogTitle,"img-file-list":t.imgFileList,"accessory-file-list":t.accessoryFileList,"new-loading":t.newLoading},on:{close:function(e){t.showNewDialog=!1},submitBtn:t.submitBtn}}):t._e()],1)},[],!1,null,"74ea8a37",null);d.options.__file="JournalLog.vue";e.a=d.exports},AnnZ:function(t,e,i){"use strict";var a=i("BirF");i.n(a).a},B7ox:function(t,e,i){"use strict";var a=i("Qq94");i.n(a).a},BirF:function(t,e,i){},BuGm:function(t,e,i){"use strict";i.r(e);var a=i("gDS+"),n=i.n(a),s=i("FyfS"),l=i.n(s),o=i("Dh/N"),c=i("1RnH"),r=i("0hym"),d=i("7Qib"),u={components:{relatedBusiness:c.a,XhUser:r.a},props:{formData:{type:Object,default:function(){return{color:""}}},text:{type:String,default:"Tạo lịch biểu"},appendToBody:{type:Boolean,default:!1}},data:function(){var t=this,e=function(e,i,a){t.formData.startTime&&t.formData.endTime&&Object(d.e)(t.formData.startTime)>=Object(d.e)(t.formData.endTime)&&a(new Error("Thời gian bắt đầu phải nhỏ hơn thời gian kết thúc")),a()};return{zIndex:Object(d.h)(),formList:[{label:"Tên",field:"title",type:"color"},{label:"Giờ bắt đầu",field:"startTime",type:"time"},{label:"Giờ kết thức",field:"endTime",type:"time"},{label:"Người tham dự",field:"ownerUserIds",type:"participant"},{label:"Mô tả",field:"remark",type:"textarea",width:"100%"}],options:[{value:0,label:"Không nhắc"},{value:1,label:"Nhắc đúng giờ"},{value:2,label:"Nhắc trước 5 phút"},{value:3,label:"Nhắc trước 15 phút"},{value:4,label:"Nhắc trước 30 phút"},{value:5,label:"Nhắc trước 1 giờ"},{value:6,label:"Nhắc trước 2 giờ"},{value:7,label:"Nhắc trước 1 ngày"},{value:8,label:"Nhắc trước 2 ngày"},{value:9,label:"Nhắc trước 1 tuần"}],fileList:[],loading:!1,colorList:["#3E8EF7","#11C06C","#0BB2D4","#EB6709","#FF4C52","#526069","#9262F4"],rules:{title:[{required:!0,message:"Tên không được trống",trigger:"blur"},{max:50,message:"Tên tối đa 50 ký tự",trigger:"blur"}],startTime:[{required:!0,message:"Phải chọn giờ bắt đầu",trigger:"blur"},{validator:e,trigger:"blur"}],endTime:[{required:!0,message:"Phải chọn giờ kết thúc",trigger:"blur"},{validator:e,trigger:"blur"}]},relevanceAll:{},allData:{},colleaguesList:[]}},created:function(){},mounted:function(){this.appendToBody&&document.body.appendChild(this.$el),this.allData.business=this.formData.businessList?this.formData.businessList:[],this.allData.contacts=this.formData.contactsList?this.formData.contactsList:[],this.allData.contract=this.formData.contractList?this.formData.contractList:[],this.allData.customer=this.formData.customerList?this.formData.customerList:[],this.formData.ownerList&&(this.colleaguesList=[].concat(this.formData.ownerList)),"Tạo lịch biểu"==this.text&&this.$set(this.formData,"color","#3E8EF7")},beforeDestroy:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},methods:{close:function(){1==this.$route.query.routerKey?this.$router.go(-1):this.$emit("closeDialog")},checkInfos:function(t){this.relevanceAll=t},onSubmit:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return!1;t.loading=!0;var i=t.formData,a=[],s=!0,c=!1,r=void 0;try{for(var d,u=l()(t.colleaguesList);!(s=(d=u.next()).done);s=!0){var h=d.value;a.push(h.userId)}}catch(t){c=!0,r=t}finally{try{!s&&u.return&&u.return()}finally{if(c)throw r}}if("Tạo lịch biểu"==t.text)Object(o.a)({title:i.title,startTime:i.startTime,endTime:i.endTime,ownerUserIds:a.join(","),remark:i.remark,color:i.color,customerIds:t.relevanceAll.customerIds?t.relevanceAll.customerIds.join(","):[],contactsIds:t.relevanceAll.contactsIds?t.relevanceAll.contactsIds.join(","):[],businessIds:t.relevanceAll.businessIds?t.relevanceAll.businessIds.join(","):[],contractIds:t.relevanceAll.contractIds?t.relevanceAll.contractIds.join(","):[]}).then(function(e){1==t.$route.query.routerKey?t.$router.push("schedule"):t.$emit("onSubmit"),t.loading=!1}).catch(function(){t.loading=!1});else{var m={customerIds:[],contractIds:[],contactsIds:[],businessIds:[]};if(t.allData.customer){var p=!0,f=!1,v=void 0;try{for(var g,b=l()(t.allData.customer);!(p=(g=b.next()).done);p=!0){var y=g.value;m.customerIds.push(y.customerId)}}catch(t){f=!0,v=t}finally{try{!p&&b.return&&b.return()}finally{if(f)throw v}}}if(t.allData.contract){var w=!0,C=!1,_=void 0;try{for(var x,k=l()(t.allData.contract);!(w=(x=k.next()).done);w=!0){var I=x.value;m.contractIds.push(I.contractId)}}catch(t){C=!0,_=t}finally{try{!w&&k.return&&k.return()}finally{if(C)throw _}}}if(t.allData.contacts){var T=!0,L=!1,D=void 0;try{for(var R,A=l()(t.allData.contacts);!(T=(R=A.next()).done);T=!0){var S=R.value;m.contactsIds.push(S.contactsId)}}catch(t){L=!0,D=t}finally{try{!T&&A.return&&A.return()}finally{if(L)throw D}}}if(t.allData.business){var E=!0,j=!1,N=void 0;try{for(var O,M=l()(t.allData.business);!(E=(O=M.next()).done);E=!0){var F=O.value;m.businessIds.push(F.businessId)}}catch(t){j=!0,N=t}finally{try{!E&&M.return&&M.return()}finally{if(j)throw N}}}var B="{}"==n()(t.relevanceAll)?m:t.relevanceAll;Object(o.c)({eventId:i.eventId,title:i.title,startTime:i.startTime,endTime:i.endTime,ownerUserIds:a.join(","),remark:i.remark,color:i.color,customerIds:B.customerIds.join(","),contactsIds:B.contactsIds.join(","),businessIds:B.businessIds.join(","),contractIds:B.contractIds.join(",")}).then(function(e){t.$emit("onSubmit"),t.loading=!1}).catch(function(){t.loading=!1})}})},httpRequest:function(t){this.fileList.push(t.file)},onRemove:function(t){for(var e in this.fileList)this.fileList[e].uid==t.uid&&this.fileList.splice(e,1)},changeColor:function(t){this.$set(this.formData,"color",t)},changeCheckout:function(t){this.colleaguesList=t.data},selectDelect:function(t,e){this.$refs.xhuser[0].cancelCheckItem(t),this.colleaguesList.splice(e,1)}}},h=(i("h+C4"),i("KHd+")),m=Object(h.a)(u,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"create-schedule",style:{"z-index":t.zIndex}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"add-schedule"},[a("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"text"},[t._v(t._s(t.text))]),t._v(" "),a("img",{staticClass:"el-icon-close rt",attrs:{src:i("cjwK"),alt:""},on:{click:t.close}})]),t._v(" "),a("div",{staticClass:"content"},[a("el-form",{ref:"form",attrs:{model:t.formData,rules:t.rules}},t._l(t.formList,function(e,i){return a("el-form-item",{key:i,class:"el-form-item-"+e.field,style:{width:e.width},attrs:{prop:e.field,label:e.label}},["time"==e.type?[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"Chọn"},model:{value:t.formData[e.field],callback:function(i){t.$set(t.formData,e.field,i)},expression:"formData[item.field]"}})]:"textarea"==e.type?[a("el-input",{attrs:{autosize:{minRows:6},type:"textarea",placeholder:"Vui lòng nhập nội dung"},model:{value:t.formData[e.field],callback:function(i){t.$set(t.formData,e.field,i)},expression:"formData[item.field]"}})]:"participant"==e.type?[a("el-popover",{attrs:{placement:"bottom-end",width:"280",trigger:"click"}},[a("xh-user",{ref:"xhuser",refInFor:!0,attrs:{"selected-data":t.colleaguesList},on:{changeCheckout:t.changeCheckout}}),t._v(" "),a("div",{staticClass:"select-box",attrs:{slot:"reference"},slot:"reference"},[t._l(t.colleaguesList,function(e,i){return a("span",{key:i,staticClass:"select-box-span"},[t._v("\n                  "+t._s(e.realname)+"\n                  "),a("span",{staticClass:"el-icon-close",on:{click:function(a){a.stopPropagation(),t.selectDelect(e,i)}}})])}),t._v(" "),a("span",{staticClass:"el-icon-plus"})],2)],1)]:"select"==e.type?[a("el-select",{attrs:{placeholder:"Chọn"},model:{value:t.formData[e.field],callback:function(i){t.$set(t.formData,e.field,i)},expression:"formData[item.field]"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))]:"color"==e.type?[a("el-input",{attrs:{placeholder:"Vui lòng nhập nội dung"},model:{value:t.formData[e.field],callback:function(i){t.$set(t.formData,e.field,i)},expression:"formData[item.field]"}},[a("i",{staticClass:"el-input__icon",attrs:{slot:"prefix"},slot:"prefix"},[a("span",{staticClass:"bg-color",style:{background:t.formData.color}})])]),t._v(" "),a("div",{staticClass:"color-box"},t._l(t.colorList,function(e,i){return a("span",{key:i,style:{background:e},on:{click:function(i){t.changeColor(e)}}})}))]:a("el-input",{model:{value:t.formData[e.field],callback:function(i){t.$set(t.formData,e.field,i)},expression:"formData[item.field]"}})],2)})),t._v(" "),a("related-business",{attrs:{"all-data":t.allData},on:{checkInfos:t.checkInfos}})],1),t._v(" "),a("div",{staticClass:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("Lưu")]),t._v(" "),a("el-button",{on:{click:t.close}},[t._v("Hủy")])],1)])])},[],!1,null,"4bb86ca4",null);m.options.__file="createSchedule.vue";e.default=m.exports},Czda:function(t,e,i){},DPCt:function(t,e,i){},DUlf:function(t,e,i){"use strict";var a=i("mX3o"),n=i("eOzp"),s=i("vG5h"),l=i("UcQx"),o=i("6zBA"),c={name:"RelativeTeam",components:{TeamsHandle:n.a},mixins:[a.a],props:{id:[String,Number],detail:{type:Object,default:function(){return{}}},crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1}},data:function(){return{list:[],fieldList:[],tableHeight:"400px",teamsDialogShow:!1,handleType:1,editPermissionShow:!1,selectionList:[]}},computed:{},watch:{id:function(t){this.list=[],this.getDetail()}},mounted:function(){this.fieldList.push({prop:"realname",width:"200",label:"Họ và tên"}),this.fieldList.push({prop:"name",width:"200",label:"Chức vụ"}),this.fieldList.push({prop:"groupRole",width:"200",label:"Vai trò trong nhóm"}),this.fieldList.push({prop:"power",width:"200",label:"Quyền"}),this.getDetail()},activated:function(){},deactivated:function(){},methods:{getDetail:function(){var t=this;this.loading=!0;var e={customer:s.B,business:l.r,contract:o.o}[this.crmType],i={};i[this.crmType+"Id"]=this.id,e(i).then(function(e){t.loading=!1,t.list=e.data}).catch(function(){t.loading=!1})},handleSelectionChange:function(t){this.selectionList=t},handleClick:function(t){var e=this;"add"==t?this.teamsDialogShow=!0:0==this.selectionList.length?this.$message.error("Chưa chọn thành viên"):"edit"==t?this.editPermissionShow=!0:"remove"==t&&this.$confirm("Xác nhận xóa thành viên khỏi nhóm?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){var t=e.selectionList.map(function(t,e,i){return t.id}),i={customer:s.z,contract:o.m,business:l.n}[e.crmType],a={ids:e.id,memberIds:t.join(",")};e.loading=!0,i(a).then(function(t){e.$message({type:"success",message:"Thành công"}),e.loading=!1,e.getDetail()}).catch(function(){e.loading=!1})}).catch(function(){e.$message({type:"info",message:"Không thành công"})})},handleCallBack:function(t){this.getDetail()},handleEditConfirm:function(){var t=this,e=this.selectionList.map(function(t,e,i){return t.id});this.loading=!0,(0,{customer:s.D,business:l.u,contract:o.q}[this.crmType])({ids:this.id,memberIds:e.join(","),power:this.handleType}).then(function(e){t.editPermissionShow=!1,t.$message({type:"success",message:"Thành công"}),t.loading=!1,t.getDetail()}).catch(function(){t.loading=!1})},handleSelectable:function(t,e){return"Quản lý nhóm"!=t.power},handleRowClick:function(t,e,i){},headerRowStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}},cellStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}}}},r=(i("x6i0"),i("KHd+")),d=Object(r.a)(c,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"rc-cont"},[t.isSeas?t._e():i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){t.handleClick("remove")}}},[t._v("Xóa")]),t._v(" "),i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){t.handleClick("edit")}}},[t._v("Chỉnh sửa")]),t._v(" "),i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){t.handleClick("add")}}},[t._v("Thêm mới")])],1),t._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:t.list,height:t.tableHeight,"header-cell-style":t.headerRowStyle,"cell-style":t.cellStyle,stripe:""},on:{"row-click":t.handleRowClick,"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{selectable:t.handleSelectable,"show-overflow-tooltip":"",type:"selection",align:"center",width:"55"}}),t._v(" "),t._l(t.fieldList,function(t,e){return i("el-table-column",{key:e,attrs:{prop:t.prop,label:t.label,"show-overflow-tooltip":""}})})],2),t._v(" "),i("teams-handle",{attrs:{"crm-type":t.crmType,"selection-list":[t.detail],"dialog-visible":t.teamsDialogShow,title:"Thêm thành viên trong nhóm"},on:{"update:dialogVisible":function(e){t.teamsDialogShow=e},handle:t.handleCallBack}}),t._v(" "),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{visible:t.editPermissionShow,"append-to-body":!0,title:"Chỉnh sửa quyền",width:"400px"},on:{"update:visible":function(e){t.editPermissionShow=e}}},[i("div",{staticClass:"handle-box"},[i("flexbox",{staticClass:"handle-item"},[i("div",{staticClass:"handle-item-name"},[t._v("Quyền:")]),t._v(" "),i("el-radio-group",{model:{value:t.handleType,callback:function(e){t.handleType=e},expression:"handleType"}},[i("el-radio",{attrs:{label:1}},[t._v("Chỉ xem")]),t._v(" "),i("el-radio",{attrs:{label:2}},[t._v("Chỉnh sửa")])],1)],1)],1),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{nativeOn:{click:function(e){t.editPermissionShow=!1}}},[t._v("Đóng")]),t._v(" "),i("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.handleEditConfirm(e)}}},[t._v("Lưu")])],1)])],1)},[],!1,null,"763f508c",null);d.options.__file="RelativeTeam.vue";e.a=d.exports},"Dh/N":function(t,e,i){"use strict";i.d(e,"d",function(){return n}),i.d(e,"a",function(){return s}),i.d(e,"b",function(){return l}),i.d(e,"c",function(){return o});var a=i("t3Un");function n(t){return Object(a.a)({url:"OaEvent/queryList",method:"post",data:t})}function s(t){return Object(a.a)({url:"OaEvent/add",method:"post",data:t})}function l(t){return Object(a.a)({url:"OaEvent/delete",method:"post",data:t})}function o(t){return Object(a.a)({url:"OaEvent/update",method:"post",data:t})}},DqJb:function(t,e,i){"use strict";var a=i("3vFt");i.n(a).a},Fpl1:function(t,e,i){"use strict";var a=i("Er7M"),n=i("O1Uw"),s={name:"ExamineCell",components:{RelatedBusinessCell:a.a,FileCell:n.a},mixins:[],props:{data:Object},data:function(){return{}},computed:{relatedListData:function(){return{contacts:this.data.contactsList||[],customer:this.data.customerList||[],business:this.data.businessList||[],contract:this.data.contractList||[]}}},watch:{},mounted:function(){},methods:{getStatusName:function(t){return 0==t?"Đang chờ xử lý":1==t?"Đã duyệt":2==t?"Bị từ chối":3==t?"Đang xem xét":4==t?"Rút lại":""},getStatusColor:function(t){return 0==t?"#F3A633":1==t?"#93E06D":2==t?"#FF0000":3==t?"#F3A633":4==t?"#FF0000":""},imgZoom:function(t,e){this.$bus.emit("preview-image-bus",{index:e,data:t.map(function(t,e,i){return{url:t.filePath,name:t.name}})})},handleCommand:function(t){this.$emit("on-handle",{type:t,data:{item:this.data}})},checkDetail:function(t){this.$emit("on-handle",{type:"view",data:{item:this.data}})},checkRelatedDetail:function(t,e){this.$emit("on-handle",{type:"related-detail",data:{type:t,item:e}})}}},l=(i("4HcF"),i("KHd+")),o=Object(l.a)(s,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"list"},[i("div",{staticClass:"list-content"},[i("flexbox",{staticClass:"header"},[i("div",{directives:[{name:"photo",rawName:"v-photo",value:t.data.createUser,expression:"data.createUser"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.data.createUser.img),expression:"$options.filters.filterUserLazyImg(data.createUser.img)",arg:"background-image"}],staticClass:"div-photo head-img"}),t._v(" "),i("div",{staticClass:"name-time"},[i("span",{staticClass:"name"},[t._v(t._s(t.data.createUser.realname))]),t._v(" "),i("span",{staticClass:"time"},[t._v(t._s(t.data.createtime))])]),t._v(" "),i("div",{staticClass:"rt-setting"},[i("span",{staticClass:"bg-color",style:{"background-color":t.getStatusColor(t.data.examineStatus)}}),t._v(" "),i("span",{staticClass:"dep"},[i("span",[t._v(t._s(t.data.categoryTitle)+" - ")]),t._v(" "),i("span",[t._v(t._s(t.getStatusName(t.data.examineStatus)))])]),t._v(" "),t.data.permission&&(t.data.permission.isChecked||t.data.permission.isUpdate||t.data.permission.isDelete)?i("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[i("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD",cursor:"pointer"}}),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t.data.permission&&t.data.permission.isChecked?i("el-dropdown-item",{attrs:{command:"withdraw"}},[t._v("Rút lại")]):t._e(),t._v(" "),t.data.permission&&t.data.permission.isUpdate?i("el-dropdown-item",{attrs:{command:"edit"}},[t._v("Chỉnh sửa")]):t._e(),t._v(" "),t.data.permission&&t.data.permission.isDelete?i("el-dropdown-item",{attrs:{command:"delete"}},[t._v("Xóa")]):t._e()],1)],1):t._e()],1)]),t._v(" "),i("div",{staticClass:"row",on:{click:function(e){t.checkDetail(t.data)}}},[t.data.content?i("p",{staticClass:"text"},[t._v(t._s(t.data.content))]):t._e(),t._v(" "),t.data.causeTitle?i("p",{staticClass:"title"},[t._v(t._s(t.data.causeTitle))]):t._e()]),t._v(" "),t.data.file.length>0||t.data.img.length>0?i("div",{staticClass:"accessory"},[i("div",{staticClass:"upload-img-box"},t._l(t.data.img,function(e,a){return i("div",{key:a,staticClass:"img-list",on:{click:function(e){t.imgZoom(t.data.img,a)}}},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.filePath,expression:"imgItem.filePath"}]})])})),t._v(" "),i("div",{staticClass:"accessory-box"},t._l(t.data.file,function(t,e){return i("file-cell",{key:e,attrs:{data:t,"cell-index":e}})}))]):t._e(),t._v(" "),t.relatedListData.contacts.length>0||t.relatedListData.customer.length>0||t.relatedListData.business.length>0||t.relatedListData.contract.length>0?i("div",{staticClass:"related-business"},[i("div",{staticClass:"label"},[t._v("Hỗ trợ kinh doanh")]),t._v(" "),t._l(t.relatedListData,function(e,a){return i("div",{key:a},t._l(e,function(e,n){return i("related-business-cell",{key:n,attrs:{data:e,"cell-index":n,type:a,"show-foot":!1},nativeOn:{click:function(i){t.checkRelatedDetail(a,e)}}})}))})],2):t._e()],1)])},[],!1,null,"7cac94fc",null);o.options.__file="examineCell.vue";e.a=o.exports},GmC2:function(t,e,i){"use strict";var a=i("TeZM");i.n(a).a},GoYs:function(t,e,i){},GugH:function(t,e,i){"use strict";var a=i("KJoY");i.n(a).a},I0zU:function(t,e,i){},Iae0:function(t,e,i){"use strict";var a=i("QbLZ"),n=i.n(a),s=i("Xjjk"),l=i.n(s),o=i("S3Kq"),c=i("Qldq"),r=i("vPra"),d=i("1RnH"),u=i("L2JU"),h=i("O1Uw"),m={name:"JournalCell",components:{emoji:o.a,relatedBusiness:d.a,FileCell:h.a},mixins:[],props:{data:Object,logIndex:{type:Number,default:0},showWorkbench:{type:Boolean,default:!1}},data:function(){return{commentsTextarea:"",childCommentsTextarea:"",commentsPopover:!1,replyChildComment:null,replyChildIndex:-1,childCommentsPopover:!1,blurIndex:0,contentLoading:!1,parentTarget:null,awaitMoment:!1,replyList:[]}},computed:n()({},Object(u.b)(["userInfo"]),{allData:function(){var t={};return t.business=this.data.businessList,t.contacts=this.data.contactsList,t.contract=this.data.contractList,t.customer=this.data.customerList,t},allDataShow:function(){return 0!=this.data.businessList.length||0!=this.data.contactsList.length||0!=this.data.contractList.length||0!=this.data.customerList.length}}),watch:{},mounted:function(){var t=this;0!=this.data.isRead||this.showWorkbench||(this.$bus.on("journal-list-box-scroll",function(e){t.observePreview(e)}),this.observePreview(document.getElementById("journal-cell"+this.logIndex).parentNode)),this.replyList=this.data.replyList},beforeDestroy:function(){this.$bus.off("journal-list-box-scroll")},methods:{observePreview:function(t){var e=this;if(0==this.data.isRead){t&&(this.parentTarget=t);var i=this.whetherPreview();!this.awaitMoment&&i&&(this.awaitMoment=!0,setTimeout(function(){e.awaitMoment=!1,e.whetherPreview()&&e.submiteIsRead()},3e3))}},whetherPreview:function(){var t=this.parentTarget.children[this.logIndex];if(this.parentTarget.getBoundingClientRect()){var e=this.parentTarget.getBoundingClientRect().top-t.getBoundingClientRect().top,i=!1;return e<=0&&Math.abs(e)<this.parentTarget.clientHeight?i=!0:e>0&&e<t.clientHeight&&(i=!0),i}return!1},submiteIsRead:function(){var t=this;Object(c.e)({logId:this.showWorkbench?this.data.actionId:this.data.logId}).then(function(e){t.$store.dispatch("GetOAMessageNum","log"),t.data.isRead=1}).catch(function(){})},getCommentList:function(){var t=this;Object(r.b)({typeId:this.data.logId,type:1}).then(function(e){t.replyList=e.data}).catch(function(){})},verifyAwaitInfo:function(){},handleCommand:function(t){this.$emit("on-handle",{type:t,data:{item:this.data}})},checkRelatedDetail:function(t,e){this.$emit("on-handle",{type:"related-detail",data:{type:t,item:e}})},discussDelete:function(t,e,i){var a=this;this.$confirm("Xác nhận xóa?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){Object(r.a)({commentId:t.commentId}).then(function(t){a.$message({type:"success",message:"Thành công!"}),e.splice(i,1),a.$emit("on-handle",{type:"discuss-delete",data:{item:a.data}})})}).catch(function(){a.$message({type:"info",message:"Không thành công"})})},discussBtn:function(t,e){t.show?(this.$set(t,"show",!1),this.replyChildComment=null):(this.$set(t,"show",!0),this.$set(t,"showComment",!1),this.replyChildComment=t,this.replyChildIndex=e)},childCommentSubmit:function(){var t=this;if(this.replyChildComment&&this.childCommentsTextarea){var e=-1==this.replyChildIndex?this.replyChildComment:this.replyChildComment.childCommentList[this.replyChildIndex];this.contentLoading=!0,Object(r.c)({pid:e.userId,typeId:e.typeId,mainId:0==e.mainId?e.commentId:e.mainId,type:2,content:l()(this.childCommentsTextarea)}).then(function(i){t.childCommentsPopover=!1,i.data.user=t.userInfo,i.data.replyUser=e.user,t.replyChildComment.childCommentList.push(i.data),t.$message.success("Thành công"),t.replyChildComment.show=!1,t.replyChildComment=null,t.contentLoading=!1,t.childCommentsTextarea="",t.$emit("on-handle",{type:"discuss-submit",data:{item:t.data}})}).catch(function(){t.$message.error("Không thành công"),t.contentLoading=!1})}},commentSubmit:function(){var t=this;this.commentsTextarea&&(this.contentLoading=!0,Object(r.c)({typeId:this.showWorkbench?this.data.actionId:this.data.logId,type:2,content:l()(this.commentsTextarea)}).then(function(e){t.$set(t.data,"showComment",!1),e.data.childCommentList=[],e.data.show=!1,e.data.user=t.userInfo,t.replyList.push(e.data),t.commentsTextarea="",t.$message.success("Thành công"),t.contentLoading=!1}).catch(function(){t.$message.error("Không thành công"),t.contentLoading=!1}))},commentBtn:function(t){t.showComment?this.$set(t,"showComment",!1):(this.replyChildComment&&(this.replyChildComment.show=!1),this.$set(t,"showComment",!0))},selectEmoji:function(t){var e=this.commentsTextarea.split("");e.splice(this.blurIndex,0,t),this.commentsTextarea=e.join(""),this.commentsPopover=!1},childSelectEmoji:function(t){var e=this.childCommentsTextarea.split("");e.splice(this.blurIndex,0,t),this.childCommentsTextarea=e.join(""),this.childCommentsPopover=!1},blurFun:function(t){this.blurIndex=t.target.selectionEnd},imgZoom:function(t,e){this.$bus.emit("preview-image-bus",{index:e,data:t.map(function(t,e,i){return{url:t.filePath,name:t.name}})})}}},p=(i("wlfA"),i("KHd+")),f=Object(p.a)(m,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"list",attrs:{id:"journal-cell"+t.logIndex}},[a("div",{staticClass:"list-content"},[a("div",{staticClass:"header"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:t.data.createUser,expression:"data.createUser"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.data.createUser.img),expression:"$options.filters.filterUserLazyImg(data.createUser.img)",arg:"background-image"}],key:t.data.createUser.img,staticClass:"div-photo head-img header-circle"}),t._v(" "),a("div",{staticClass:"row"},[a("p",{staticClass:"row-title"},[a("span",{staticClass:"name"},[t._v(t._s(t.data.createUser.realname))]),t._v(" "),t.showWorkbench?a("span",{staticClass:"item-content"},[t._v(t._s(t.data.actionContent))]):a("span",{staticClass:"read",style:{color:0==t.data.isRead?"#3E84E9":"#ccc"}},[t._v(t._s(0==t.data.isRead?"Chưa đọc":"Đã đọc"))])]),t._v(" "),a("span",{staticClass:"time"},[t._v(t._s(t._f("moment")(t.data.createTime,"YYYY-MM-DD HH:mm")))]),t._v(" "),a("el-tooltip",{attrs:{disabled:!(t.data.sendUserList.length>0||t.data.sendDeptList.length>0),placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("div",{staticClass:"members-dep-title"},[t.data.sendUserList?a("span",t._l(t.data.sendUserList,function(e,i){return a("span",{key:i},[t._v("\n                  "+t._s(0==t.data.sendDeptList.length&&i==t.data.sendUserList.length-1?e.realname:e.realname+"，")+"\n                ")])})):t._e(),t._v(" "),t._l(t.data.sendDeptList,function(e,i){return a("span",{directives:[{name:"show",rawName:"v-show",value:0!=t.data.sendDeptList.legnth,expression:"data.sendDeptList.legnth != 0"}],key:i},[t._v("\n                "+t._s(i==t.data.sendDeptList.length-1?e.name:e.name+"，")+"\n              ")])})],2)]),t._v(" "),a("p",{staticClass:"row-title",staticStyle:{display:"inline-block"}},[t.data.sendDeptList?a("span",[t._v(t._s(t.data.sendDeptList.length)+" Phòng ban, ")]):t._e(),t._v(" "),t.data.sendUserList?a("span",[t._v(t._s(t.data.sendUserList.length)+" Nhân viên")]):t._e()])])],1),t._v(" "),!t.showWorkbench&&t.data.permission&&(t.data.permission.isUpdate||t.data.permission.isDelete)?a("div",{staticClass:"rt-setting"},[a("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[a("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD",cursor:"pointer"}}),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t.data.permission.isUpdate?a("el-dropdown-item",{attrs:{command:"edit"}},[t._v("Chỉnh sửa")]):t._e(),t._v(" "),t.data.permission.isDelete?a("el-dropdown-item",{attrs:{command:"delete"}},[t._v("Xóa")]):t._e()],1)],1)],1):t._e()]),t._v(" "),a("div",{staticClass:"text"},[t.data.content?a("p",{staticClass:"row"},[a("span",{staticClass:"title"},[t._v(t._s(1==t.data.categoryId?"Nội dung công việc hôm nay":2==t.data.categoryId?"Làm việc trong tuần này":"Làm việc trong tháng này")+"：")]),t._v(t._s(t.data.content))]):t._e(),t._v(" "),t.data.tomorrow?a("p",{staticClass:"row"},[a("span",{staticClass:"title"},[t._v(t._s(1==t.data.categoryId?"Nội dung công việc ngày mai":2==t.data.categoryId?"Nội dung công việc tuần sau":"Nội dung công việc tháng sau")+"：")]),t._v(t._s(t.data.tomorrow))]):t._e(),t._v(" "),t.data.question?a("p",{staticClass:"row"},[a("span",{staticClass:"title"},[t._v("Những vấn đề bắt gặp:")]),t._v(t._s(t.data.question))]):t._e()]),t._v(" "),a("div",{staticClass:"accessory"},[0!=t.data.img.length?a("div",{staticClass:"upload-img-box"},t._l(t.data.img,function(e,i){return a("div",{key:i,staticClass:"img-list",on:{click:function(e){t.imgZoom(t.data.img,i)}}},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.filePath,expression:"imgItem.filePath"}],key:e.filePath})])})):t._e(),t._v(" "),0!=t.data.file.length?a("div",{staticClass:"accessory-box"},t._l(t.data.file,function(t,e){return a("file-cell",{key:e,attrs:{data:t,"cell-index":e}})})):t._e()]),t._v(" "),t.allDataShow?a("related-business",{attrs:{"margin-left":"0",alterable:!1,"all-data":t.allData},on:{checkRelatedDetail:t.checkRelatedDetail}}):t._e(),t._v(" "),t.replyList&&0!=t.replyList.length?a("div",{staticClass:"discuss"},[a("div",{staticClass:"border"}),t._v(" "),t._l(t.replyList,function(e,n){return a("div",{key:n,staticClass:"discuss-list"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:e.user,expression:"discussItem.user"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(e.user.img),expression:"$options.filters.filterUserLazyImg(discussItem.user.img)",arg:"background-image"}],key:e.user.img,staticClass:"div-photo head-img header-circle"}),t._v(" "),a("span",{staticClass:"name"},[t._v(t._s(e.user.realname))]),t._v(" "),a("span",{staticClass:"time"},[t._v(t._s(e.createTime))]),t._v(" "),a("div",{staticClass:"rt"},[a("span",{on:{click:function(i){t.discussDelete(e,t.replyList,n)}}},[t._v("Xóa")]),t._v(" "),a("span",{on:{click:function(i){t.discussBtn(e,-1)}}},[t._v("Trả lời")])]),t._v(" "),a("p",{staticClass:"reply-title"},[a("span",{domProps:{innerHTML:t._s(t.emoji(e.content))}})]),t._v(" "),e.childCommentList&&e.childCommentList.length>0?a("div",{staticClass:"children-reply"},t._l(e.childCommentList,function(i,n){return a("div",{key:n,staticClass:"discuss-list"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:i.user,expression:"childDiscussItem.user"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(i.user.img),expression:"$options.filters.filterUserLazyImg(childDiscussItem.user.img)",arg:"background-image"}],key:i.user.img,staticClass:"div-photo head-img header-circle"}),t._v(" "),a("span",{staticClass:"name"},[t._v(t._s(i.user.realname))]),t._v(" "),a("span",{staticClass:"time"},[t._v(t._s(i.createTime))]),t._v(" "),a("div",{staticClass:"rt"},[a("span",{on:{click:function(a){t.discussDelete(i,e.childCommentList,n)}}},[t._v("Xóa")]),t._v(" "),a("span",{on:{click:function(i){t.discussBtn(e,n)}}},[t._v("Trả lời")])]),t._v(" "),a("p",{staticClass:"reply-title"},[[a("span",[t._v("Trả lời")]),t._v(" "),i.replyUser?a("span",{staticClass:"reply"},[t._v("@"+t._s(i.replyUser.realname)+"：")]):t._e()],t._v(" "),a("span",{domProps:{innerHTML:t._s(t.emoji(i.content))}})],2)])})):t._e(),t._v(" "),e.show?a("div",{staticClass:"comment-box"},[a("el-input",{attrs:{rows:2,type:"textarea",placeholder:"Nhập nội dung"},on:{blur:t.blurFun},model:{value:t.childCommentsTextarea,callback:function(e){t.childCommentsTextarea=e},expression:"childCommentsTextarea"}}),t._v(" "),a("div",{staticClass:"btn-group"},[a("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"},model:{value:t.childCommentsPopover,callback:function(e){t.childCommentsPopover=e},expression:"childCommentsPopover"}},[a("emoji",{on:{select:t.childSelectEmoji}}),t._v(" "),a("img",{staticClass:"smiling-img",attrs:{slot:"reference",src:i("woiz")},slot:"reference"})],1),t._v(" "),a("div",{staticClass:"btn-box"},[a("el-button",{attrs:{loading:t.contentLoading,type:"primary"},on:{click:function(e){t.childCommentSubmit()}}},[t._v("Lưu")]),t._v(" "),a("el-button",{on:{click:function(t){e.show=!1}}},[t._v("Hủy")])],1)],1)],1):t._e(),t._v(" "),a("div",{staticClass:"border"})])})],2):t._e()],1),t._v(" "),a("div",{staticClass:"footer"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-chat-line-round"},on:{click:function(e){t.commentBtn(t.data)}}},[t._v("Trả lời")])],1),t._v(" "),t.data.showComment?a("div",{staticClass:"comment-box"},[a("el-input",{attrs:{rows:3,type:"textarea",placeholder:"Nhập nội dung"},on:{blur:t.blurFun},model:{value:t.commentsTextarea,callback:function(e){t.commentsTextarea=e},expression:"commentsTextarea"}}),t._v(" "),a("div",{staticClass:"btn-group"},[a("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"},model:{value:t.commentsPopover,callback:function(e){t.commentsPopover=e},expression:"commentsPopover"}},[a("emoji",{on:{select:t.selectEmoji}}),t._v(" "),a("img",{staticClass:"smiling-img",attrs:{slot:"reference",src:i("woiz")},slot:"reference"})],1),t._v(" "),a("div",{staticClass:"btn-box"},[a("el-button",{attrs:{loading:t.contentLoading,type:"primary"},on:{click:function(e){t.commentSubmit()}}},[t._v("Lưu")]),t._v(" "),a("el-button",{on:{click:function(e){t.data.showComment=!1}}},[t._v("Hủy bỏ")])],1)],1)],1):t._e()])},[],!1,null,"1fb107c6",null);f.options.__file="journalCell.vue";e.a=f.exports},JXju:function(t,e,i){"use strict";var a=i("7Qib"),n=i("mqlf"),s=i("ppJE"),l=i("PS1M"),o=i("n1dw"),c=i("xfX+"),r=i("8gwX"),d=i("K6D0"),u={name:"CRMAllDetail",components:{ClueDetail:n.a,CustomerDetail:s.a,ContactsDetail:l.a,BusinessDetail:o.a,ContractDetail:c.a,ProductDetail:r.a,MoneyDetail:d.a},props:{id:[String,Number],crmType:{type:String,default:""},visible:{type:Boolean,default:!1},listenerIDs:{type:Array,default:function(){return["crm-main-container"]}},noListenerIDs:{type:Array,default:function(){return[]}},noListenerClass:{type:Array,default:function(){return["el-table__body"]}}},data:function(){return{tabName:""}},computed:{},watch:{crmType:function(t){"leads"==this.crmType?this.tabName="clue-detail":"customer"==this.crmType?this.tabName="customer-detail":"contacts"==this.crmType?this.tabName="contacts-detail":"business"==this.crmType?this.tabName="business-detail":"contract"==this.crmType?this.tabName="contract-detail":"product"==this.crmType?this.tabName="product-detail":"receivables"==this.crmType&&(this.tabName="money-detail")}},mounted:function(){this.visible&&(document.body.appendChild(this.$el),this.$el.style.zIndex=Object(a.h)())},destroyed:function(){this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},methods:{hiddenView:function(){this.$emit("update:visible",!1)},detailHandle:function(t){this.$emit("handle",t)}}},h=(i("AnnZ"),i("KHd+")),m=Object(h.a)(u,function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.id&&t.visible?i(t.tabName,{tag:"component",staticClass:"d-view",attrs:{"crm-type":t.crmType,id:t.id,"listener-ids":t.listenerIDs,"no-listener-ids":t.noListenerIDs},on:{handle:t.detailHandle,"hide-view":t.hiddenView}}):t._e()},[],!1,null,"30fef6ca",null);m.options.__file="CRMAllDetail.vue";e.a=m.exports},KJoY:function(t,e,i){},KKWy:function(t,e,i){},LEQn:function(t,e,i){},LnKz:function(t,e,i){},M9eM:function(t,e,i){},N0PQ:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjZGRjBCRTYxRTBBNzExRTg5QkREOEQxRjlDMkUxOUExIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjZGRjBCRTYyRTBBNzExRTg5QkREOEQxRjlDMkUxOUExIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NkZGMEJFNUZFMEE3MTFFODlCREQ4RDFGOUMyRTE5QTEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NkZGMEJFNjBFMEE3MTFFODlCREQ4RDFGOUMyRTE5QTEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz704RrgAAABwUlEQVR42uSXz0sCQRTH36h1sGNlaHjpVJoHC0KCOnVJOwSdqmM/6NZ/EF071rluQaduGQWd9BZEqWBhQQQmHYIQikDU6bs6G8Oy4q7sskYPPuzOzFu+++a9mZ1lnHNywlzkkDkm7JEb7/m8rWIDoVBHEc+DEuAaSmLMtqk+An6dfr8Ys0T4BHxJUbUzJq6q/yc47kR4CXg1fevgTcf3Faxp+vrAsuHikqxH054A5y2mWvYxnEaPwZTc/Kl1zJPJBt27gbR667YlnUjYMNWMORMxi8edETZhH+AZ9IIx4LZb+A5sieskGALfYMWW4hIFdQtmwJyIVt5gruEziucfrF5OVbAKZsGpzq42BVIQH+6suFovlRRQojnTzWethl73IO52wYaVEd+DcTDSaFUqRPV6c6RYJJ5ON8WJFqwuLkWl/7cWMhmE4SLm8xHP5YhFIkrEJPsYibhqQDgKCur3moXDROUy8Wy2KRoMqn5PZoQLBoSnxTf7otHyeonFYsSiUVlUsUMzwttAOfnV2my3e2ATvKjiFAjIPpdg30yOr0DYRL6VpbMDFoEPPIpz2EGrl2fyn0S3Hm8tNfbv/p1+BBgA+Vdv2Iz9D6cAAAAASUVORK5CYII="},O1Uw:function(t,e,i){"use strict";var a=i("7Qib"),n=i("KTTK"),s={name:"FileCell",props:{cellIndex:Number,data:Object,showFoot:{type:Boolean,default:!0},cursorPointer:{type:Boolean,default:!1},showDelete:{type:Boolean,default:!1},module_id:[String,Number]},data:function(){return{}},computed:{},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{downloadClick:function(){Object(a.b)({path:this.data.filePath,name:this.data.name})},deleteClick:function(){var t=this;this.$confirm("Xác nhận xóa?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){Object(n.c)({id:t.data.fileId}).then(function(e){t.$message.success("Thành công"),t.$emit("delete",t.cellIndex,t.data)}).catch(function(){})}).catch(function(){t.$message({type:"info",message:"Không thành công"})})}}},l=(i("aNXn"),i("KHd+")),o=Object(l.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("flexbox",{staticClass:"cell"},[a("img",{staticClass:"cell-head",attrs:{src:i("6KEE"),alt:""}}),t._v(" "),a("div",{staticClass:"cell-body",class:{"cursor-pointer":t.cursorPointer}},[a("span",[t._v(t._s(t.data.name.length>20?t.data.name.substring(0,20)+"...":t.data.name))]),t._v(" "),a("span",{staticClass:"size"},[t._v("("+t._s(t.data.size)+")")])]),t._v(" "),a("div",{staticClass:"cell-foot"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:t.downloadClick}},[t._v("Tải về")]),t._v(" "),t.showDelete?a("i",{staticClass:"el-icon-delete",on:{click:t.deleteClick}}):t._e()],1)])},[],!1,null,"4aac2a97",null);o.options.__file="index.vue";e.a=o.exports},OPCT:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjVENDNERTkxRTA5QjExRThBQkRDQjRERjVBMjY3MzE0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjVENDNERTkyRTA5QjExRThBQkRDQjRERjVBMjY3MzE0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NUQ0M0RFOEZFMDlCMTFFOEFCRENCNERGNUEyNjczMTQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NUQ0M0RFOTBFMDlCMTFFOEFCRENCNERGNUEyNjczMTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7c1/V2AAABIElEQVR42mL8//8/AwicPXuWgVxgbGwMZzMRUBsGxBeB+AXITigfL2DBIxcCxHlA7AnEz4CYB4gnQ+VW4dKEz4UNQBwNNQwEvgBxBhAn4XMhPgMFgPghmthPIP5NroF/cYgzkmsgMw7x/+Qa+AGIZbBEIgu5BjYC8VIgloLyQbE8E4gXkJtsVkMt3Ak1DOTiDiBeSa6BDFDNK0nJNdi8rArEa4H4IzQC0PFHqLwqMQaqA/ERID4IxIrQJIKOFaDyR6Dq8Xq5DYon4fHVe6g8J1RtMD4XugDxYiKDazYQu5GSbMgC6AbuAeJYIvWmAPEuQmFYDQ3w/1Cvv8dikCDU0mIgtifkwhtAbAdV+BBHsnkIlbeDqieYsG+ixxwpACDAAIZEQR7SM/O0AAAAAElFTkSuQmCC"},Op00:function(t,e,i){"use strict";var a=i("+9th"),n={name:"TaskCell",components:{},mixins:[],props:{data:Object,dataIndex:Number},data:function(){return{}},computed:{},watch:{},mounted:function(){},methods:{taskOverClick:function(t){var e=this;Object(a.g)({taskId:t.taskId,status:t.checked?5:1}).then(function(t){e.$store.dispatch("GetOAMessageNum","task")}).catch(function(){t.checked=!1})},rowFun:function(t){this.$emit("on-handle",{type:"view",data:{item:this.data,index:this.dataIndex}})},onmouseoverFun:function(t){this.$refs.itemSpan.offsetWidth>this.$refs.listLeft.offsetWidth-21?this.$set(t,"show",!0):this.$set(t,"show",!1)}}},s=(i("n5gA"),i("KHd+")),l=Object(s.a)(n,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"taskRow",staticClass:"list",style:{"border-left-color":1==t.data.priority?"#8bb5f0":2==t.data.priority?"#FF9668":3==t.data.priority?"#ED6363":"transparent"},on:{click:function(e){t.rowFun(t.data)}}},[i("div",{ref:"listLeft",staticClass:"list-left"},[i("div",{class:t.data.checked?"title title-active":"title",on:{click:function(t){t.stopPropagation()}}},[i("el-checkbox",{on:{change:function(e){t.taskOverClick(t.data)}},model:{value:t.data.checked,callback:function(e){t.$set(t.data,"checked",e)},expression:"data.checked"}})],1),t._v(" "),i("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"task-tooltip tooltip-change-border"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("span",[t._v(t._s(t.data.name))])]),t._v(" "),i("span",{ref:"itemSpan",class:t.data.checked?"item-name-active":"item-name"},[t._v("\n        "+t._s(t.data.name)+"\n      ")])])],1),t._v(" "),i("div",{staticClass:"list-right"},[t.data.labelList&&t.data.labelList.length>0?i("div",{staticClass:"tag-box"},[t.data.labelList.length<=2?t._l(t.data.labelList,function(e,a){return i("div",{key:a,staticClass:"item-label"},[i("span",{staticClass:"k-name",style:{background:e.color}},[t._v(t._s(e.labelName))])])}):[i("span",{staticClass:"k-name",style:{background:t.data.labelList[0].color}},[t._v(t._s(t.data.labelList[0].labelName))]),t._v(" "),i("span",{staticClass:"k-name",style:{background:t.data.labelList[1].color}},[t._v(t._s(t.data.labelList[1].labelName))]),t._v(" "),i("el-tooltip",{attrs:{placement:"top",effect:"light","popper-class":"tooltip-change-border task-tooltip"}},[i("div",{staticClass:"tooltip-content",staticStyle:{margin:"10px 10px 10px 0"},attrs:{slot:"content"},slot:"content"},t._l(t.data.labelList,function(e,a){return i("div",{key:a,staticClass:"item-label",staticStyle:{display:"inline-block","margin-right":"10px"}},[a>=2?i("span",{staticClass:"k-name",staticStyle:{"border-radius":"3px",color:"#FFF",padding:"3px 10px"},style:{background:e.color||"#ccc"}},[t._v(t._s(e.labelName))]):t._e()])})),t._v(" "),i("span",{staticClass:"color-label-more"},[i("i",[t._v("...")])])])]],2):t._e(),t._v(" "),i("div",{staticClass:"img-group"},[t.data.relationCount?i("div",{staticClass:"img-box"},[i("i",{staticClass:"wukong wukong-relevance"}),t._v(" "),i("span",[t._v(t._s(t.data.relationCount))])]):t._e(),t._v(" "),t.data.childAllCount>0?i("div",{staticClass:"img-box"},[i("i",{staticClass:"wukong wukong-sub-task"}),t._v(" "),i("span",[t._v(t._s(t.data.childWCCount)+"/"+t._s(t.data.childAllCount))])]):t._e(),t._v(" "),t.data.fileCount?i("div",{staticClass:"img-box"},[i("i",{staticClass:"wukong wukong-file"}),t._v(" "),i("span",[t._v(t._s(t.data.fileCount))])]):t._e(),t._v(" "),t.data.commentCount?i("div",{staticClass:"img-box"},[i("i",{staticClass:"wukong wukong-comment-task"}),t._v(" "),i("span",[t._v(t._s(t.data.commentCount))])]):t._e(),t._v(" "),t.data.stopTime?i("div",{staticClass:"img-box"},[i("i",{staticClass:"wukong wukong-time-task",style:{color:1!=t.data.isEnd||t.data.checked?"#999":"red"}}),t._v(" "),i("span",{style:{color:1!=t.data.isEnd||t.data.checked?"#999":"red"}},[t._v(t._s(t._f("moment")(t.data.stopTime,"MM-DD"))+" Lọc")])]):t._e()]),t._v(" "),i("div",{staticClass:"item-own-box"},[t.data.mainUser&&t.data.mainUser.id?i("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("span",[t._v(t._s(t.data.mainUser.realname))])]),t._v(" "),i("div",{directives:[{name:"photo",rawName:"v-photo",value:t.data.mainUser,expression:"data.mainUser"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.data.mainUser.img),expression:"$options.filters.filterUserLazyImg(data.mainUser.img)",arg:"background-image"}],staticClass:"div-photo"})]):t._e()],1)])])},[],!1,null,"fef6349e",null);l.options.__file="taskCell.vue";e.a=l.exports},P7Ww:function(t,e,i){},QJC7:function(t,e,i){"use strict";var a=i("3yi6"),n=i("5tgW"),s=i("vG5h"),l=i("qbf4"),o=i("UcQx"),c=i("6zBA"),r={name:"RecordLog",components:{FollowRecordCell:a.a},props:{id:[String,Number],crmType:{type:String,default:""}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[]}},computed:{},watch:{id:function(t){this.refreshList()}},mounted:function(){var t=this;this.$bus.on("follow-log-refresh",function(e){"record-log"==e.type&&t.refreshList()});var e=document.getElementById("follow-log-content");e.onscroll=function(){var i=e.scrollTop+e.clientHeight-e.scrollHeight;Math.abs(i)<10&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},activated:function(){},deactivated:function(){},beforeDestroy:function(){this.$bus.off("follow-log-refresh")},methods:{getList:function(){var t=this;this.loading=!0;var e={customer:s.v,leads:n.i,contacts:l.j,business:o.j,contract:c.j}[this.crmType],i={page:this.page,limit:10};i[this.crmType+"Id"]=this.id,e(i).then(function(e){t.list=t.list.concat(e.data),e.data.length<10?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.loading=!1,t.isPost=!1}).catch(function(){t.isPost=!1,t.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},cellHandle:function(t){"delete"==t.type&&this.list.splice(t.data.index,1)}}},d=(i("gs/v"),i("KHd+")),u=Object(d.a)(r,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length,expression:"list.length === 0"}]},[i("div",{staticClass:"log-items"},[t._l(t.list,function(e,a){return i("follow-record-cell",{key:a,attrs:{item:e,index:a,"crm-type":t.crmType},on:{"on-handle":t.cellHandle}})}),t._v(" "),i("div",{staticClass:"load"},[i("el-button",{attrs:{loading:t.loadMoreLoading,type:"text"}},[t._v(t._s(t.loadMoreLoading?"Tải thêm":"Không có dữ liệu"))])],1)],2)])])},[],!1,null,"cfac43fc",null);u.options.__file="RecordLog.vue";e.a=u.exports},QhQt:function(t,e,i){},Qldq:function(t,e,i){"use strict";i.d(e,"d",function(){return n}),i.d(e,"a",function(){return s}),i.d(e,"c",function(){return l}),i.d(e,"b",function(){return o}),i.d(e,"e",function(){return c});var a=i("t3Un");function n(t){return Object(a.a)({url:"OaLog/queryList",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:t})}function s(t){return Object(a.a)({url:"OaLog/addOrUpdate",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:t})}function l(t){return Object(a.a)({url:"OaLog/addOrUpdate",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:t})}function o(t){return Object(a.a)({url:"OaLog/deleteById",method:"post",data:t})}function c(t){return Object(a.a)({url:"OaLog/readLog",method:"post",data:t})}},Qq94:function(t,e,i){},R8hg:function(t,e,i){"use strict";var a=i("etft");i.n(a).a},"RU/L":function(t,e,i){i("Rqdy");var a=i("WEpk").Object;t.exports=function(t,e,i){return a.defineProperty(t,e,i)}},Rqdy:function(t,e,i){var a=i("Y7ZC");a(a.S+a.F*!i("jmDH"),"Object",{defineProperty:i("2faE").f})},S3Kq:function(t,e,i){"use strict";var a=i("GQeE"),n=i.n(a),s=i("sCIN"),l={name:"Emoji",data:function(){return{emojiData:s.a,pannels:["Công thức","Tự nhiên","Mục","Địa điểm","Ký hiệu"],activeIndex:0}},computed:{emojis:function(){var t=this;return this.pannels.map(function(e){return n()(t.emojiData[e])})}},created:function(){},methods:{changeActive:function(t){this.activeIndex=t},getPureName:function(t){return t.replace(/:/g,"")},selectItem:function(t){this.$emit("select",t)}}},o=(i("hIMY"),i("KHd+")),c=Object(o.a)(l,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"emoji"},[i("ul",{staticClass:"emoji-controller"},t._l(t.pannels,function(e,a){return i("li",{key:a,class:{active:a===t.activeIndex},on:{click:function(e){t.changeActive(a)}}},[t._v("\n      "+t._s(e)+"\n    ")])})),t._v(" "),i("ul",{staticClass:"emoji-container"},t._l(t.emojis,function(e,a){return a===t.activeIndex?i("li",{key:a,staticStyle:{padding:"0"}},[t._v("\n      "+t._s(e)+"--"+t._s(a)+"\n      "),t._l(e,function(e,a){return i("a",{key:a,attrs:{href:"javascript:;"},on:{click:function(i){t.selectItem(e)}}},[i("span",{staticClass:"emoji-item",class:"sprite-"+t.getPureName(e),attrs:{title:e}})])})],2):t._e()}))])},[],!1,null,"41e5b7aa",null);c.options.__file="emoji.vue";e.a=c.exports},SEkw:function(t,e,i){t.exports={default:i("RU/L"),__esModule:!0}},TeZM:function(t,e,i){},UEWd:function(t,e,i){"use strict";var a=i("7Qib"),n=i("KTTK"),s={name:"MixAdd",components:{CrmRelative:i("mkuN").a},props:{showRelativeBusiness:{type:Boolean,default:!1},showRelativeContacts:{type:Boolean,default:!1},id:[String,Number],crmType:{type:String,default:""}},data:function(){return{content:"",inputAutosize:{minRows:1,maxRows:6},barItems:[{img:i("S1Xc"),title:"Hình ảnh",type:"img",data:"image/*"},{img:i("rl4O"),title:"Đính kèm",type:"file",data:"*.*"}],imgFiles:[],files:[],business:[],contacts:[],showRelativeType:"",batchId:""}},computed:{},mounted:function(){this.showRelativeBusiness&&this.barItems.push({img:i("i91G"),title:"Cơ hội kinh doanh",type:"business",show:!1}),this.showRelativeContacts&&this.barItems.push({img:i("OPCT"),title:"Thông tin liên hệ",type:"contacts",show:!1}),this.$on("submit-info",function(){this.$emit("mixadd-info",{content:this.content,files:this.files,images:this.imgFiles,business:this.business,contacts:this.contacts,batchId:this.batchId})})},beforeDestroy:function(){this.$off("submit-info")},methods:{resetInfo:function(){this.content="",this.imgFiles=[],this.files=[],this.business=[],this.contacts=[],this.showRelativeType="",this.batchId=""},checkRelativeInfos:function(t){"business"==this.showRelativeType?this.business=t.data:"contacts"==this.showRelativeType&&(this.contacts=t.data)},barClick:function(t){this.showRelativeType=t.type,"business"==t.type?t.show=!0:"contacts"==t.type&&(t.show=!0)},uploadFile:function(t){var e=this,i=t.target.files;if(i.length){for(var a=0;a<i.length;a++){if(-1==i[a].type.indexOf("image")&&"img"==this.showRelativeType)return void this.$message.error("Vui lòng chọn đúng hình ảnh")}var n="image/*"==t.target.accept?"img":"file",s=i[0];this.sendFileRequest(s,n,function(){for(var a=1;a<i.length;a++){var s=i[a];e.sendFileRequest(s,n)}t.target.value=""})}},sendFileRequest:function(t,e,i){var s=this,l={file:t,type:e};this.batchId&&(l.batchId=this.batchId),Object(n.e)(l).then(function(n){""==s.batchId&&(s.batchId=n.batchId),n.size=Object(a.d)(t.size),"img"==e?s.imgFiles.push(n):(n.icon=Object(a.g)(t),s.files.push(n)),i&&i()}).catch(function(){})},deleteAllImg:function(){this.imgFiles=[]},deleteImgOrFile:function(t,e,i){var a=this;Object(n.c)({id:e.fileId}).then(function(e){"image"==t?a.imgFiles.splice(i,1):a.files.splice(i,1),a.$message.success("Thành công")}).catch(function(){})},mouseImgOver:function(t,e){t.showDelete=!0,this.$set(this.imgFiles,e,t)},mouseImgLeave:function(t,e){t.showDelete=!1,this.$set(this.imgFiles,e,t)},inputFocus:function(){var t=this;this.inputAutosize={minRows:3,maxRows:6},this.$nextTick(function(){t.$refs.textarea.resizeTextarea()})}}},l=(i("B7ox"),i("KHd+")),o=Object(l.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mix-container"},[a("div",{staticClass:"i-cont"},[a("el-input",{ref:"textarea",attrs:{autosize:t.inputAutosize,type:"textarea",clearable:"",resize:"none",placeholder:"Vui lòng nhập nội dung"},on:{focus:t.inputFocus},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),t._v(" "),t.imgFiles.length>0?a("section",{staticClass:"img-cont"},[a("flexbox",{attrs:{wrap:"wrap"}},[t._l(t.imgFiles,function(e,i){return a("div",{key:i,staticClass:"img-item",style:{"background-image":"url("+e.url+")"},on:{mouseover:function(a){t.mouseImgOver(e,i)},mouseleave:function(a){t.mouseImgLeave(e,i)}}},[e.showDelete?a("div",{staticClass:"img-delete",on:{click:function(a){t.deleteImgOrFile("image",e,i)}}},[t._v("×")]):t._e()])}),t._v(" "),a("div",{staticClass:"img-item-add"},[a("input",{staticClass:"img-item-iput",attrs:{type:"file",accept:"image/*",multiple:""},on:{change:t.uploadFile}})])],2),t._v(" "),a("div",{staticClass:"img-bar",on:{click:t.deleteAllImg}},[t._v("Xóa tất cả")])],1):t._e(),t._v(" "),t.files.length>0?a("section",{staticClass:"file-cont"},[a("flexbox",{staticClass:"f-header"},[a("img",{staticClass:"f-logo",attrs:{src:i("rl4O")}}),t._v(" "),a("div",{staticClass:"f-name"},[t._v("Đính kèm")])]),t._v(" "),a("div",{staticClass:"f-body"},t._l(t.files,function(e,i){return a("flexbox",{key:i,staticClass:"f-item"},[a("img",{staticClass:"f-img",attrs:{src:e.icon}}),t._v(" "),a("div",{staticClass:"f-name"},[t._v(t._s(e.name+"("+e.size+")"))]),t._v(" "),a("div",{staticClass:"close-button",on:{click:function(a){t.deleteImgOrFile("file",e,i)}}},[t._v("×")])])})),t._v(" "),a("div",{staticClass:"img-bar",on:{click:function(e){t.files=[]}}},[t._v("Xóa tất cả")])],1):t._e(),t._v(" "),t.business.length>0?a("section",{staticClass:"c-cont"},[a("flexbox",{staticClass:"c-header"},[a("img",{staticClass:"c-logo",attrs:{src:i("i91G")}}),t._v(" "),a("div",{staticClass:"c-name"},[t._v("Gởi")])]),t._v(" "),a("div",{staticClass:"c-body"},[a("flexbox",{attrs:{wrap:"wrap"}},t._l(t.business,function(e,i){return a("flexbox",{key:i,staticClass:"c-item"},[a("div",{staticClass:"c-item-name"},[t._v(t._s(e.businessName))]),t._v(" "),a("div",{staticClass:"c-item-close",on:{click:function(e){t.business.splice(i,1)}}},[t._v("×")])])}))],1)],1):t._e(),t._v(" "),t.contacts.length>0?a("section",{staticClass:"c-cont"},[a("flexbox",{staticClass:"c-header"},[a("img",{staticClass:"c-logo",attrs:{src:i("OPCT")}}),t._v(" "),a("div",{staticClass:"c-name"},[t._v("Người liên hệ")])]),t._v(" "),a("div",{staticClass:"c-body"},[a("flexbox",{attrs:{wrap:"wrap"}},t._l(t.contacts,function(e,i){return a("flexbox",{key:i,staticClass:"c-item"},[a("div",{staticClass:"c-item-name"},[t._v(t._s(e.name))]),t._v(" "),a("div",{staticClass:"c-item-close",on:{click:function(e){t.contacts.splice(i,1)}}},[t._v("×")])])}))],1)],1):t._e(),t._v(" "),a("flexbox",{staticClass:"bar-cont"},[t._l(t.barItems,function(e,i){return["img"==e.type||"file"==e.type?a("flexbox",{key:i,staticClass:"bar-item",nativeOn:{click:function(i){t.barClick(e)}}},[a("input",{staticClass:"bar-input",attrs:{accept:e.data,type:"file",multiple:""},on:{change:t.uploadFile}}),t._v(" "),a("img",{staticClass:"bar-img",attrs:{src:e.img}}),t._v(" "),a("div",{staticClass:"bar-title"},[t._v(t._s(e.title))])]):a("el-popover",{key:i,attrs:{placement:"bottom",width:"700","popper-class":"no-padding-popover",trigger:"click"},model:{value:e.show,callback:function(i){t.$set(e,"show",i)},expression:"item.show"}},[a("crm-relative",{ref:"crmrelative",refInFor:!0,attrs:{show:e.show,radio:!1,action:{type:"condition",data:{moduleType:t.crmType,customerId:t.id}},"selected-data":"business"==e.type?{business:t.business}:{contacts:t.contacts},"crm-type":e.type},on:{close:function(t){e.show=!1},changeCheckout:t.checkRelativeInfos}}),t._v(" "),a("flexbox",{staticClass:"bar-item",attrs:{slot:"reference"},nativeOn:{click:function(i){t.barClick(e)}},slot:"reference"},[a("img",{staticClass:"bar-img",attrs:{src:e.img}}),t._v(" "),a("div",{staticClass:"bar-title"},[t._v(t._s(e.title))])])],1)]})],2)],1)},[],!1,null,"604eed47",null);o.options.__file="MixAdd.vue";e.a=o.exports},ULJF:function(t,e,i){"use strict";i.d(e,"e",function(){return n}),i.d(e,"d",function(){return s}),i.d(e,"c",function(){return l}),i.d(e,"b",function(){return o}),i.d(e,"a",function(){return c});var a=i("t3Un");function n(t){return Object(a.a)({url:"biWork/logStatistics",method:"post",data:t})}function s(t){return Object(a.a)({url:"biWork/logStatisticsExport",method:"post",data:t,responseType:"blob",timeout:6e5})}function l(t){return Object(a.a)({url:"biWork/examineStatistics",method:"post",data:t})}function o(t){return Object(a.a)({url:"biWork/examineInfo",method:"post",data:t})}function c(t){return Object(a.a)({url:"biWork/examineStatisticsExport",method:"post",data:t,responseType:"blob",timeout:6e5})}},UllR:function(t,e,i){},VPeB:function(t,e,i){"use strict";var a=i("I0zU");i.n(a).a},X9SW:function(t,e,i){"use strict";var a=i("+6uu");i.n(a).a},YEIV:function(t,e,i){"use strict";e.__esModule=!0;var a=function(t){return t&&t.__esModule?t:{default:t}}(i("SEkw"));e.default=function(t,e,i){return e in t?(0,a.default)(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}},ZiYz:function(t,e,i){"use strict";var a=i("62Ps");i.n(a).a},aNXn:function(t,e,i){"use strict";var a=i("QhQt");i.n(a).a},"aQg/":function(t,e,i){"use strict";var a=i("d0bK"),n=i("Op00"),s=i("KzkL"),l=i("7Qib"),o={name:"TaskLog",components:{TaskCell:n.a,Particulars:function(){return Promise.all([i.e("chunk-660d"),i.e("chunk-4b7d"),i.e("chunk-631f")]).then(i.bind(null,"+Gvz"))}},mixins:[a.a],props:{id:[String,Number],crmType:{type:String,default:""}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[]}},computed:{},watch:{id:function(t){this.refreshList()}},mounted:function(){var t=this,e=document.getElementById("follow-log-content");e.onscroll=function(){var i=e.scrollTop+e.clientHeight-e.scrollHeight;Math.abs(i)<10&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var t=this;this.loading=!0;var e={page:this.page,limit:10};e[this.crmType+"Ids"]=this.id,Object(s.o)(e).then(function(e){e.data.list.forEach(function(t){5==t.status&&(t.checked=!0)}),t.list=t.list.concat(e.data.list),e.data.list.length<10?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.loading=!1,t.isPost=!1}).catch(function(){t.isPost=!1,t.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},taskCellHandle:function(t){var e=this;"view"==t.type&&this.showDetailView(t.data.item,t.data.index,function(){e.$nextTick(function(){document.body.appendChild(e.$refs.taskShade),e.$refs.taskShade.style.zIndex=Object(l.h)(),e.$refs.taskShade.addEventListener("click",e.handleDocumentClick,!1)})})},handleDocumentClick:function(t){t.stopPropagation(),this.$refs.taskShade==t.target&&(this.taskDetailShow=!1)}}},c=(i("dHxP"),i("KHd+")),r=Object(c.a)(o,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length,expression:"list.length === 0"}]},[i("div",{staticClass:"log-items"},[t._l(t.list,function(e,a){return i("task-cell",{key:a,attrs:{data:e,"data-index":a},on:{"on-handle":t.taskCellHandle}})}),t._v(" "),i("div",{staticClass:"load"},[i("el-button",{attrs:{loading:t.loadMoreLoading,type:"text"}},[t._v(t._s(t.loadMoreLoading?"Tải thêm":"Không còn dữ liệu"))])],1)],2)]),t._v(" "),t.taskDetailShow?i("div",{ref:"taskShade",staticClass:"full-container"},[i("particulars",{staticClass:"d-view",attrs:{id:t.taskID,"detail-index":t.detailIndex},on:{"on-handle":t.detailHandle,close:t.closeBtn}})],1):t._e()])},[],!1,null,"27faf482",null);r.options.__file="TaskLog.vue";e.a=r.exports},bH4c:function(t,e,i){"use strict";var a=i("/bsb");i.n(a).a},cYid:function(t,e,i){"use strict";var a=i("mX3o"),n=i("EgJF"),s=i("vG5h"),l=i("UcQx"),o=i("7Qib"),c={name:"RelativeContract",components:{CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-660d"),i.e("chunk-4b7d"),i.e("chunk-7962")]).then(i.bind(null,"uMjE"))},CRMCreateView:n.default},mixins:[a.a],props:{id:[String,Number],crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1},detail:{type:Object,default:function(){return{}}}},data:function(){return{nopermission:!1,list:[],fieldList:[],tableHeight:"400px",showFullDetail:!1,isCreate:!1,contractId:"",createActionInfo:{type:"relative",crmType:this.crmType,data:{}}}},computed:{},watch:{id:function(t){this.list=[],this.getDetail()}},mounted:function(){this.getDetail()},activated:function(){},deactivated:function(){},methods:{getFieldList:function(){this.fieldList.push({prop:"num",width:"200",label:"Số kỳ"}),this.fieldList.push({prop:"contractName",width:"200",label:"Hợp đồng"}),this.fieldList.push({prop:"customerName",width:"200",label:"Tên khách hàng"}),this.fieldList.push({prop:"money",width:"200",label:"Số tiền trong hợp đồng"}),this.fieldList.push({prop:"startTime",width:"200",label:"Ngày bắt đầu"}),this.fieldList.push({prop:"endTime",width:"200",label:"Ngày kết thúc"}),this.fieldList.push({prop:"checkStatus",width:"200",label:"Trạng thái"})},getDetail:function(){var t=this;this.loading=!0;var e={customer:s.p,business:l.h}[this.crmType],i={pageType:0};i[this.crmType+"Id"]=this.id,e(i).then(function(e){0==t.fieldList.length&&t.getFieldList(),t.nopermission=!1,t.loading=!1,t.list=e.data}).catch(function(e){102==e.code&&(t.nopermission=!0),t.loading=!1})},fieldFormatter:function(t,e){return"checkStatus"===e.property?this.getStatusName(t.checkStatus):"money"==e.property?Object(o.j)(t[e.property]):t[e.property]},getStatusName:function(t){return 0==t?"Chờ xử lý":1==t?"Đã duyệt":2==t?"Từ chối":3==t?"Đang xem xét":4==t?"Rút lại":5==t?"Chưa gởi":6==t?"Hủy":""},handleRowClick:function(t,e,i){this.contractId=t.contractId,this.showFullDetail=!0},headerRowStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}},cellStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}},createClick:function(){"business"==this.crmType?(this.createActionInfo.data.customer=this.detail,this.createActionInfo.data.business=this.detail):"customer"==this.crmType&&(this.createActionInfo.data.customer=this.detail),this.isCreate=!0},createSaveSuccess:function(){this.getDetail()}}},r=(i("GugH"),i("KHd+")),d=Object(r.a)(c,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"empty",rawName:"v-empty",value:t.nopermission,expression:"nopermission"}],staticClass:"rc-cont",attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"Không có quyền"}},[t.isSeas?t._e():i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){return t.createClick(e)}}},[t._v("Tạo hợp đồng mới\n    ")])],1),t._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:t.list,height:t.tableHeight,"header-cell-style":t.headerRowStyle,"cell-style":t.cellStyle,stripe:""},on:{"row-click":t.handleRowClick}},t._l(t.fieldList,function(e,a){return i("el-table-column",{key:a,attrs:{prop:e.prop,formatter:t.fieldFormatter,label:e.label,"show-overflow-tooltip":""}})})),t._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,id:t.contractId,"crm-type":"contract"},on:{"update:visible":function(e){t.showFullDetail=e}}}),t._v(" "),t.isCreate?i("c-r-m-create-view",{attrs:{action:t.createActionInfo,"crm-type":"contract"},on:{"save-success":t.createSaveSuccess,"hiden-view":function(e){t.isCreate=!1}}}):t._e()],1)},[],!1,null,"21ec09c9",null);d.options.__file="RelativeContract.vue";e.a=d.exports},d0bK:function(t,e,i){"use strict";e.a={components:{},data:function(){return{taskID:"",detailIndex:-1,taskDetailShow:!1}},mounted:function(){},methods:{closeBtn:function(){this.taskDetailShow=!1},showDetailView:function(t,e,i){this.taskID=t.taskId,this.detailIndex=e,this.taskDetailShow=!0,i&&i()},detailHandle:function(t){if(0==t.index||t.index)if("title-check"==t.type)this.$set(this.list[t.index],"checked",t.value);else if("delete"==t.type)this.list.splice(t.index,1);else if("change-stop-time"==t.type){new Date(t.value).getTime()/1e3+86399>new Date(new Date).getTime()/1e3?this.list[t.index].isEnd=!1:this.list[t.index].isEnd=!0,this.list[t.index].stopTime=t.value}else if("change-priority"==t.type)this.list[t.index].priority=t.value.id;else if("change-name"==t.type)this.list[t.index].name=t.value;else if("change-comments"==t.type){var e=this.list[t.index].commentCount;"add"==t.value?this.list[t.index].commentCount=e+1:this.list[t.index].commentCount=e-1}else"change-sub-task"==t.type&&(this.list[t.index].childWCCount=t.value.subdonecount,this.list[t.index].childAllCount=t.value.allcount)}},deactivated:function(){}}},dHxP:function(t,e,i){"use strict";var a=i("DPCt");i.n(a).a},etft:function(t,e,i){},gLe1:function(t,e,i){"use strict";i.r(e);var a=i("ULJF"),n=i("QbLZ"),s=i.n(n),l=i("Ew9n"),o=i("4tZP"),c={name:"ExamineList",components:{SlideView:l.a,ExamineSection:o.a},props:{request:Function,params:Object,listenerIDs:{type:Array,default:function(){return["crm-main-container"]}},noListenerIDs:{type:Array,default:function(){return[]}},noListenerClass:{type:Array,default:function(){return["el-table__body"]}}},data:function(){return{loading:!1,loadMoreLoading:!0,name:"",totalCount:0,sumData:"",isPost:!1,page:1,list:[]}},computed:{showDes:function(){return this.params.categoryId>1&&this.params.categoryId<=6},desInfo:function(){return 2==this.params.categoryId?"Tổng số ngày nghỉ phép":3==this.params.categoryId?"Tổng số ngày đi công tác":4==this.params.categoryId?"Tổng số ngày làm thêm":5==this.params.categoryId?"Tổng số tiền hoàn lại":6==this.params.categoryId?"Tổng số tiền vay":""},desUnit:function(){return this.params.categoryId>1&&this.params.categoryId<=4?"ngày":"đồng"}},watch:{params:function(){this.refreshList()}},mounted:function(){var t=this,e=document.getElementById("oa-log-statistics");e.onscroll=function(){var i=e.scrollTop+e.clientHeight-e.scrollHeight;Math.abs(i)<10&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},methods:{refreshList:function(){this.page=1,this.list=[],this.name="",this.sumData="",this.totalCount=0,this.getList()},getList:function(){var t=this;this.loading=!0,this.request(s()({page:this.page,limit:15},this.params)).then(function(e){t.name=e.data.categoryName,t.sumData="ngày"==t.desUnit?e.data.duration:e.data.money,t.list=t.list.concat(e.data.list),t.totalCount=e.data.totalRow,!0===e.data.lastPage?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.isPost=!1,t.loading=!1}).catch(function(){t.isPost=!1,t.loading=!1})},hideView:function(){this.$emit("hide")}}},r=(i("pCO6"),i("KHd+")),d=Object(r.a)(c,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("slide-view",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"d-view",attrs:{"listener-ids":t.listenerIDs,"no-listener-ids":t.noListenerIDs,"no-listener-class":t.noListenerClass,"body-style":{padding:0,height:"100%"}},on:{"side-close":t.hideView}},[t.loading?t._e():a("div",{staticClass:"t-section"},[a("span",{staticClass:"t-name"},[t._v(t._s(t.name))]),t._v(" \n    "),a("span",{staticClass:"t-des"},[t._v("("+t._s(t.name)+"Số đề xuất："),a("span",{staticClass:"t-value"},[t._v(t._s(t.totalCount)+"lượt")])]),t._v(" "),t.showDes?a("span",{staticClass:"t-des"},[t._v("    "+t._s(t.desInfo)+"："),a("span",{staticClass:"t-value"},[t._v(t._s(t.sumData+t.desUnit))])]):t._e(),a("span",{staticClass:"t-des"},[t._v(") ")]),t._v(" "),a("img",{staticClass:"t-close",attrs:{src:i("cjwK")},on:{click:t.hideView}})]),t._v(" "),a("examine-section",{staticClass:"t-content",attrs:{id:"oa-log-statistics",list:t.list},on:{handle:t.refreshList}},[a("p",{staticClass:"load",attrs:{slot:"load"},slot:"load"},[a("el-button",{attrs:{loading:t.loadMoreLoading,type:"text"}},[t._v(t._s(t.loadMoreLoading?"Tải thêm":"Không có dữ liệu"))])],1)])],1)},[],!1,null,"6fac4db3",null);d.options.__file="examineList.vue";var u=d.exports,h={name:"ExamineStatistics",components:{filtrateHandleView:i("gXW+").a,ExamineList:u},data:function(){return{loading:!1,tableHeight:document.documentElement.clientHeight-190,postParams:{},list:[],fieldList:[],indexParams:{},showList:!1}},computed:{indexRequest:function(){return a.b}},mounted:function(){var t=this;window.onresize=function(){t.tableHeight=document.documentElement.clientHeight-190}},methods:{getDataList:function(t){var e=this;this.postParams=t,this.loading=!0,Object(a.c)(t).then(function(t){e.fieldList=e.getFieldList(t.data.categoryList||[]),e.list=t.data.userList||[],e.loading=!1}).catch(function(){e.loading=!1})},getFieldList:function(t){return[{name:"Nhân viên",width:100,field:"realname"}].concat(t.map(function(t){var e=0;return e=t.title&&t.title.length<=6?15*t.title.length+45:140,{name:t.title,width:e,field:"count_"+t.categoryId}}))},fieldFormatter:function(t,e){return t[e.property]||"--"},cellStyle:function(t){var e=t.row,i=t.column;t.rowIndex,t.columnIndex;return"realname"!==i.property&&e[i.property]?{color:"#3E84E9",cursor:"pointer"}:""},handleRowClick:function(t,e,i){if("realname"!==e.property&&t[e.property]){var a=e.property.split("_"),n=a.length>1?a[1]:"",s={userId:t.userId,categoryId:n};this.postParams.type?s.type=this.postParams.type:(s.startTime=this.postParams.startTime,s.endTime=this.postParams.endTime),this.indexParams=s,this.showList=!0}},exportExcel:function(){var t=this;this.loading=!0,Object(a.a)(this.postParams).then(function(e){t.loading=!1;var i=new Blob([e.data],{type:"application/vnd.ms-excel;charset=utf-8"}),a=document.createElement("a"),n=window.URL.createObjectURL(i);a.href=n,a.download=decodeURI(e.headers["content-disposition"].split("filename=")[1])||"",document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(n)}).catch(function(){t.loading=!1})}}},m=(i("k9yM"),Object(r.a)(h,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"main-container"},[i("filtrate-handle-view",{staticClass:"filtrate-bar",attrs:{"module-type":"oa"},on:{load:function(e){t.loading=!0},change:t.getDataList}},[i("el-button",{staticClass:"export-button",attrs:{type:"primary"},nativeOn:{click:function(e){return t.exportExcel(e)}}},[t._v("Xuất báo cáo")])],1),t._v(" "),i("div",{staticClass:"content"},[i("div",{staticClass:"table-content"},[i("el-table",{attrs:{data:t.list,height:t.tableHeight,"cell-style":t.cellStyle,stripe:"",border:"","show-overflow-tooltip":"","highlight-current-row":""},on:{"row-click":t.handleRowClick}},t._l(t.fieldList,function(e,a){return i("el-table-column",{key:a,attrs:{fixed:0==a,formatter:t.fieldFormatter,prop:e.field,"min-width":e.width,label:e.name,align:"center","header-align":"center"}})}))],1)]),t._v(" "),t.showList?i("examine-list",{attrs:{request:t.indexRequest,params:t.indexParams},on:{hide:function(e){t.showList=!1}}}):t._e()],1)},[],!1,null,"928efdda",null));m.options.__file="examine.vue";e.default=m.exports},"gXW+":function(t,e,i){"use strict";var a=i("KTTK"),n=i("UcQx"),s=i("conU"),l=i("uKQN"),o=i("wd/R"),c=i.n(o),r={name:"FiltrateHandleView",components:{timeTypeSelect:l.a},props:{moduleType:{required:!0,type:String},showYearSelect:{default:!1,type:Boolean},showBusinessSelect:{default:!1,type:Boolean},showUserSelect:{default:!0,type:Boolean},showCustomSelect:{default:!1,type:Boolean},customDefault:"",customOptions:{default:function(){return[]},type:Array},showProductSelect:{default:!1,type:Boolean}},data:function(){return{pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()}},yearValue:"",timeTypeValue:{},structuresProps:{children:"children",label:"label",value:"id"},deptList:[],structuresSelectValue:"",userOptions:[],userSelectValue:"",businessOptions:[],businessStatusValue:"",productValue:[],productOptions:[],customValue:""}},watch:{},mounted:function(){var t=this;this.showCustomSelect&&(this.customValue=this.customDefault),this.showYearSelect&&(this.yearValue=c()(new Date).year().toString()),this.$emit("load"),this.getDeptList(function(){t.showBusinessSelect?t.getBusinessStatusList(function(){t.postFiltrateValue()}):t.postFiltrateValue()}),this.showProductSelect&&this.getProductCategoryIndex()},beforeDestroy:function(){},methods:{customSelectChange:function(){this.$emit("typeChange",this.customValue)},timeTypeChange:function(t){this.timeTypeValue=t},getDeptList:function(t){var e=this;Object(a.b)({m:"bi",c:this.moduleType,a:"read"}).then(function(i){e.deptList=i.data,i.data.length>0?(e.structuresSelectValue=i.data[0].id,e.showUserSelect&&e.getUserList()):e.structuresSelectValue="",t(!0)}).catch(function(){e.$emit("error")})},structuresValueChange:function(t){this.showUserSelect&&(this.userSelectValue="",this.userOptions=[],this.getUserList())},getUserList:function(){var t=this,e={};e.deptId=this.structuresSelectValue,Object(a.i)(e).then(function(e){t.userOptions=e.data}).catch(function(){t.$emit("error")})},getBusinessStatusList:function(t){var e=this;Object(n.q)().then(function(i){e.businessOptions=i.data,i.data.length>0&&(e.businessStatusValue=i.data[0].typeId),t(!0)}).catch(function(){e.$emit("error")})},getProductCategoryIndex:function(){var t=this;Object(s.u)({type:"tree"}).then(function(e){t.productOptions=e.data}).catch(function(){})},postFiltrateValue:function(){var t={deptId:this.structuresSelectValue};this.showUserSelect&&(t.userId=this.userSelectValue),this.showBusinessSelect&&(t.typeId=this.businessStatusValue),this.showProductSelect&&(t.categoryId=this.productValue.length>0?this.productValue[this.productValue.length-1]:""),this.showYearSelect?t.year=this.yearValue:"custom"==this.timeTypeValue.type?(t.startTime=this.timeTypeValue.startTime,t.endTime=this.timeTypeValue.endTime):t.type=this.timeTypeValue.value,this.$emit("change",t)}}},d=(i("0lve"),i("KHd+")),u=Object(d.a)(r,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"filtrate-content"},[t.showYearSelect?t._e():i("time-type-select",{on:{change:t.timeTypeChange}}),t._v(" "),t.showYearSelect?i("el-date-picker",{attrs:{clearable:!1,"picker-options":t.pickerOptions,type:"year","value-format":"yyyy",placeholder:"Chọn năm"},model:{value:t.yearValue,callback:function(e){t.yearValue=e},expression:"yearValue"}}):t._e(),t._v(" "),i("el-select",{attrs:{placeholder:"Chọn bộ phận"},on:{change:t.structuresValueChange},model:{value:t.structuresSelectValue,callback:function(e){t.structuresSelectValue=e},expression:"structuresSelectValue"}},t._l(t.deptList,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),t._v(" "),t.showUserSelect?i("el-select",{attrs:{clearable:!0,placeholder:"Chọn nhân viên"},model:{value:t.userSelectValue,callback:function(e){t.userSelectValue=e},expression:"userSelectValue"}},t._l(t.userOptions,function(t){return i("el-option",{key:t.id,attrs:{label:t.realname,value:t.id}})})):t._e(),t._v(" "),t.showBusinessSelect?i("el-select",{attrs:{placeholder:"Đơn vị kinh doanh"},model:{value:t.businessStatusValue,callback:function(e){t.businessStatusValue=e},expression:"businessStatusValue"}},t._l(t.businessOptions,function(t){return i("el-option",{key:t.typeId,attrs:{label:t.name,value:t.typeId}})})):t._e(),t._v(" "),t.showProductSelect?i("el-cascader",{staticStyle:{width:"100%"},attrs:{options:t.productOptions,"show-all-levels":!1,props:{children:"children",label:"label",value:"categoryId"},"change-on-select":""},model:{value:t.productValue,callback:function(e){t.productValue=e},expression:"productValue"}}):t._e(),t._v(" "),t.showCustomSelect?i("el-select",{attrs:{placeholder:"Loại biểu tượng"},on:{change:t.customSelectChange},model:{value:t.customValue,callback:function(e){t.customValue=e},expression:"customValue"}},t._l(t.customOptions,function(t){return i("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})})):t._e(),t._v(" "),i("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){t.postFiltrateValue()}}},[t._v("Tìm kiếm")]),t._v(" "),t._t("default")],2)},[],!1,null,"6eac449c",null);u.options.__file="filtrateHandleView.vue";e.a=u.exports},gd5k:function(t,e,i){"use strict";var a=i("Fpl1"),n=i("+zsY"),s=i("KzkL"),l=i("ExMk"),o={name:"ExamineLog",components:{ExamineCell:a.a,CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-660d"),i.e("chunk-4b7d"),i.e("chunk-7962")]).then(i.bind(null,"uMjE"))},ExamineHandle:function(){return i.e("chunk-5e9a").then(i.bind(null,"QhmF"))},ExamineCreateView:n.a},props:{id:[String,Number],crmType:{type:String,default:""}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[],rowID:"",showExamineHandle:!1,isCreate:!1,createAction:{type:"save"},createInfo:{},showFullDetail:!1,detailCRMType:""}},computed:{},watch:{id:function(t){this.refreshList()}},mounted:function(){var t=this,e=document.getElementById("follow-log-content");e.onscroll=function(){var i=e.scrollTop+e.clientHeight-e.scrollHeight;Math.abs(i)<10&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var t=this;this.loading=!0;var e={page:this.page,limit:10};e[this.crmType+"Ids"]=this.id,Object(s.k)(e).then(function(e){t.list=t.list.concat(e.data.list),e.data.list.length<10?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.loading=!1,t.isPost=!1}).catch(function(){t.isPost=!1,t.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},examineCellHandle:function(t){var e=this;"edit"==t.type?(t.data.item.title=t.data.item.categoryName,this.createInfo=t.data.item,this.createAction={type:"update",id:t.data.item.examineId,data:t.data.item},this.isCreate=!0):"delete"==t.type?this.$confirm("Xác nhận xóa?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){Object(l.d)({examineId:t.data.item.examineId}).then(function(t){e.refreshList(),e.$message({type:"success",message:"Thành công!"})})}).catch(function(){e.$message({type:"info",message:"Không thành công"})}):"withdraw"==t.type?(this.rowID=t.data.item.examineId,this.showExamineHandle=!0):"view"==t.type?(this.detailCRMType="examine",this.rowID=t.data.item.examineId,this.showFullDetail=!0):"related-detail"==t.type&&(this.rowID=t.data.item[t.data.type+"Id"],this.detailCRMType=t.data.type,this.showFullDetail=!0)}}},c=(i("iEOG"),i("KHd+")),r=Object(c.a)(o,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length,expression:"list.length === 0"}]},[i("div",{staticClass:"log-items"},[t._l(t.list,function(e,a){return i("examine-cell",{key:a,attrs:{data:e},on:{"on-handle":t.examineCellHandle}})}),t._v(" "),i("div",{staticClass:"load"},[i("el-button",{attrs:{loading:t.loadMoreLoading,type:"text"}},[t._v(t._s(t.loadMoreLoading?"Tải thêm":"Không có dữ liệu"))])],1)],2)]),t._v(" "),i("examine-handle",{attrs:{show:t.showExamineHandle,id:t.rowID,"examine-type":"oa_examine",status:"2"},on:{close:function(e){t.showExamineHandle=!1},save:t.refreshList}}),t._v(" "),t.isCreate?i("examine-create-view",{attrs:{"category-id":t.createInfo.categoryId,"category-title":t.createInfo.title,type:t.createInfo.type,action:t.createAction},on:{"save-success":t.refreshList,"hiden-view":function(e){t.isCreate=!1}}}):t._e(),t._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,"crm-type":t.detailCRMType,id:t.rowID},on:{"update:visible":function(e){t.showFullDetail=e}}})],1)},[],!1,null,"472c8e13",null);r.options.__file="ExamineLog.vue";e.a=r.exports},"gs/v":function(t,e,i){"use strict";var a=i("ta8G");i.n(a).a},"h+C4":function(t,e,i){"use strict";var a=i("ySAc");i.n(a).a},hIMY:function(t,e,i){"use strict";var a=i("M9eM");i.n(a).a},i68b:function(t,e,i){"use strict";var a=i("QbLZ"),n=i.n(a),s=i("KzkL"),l=i("L2JU");e.a={data:function(){return{followTypes:[],followType:""}},computed:n()({},Object(l.b)(["oa"]),{showOAPermission:function(){return this.oa}}),created:function(){this.getFollowLogType()},methods:{getFollowLogType:function(){var t=this;this.loading=!0,Object(s.x)().then(function(e){t.loading=!1,t.followTypes=e.data.map(function(t){return{type:t,name:t}}),t.followType=e.data.length>0?e.data[0]:""}).catch(function(){t.loading=!1})}},deactivated:function(){}}},i7tK:function(t,e,i){"use strict";var a=i("mcAI");i.n(a).a},i91G:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU2RjI0NjM0RTA5QjExRTg4QTE5QjM2OEE1QUE5MUZBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU2RjI0NjM1RTA5QjExRTg4QTE5QjM2OEE1QUE5MUZBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTZGMjQ2MzJFMDlCMTFFODhBMTlCMzY4QTVBQTkxRkEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTZGMjQ2MzNFMDlCMTFFODhBMTlCMzY4QTVBQTkxRkEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4H2LzoAAAAnklEQVR42mI8c+YMA7WAsbExAxMDlQGygSuA+B8Q/8eD/0HV4QQsSOwwNAtwAZChEcS4kJFIXzES62WqhyFdDESOqH1ocjuwRRQLAQPxRZQHEvsvLKKYKIkAbD5FNvA/kZr/ExuGq5HC6wiauo1I4bWa2IQdDsXYgP+gTTZUN5DYiPpHbDqERRQjAUtXE2sgvojCnnD///8/uCMFIMAAVWsql9WKpTgAAAAASUVORK5CYII="},iEOG:function(t,e,i){"use strict";var a=i("KKWy");i.n(a).a},k9yM:function(t,e,i){"use strict";var a=i("GoYs");i.n(a).a},mTTq:function(t,e,i){"use strict";var a=i("UllR");i.n(a).a},mcAI:function(t,e,i){},n5gA:function(t,e,i){"use strict";var a=i("x5wg");i.n(a).a},pCO6:function(t,e,i){"use strict";var a=i("Czda");i.n(a).a},ppJE:function(t,e,i){"use strict";var a=i("vG5h"),n=i("Ew9n"),s=i("F03V"),l=i("UEWd"),o=i("QJC7"),c=i("8KPp"),r=i("gd5k"),d=i("aQg/"),u=i("y9lt"),h=i("i68b"),m={name:"CustomerFollow",components:{MixAdd:l.a,RecordLog:o.a,JournalLog:c.a,ExamineLog:r.a,TaskLog:d.a,ScheduleLog:u.a},mixins:[h.a],props:{id:[String,Number],crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1}},data:function(){return{sendLoading:!1,nextTime:"",isEvent:!1,logType:"record"}},computed:{logTypes:function(){return this.oa?[{type:"record",name:"Hồ sơ theo dõi"},{type:"log",name:"Nhật ký"},{type:"examine",name:"Đề xuất"},{type:"task",name:"Công việc"},{type:"schedule",name:"Lịch biểu"}]:[{type:"record",name:"Hồ sơ theo dõi"}]},componentsName:function(){return"record"==this.logType?"RecordLog":"log"==this.logType?"JournalLog":"examine"==this.logType?"ExamineLog":"task"==this.logType?"TaskLog":"schedule"==this.logType?"ScheduleLog":""}},watch:{id:function(t){}},mounted:function(){},activated:function(){},deactivated:function(){},methods:{handleTypeDrop:function(t){this.followType=t},logTabsClick:function(t,e){this.logType=t.type},sendInfo:function(){this.$refs.mixadd.$emit("submit-info")},submitInfo:function(t){var e=this;if(!this.isEvent||this.nextTime)if(t.content){var i={};i.typesId=this.id,i.content=t.content,i.category=this.followType;var n=t.business.map(function(t,e,i){return t.businessId}),s=t.contacts.map(function(t,e,i){return t.contactsId});i.batchId=t.batchId,i.businessIds=n.join(","),i.contactsIds=s.join(","),i.isEvent=this.isEvent?1:0,i.nextTime=this.nextTime||"",this.sendLoading=!0,Object(a.w)(i).then(function(t){e.sendLoading=!1,e.$message.success("Thành công"),e.$refs.mixadd.resetInfo(),e.isEvent=!1,e.nextTime="",e.$bus.emit("follow-log-refresh",{type:"record-log"})}).catch(function(){e.sendLoading=!1})}else this.$message.error("Vui lòng nhập nội dung tiếp theo");else this.$message.error("Vui lòng chọn thời gian liên hệ tiếp theo")}}},p=(i("R8hg"),i("KHd+")),f=Object(p.a)(m,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"f-container"},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.sendLoading,expression:"sendLoading"}]},[i("mix-add",{ref:"mixadd",attrs:{"crm-type":t.crmType,id:t.id,"show-relative-business":!0,"show-relative-contacts":!0},on:{"mixadd-info":t.submitInfo}}),t._v(" "),i("flexbox",{staticClass:"se-section"},[i("div",{staticClass:"se-name"},[t._v("Cách liên lạc")]),t._v(" "),i("el-dropdown",{staticStyle:{"margin-right":"20px"},attrs:{trigger:"click"},on:{command:t.handleTypeDrop}},[i("flexbox",{staticClass:"se-select"},[i("div",{staticClass:"se-select-name"},[t._v(t._s(t.followType?t.followType:"Chọn"))]),t._v(" "),i("i",{staticClass:"el-icon-arrow-down el-icon--right",staticStyle:{color:"#ccc"}})]),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.followTypes,function(e,a){return i("el-dropdown-item",{key:a,attrs:{command:e.type}},[t._v(t._s(e.name))])}))],1),t._v(" "),i("div",{staticClass:"se-name"},[t._v("Lần liên hệ tiếp theo")]),t._v(" "),i("el-date-picker",{staticClass:"se-datepicker",attrs:{"default-value":new Date,editable:!1,type:"datetime",placeholder:"Chọn","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.nextTime,callback:function(e){t.nextTime=e},expression:"nextTime"}}),t._v(" "),t.showOAPermission?i("el-checkbox",{model:{value:t.isEvent,callback:function(e){t.isEvent=e},expression:"isEvent"}},[t._v("Thêm vào lời nhắc lịch trình làm việc")]):t._e(),t._v(" "),i("el-button",{staticClass:"se-send",attrs:{type:"primary"},nativeOn:{click:function(e){return t.sendInfo(e)}}},[t._v("Gởi")])],1)],1),t._v(" "),i("div",{staticClass:"log-cont"},[i("flexbox",{staticStyle:{"border-bottom":"1px solid #E6E6E6"}},t._l(t.logTypes,function(e,a){return i("flexbox",{key:a,staticStyle:{width:"auto"},nativeOn:{click:function(i){t.logTabsClick(e,a)}}},[i("div",{staticClass:"log-tabs-item",style:{color:t.logType==e.type?"#F18C70":"#777"}},[t._v(t._s(e.name))]),t._v(" "),t.logTypes.length-1!=a?i("div",{staticClass:"log-tabs-line"}):t._e()])})),t._v(" "),i("keep-alive",[i(t.componentsName,{tag:"component",attrs:{id:t.id,"crm-type":t.crmType}})],1)],1)])},[],!1,null,"1fc36098",null);f.options.__file="CustomerFollow.vue";var v=f.exports,g=i("U05J"),b=i("/U9q"),y=i("5j45"),w=i("cYid"),C=i("+NTD"),_=i("C+sD"),x=i("8DbX"),k=i("DUlf"),I=i("EgJF"),T=i("4+0Q"),L={name:"CustomerDetail",components:{SlideView:n.a,CustomerFollow:v,CRMDetailHead:s.a,CRMBaseInfo:g.a,RelativeContacts:b.a,RelativeBusiness:y.a,RelativeContract:w.a,RelativeReturnMoney:C.a,RelativeFiles:_.a,RelativeHandle:x.a,RelativeTeam:k.a,CRMCreateView:I.default},mixins:[T.a],props:{id:[String,Number],listenerIDs:{type:Array,default:function(){return["crm-main-container"]}},noListenerIDs:{type:Array,default:function(){return[]}},noListenerClass:{type:Array,default:function(){return["el-table__body"]}}},data:function(){return{loading:!1,crmType:"customer",detailData:{},headDetails:[{title:"Cấp bậc khách hàng",value:""},{title:"Trạng thái giao dịch",value:""},{title:"Người thanh toán",value:""},{title:"Ngày cập nhật",value:""}],tabCurrentName:"followlog",isCreate:!1}},computed:{tabName:function(){return"followlog"==this.tabCurrentName?"customer-follow":"basicinfo"==this.tabCurrentName?"c-r-m-base-info":"contacts"==this.tabCurrentName?"relative-contacts":"team"==this.tabCurrentName?"relative-team":"business"==this.tabCurrentName?"relative-business":"contract"==this.tabCurrentName?"relative-contract":"returnedmoney"==this.tabCurrentName?"relative-return-money":"file"==this.tabCurrentName?"relative-files":"operationlog"==this.tabCurrentName?"relative-handle":""},tabnames:function(){var t=[];return t.push({label:"Hồ sơ theo dõi",name:"followlog"}),this.crm.customer&&this.crm.customer.read&&t.push({label:"Thông tin cơ bản",name:"basicinfo"}),this.crm.contacts&&this.crm.contacts.index&&t.push({label:"Thông tin liên hệ",name:"contacts"}),t.push({label:"Đội nhóm",name:"team"}),this.crm.business&&this.crm.business.index&&t.push({label:"Mối quan hệ kinh doanh",name:"business"}),this.crm.contract&&this.crm.contract.index&&t.push({label:"Hợp đồng",name:"contract"}),this.crm.receivables&&this.crm.receivables.index&&t.push({label:"Thông tin thanh toán",name:"returnedmoney"}),t.push({label:"Đính kèm",name:"file"}),t.push({label:"Lịch sử",name:"operationlog"}),t},isSeasDetail:function(){return this.detailData&&this.detailData.hasOwnProperty("isPool")?1==this.detailData.isPool:this.isSeas}},mounted:function(){},methods:{getDetial:function(){var t=this;this.loading=!0,Object(a.t)({customerId:this.id}).then(function(e){t.loading=!1,t.detailData=e.data,t.headDetails[0].value=e.data.客户级别,t.headDetails[1].value=1==e.data.dealStatus?"Chốt deal":"Chưa bán",t.headDetails[2].value=e.data.ownerUserName,t.headDetails[3].value=e.data.updateTime}).catch(function(){t.loading=!1})},hideView:function(){this.$emit("hide-view")},handleClick:function(t,e){},editSaveSuccess:function(){this.$emit("handle",{type:"save-success"}),this.getDetial()}}},D=(i("mTTq"),Object(p.a)(L,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("slide-view",{directives:[{name:"empty",rawName:"v-empty",value:!t.canShowDetail,expression:"!canShowDetail"}],attrs:{"listener-ids":t.listenerIDs,"no-listener-ids":t.noListenerIDs,"no-listener-class":t.noListenerClass,"body-style":{padding:0,height:"100%"},"xs-empty-icon":"nopermission","xs-empty-text":"Không có quyền"},on:{"side-close":t.hideView}},[t.canShowDetail?i("flexbox",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"d-container",attrs:{direction:"column",align:"stretch"}},[i("c-r-m-detail-head",{attrs:{"is-seas":t.isSeasDetail,detail:t.detailData,"head-details":t.headDetails,id:t.id,"crm-type":"customer"},on:{handle:t.detailHeadHandle,close:t.hideView}}),t._v(" "),i("div",{staticClass:"tabs"},[i("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.tabCurrentName,callback:function(e){t.tabCurrentName=e},expression:"tabCurrentName"}},t._l(t.tabnames,function(t,e){return i("el-tab-pane",{key:e,attrs:{label:t.label,name:t.name}})}))],1),t._v(" "),i("div",{staticClass:"t-loading-content",attrs:{id:"follow-log-content"}},[i("keep-alive",[i(t.tabName,{tag:"component",attrs:{detail:t.detailData,id:t.id,"is-seas":t.isSeasDetail,"crm-type":"customer"}})],1)],1)],1):t._e(),t._v(" "),t.isCreate?i("c-r-m-create-view",{attrs:{action:{type:"update",id:t.id,batchId:t.detailData.batchId},"crm-type":"customer"},on:{"save-success":t.editSaveSuccess,"hiden-view":function(e){t.isCreate=!1}}}):t._e()],1)},[],!1,null,"1d978e83",null));D.options.__file="CustomerDetail.vue";e.a=D.exports},rl4O:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjUzM0EzN0E0RTA5QjExRTg4MTZEOEM2ODYxNjE5QjM3IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjUzM0EzN0E1RTA5QjExRTg4MTZEOEM2ODYxNjE5QjM3Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTMzQTM3QTJFMDlCMTFFODgxNkQ4QzY4NjE2MTlCMzciIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTMzQTM3QTNFMDlCMTFFODgxNkQ4QzY4NjE2MTlCMzciLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7neeY0AAABL0lEQVR42syUv0tCURSA1Vzam5ya+h8ag5DG3GpqqsAiwVFoECJc+jGpCFZrLTpFUjQ7PPwjClxyiCY3+y6cB5fLud0rOXjhG965j++de865L5skSWaRK5dZ8JpHmIUG/MAA1v4jNLIWVKAO6/CmSWOFO3AAJbiCLVjVpLHCV9iAF3ke+6S5wDFr8Az78Ons29LHkNDImnAO3/AAZeU9I+3AZhrI/9EAU7Nd6egIbuEJJk5tL2RPzVCTpfGZ0qieZF/TMvTJzmT+TqzsbFnZ/pidYUORHcKNzF87JHMzPJXUB1ZsBY6gGyNzhUM4lhEYS6ztqZkqc4+8B1N4h4LSgH5I5gq/YFuRprL7kEwbm4kjrYrsLkbmuymp9AMu4VpGZhZz6fOeuJEWl+KP/SvAAHR5UyjSji44AAAAAElFTkSuQmCC"},so1z:function(t,e,i){"use strict";var a=i("/BxL");i.n(a).a},ta8G:function(t,e,i){},u3Hk:function(t,e,i){},uKQN:function(t,e,i){"use strict";var a={name:"TimeTypeSelect",props:{defaultType:Object},data:function(){return{selectType:{label:"Năm nay",value:"year"},showTypePopover:!1,showCustomContent:!1,sureCustomContent:!1,startTime:"",endTime:"",typeOptions:[{label:"Hôm nay",value:"today"},{label:"Hôm qua",value:"yesterday"},{label:"Tuần này",value:"week"},{label:"Tuần rồi",value:"lastWeek"},{label:"Tháng này",value:"month"},{label:"Tháng trước",value:"lastMonth"},{label:"Quý này",value:"quarter"},{label:"Quý trước",value:"lastQuarter"},{label:"Năm nay",value:"year"},{label:"Năm trước",value:"lastYear"}]}},computed:{iconClass:function(){return this.showTypePopover?"arrow-up":"arrow-down"},typeShowValue:function(){return this.sureCustomContent?this.startTime||this.endTime?(this.startTime||"")+"-"+(this.endTime||""):"":this.selectType.label}},mounted:function(){this.defaultType?this.selectType=this.defaultType:this.$emit("change",{type:"default",value:this.selectType.value})},methods:{typeSelectClick:function(t){this.showTypePopover=!1,this.sureCustomContent=!1,this.showCustomContent=!1,this.selectType=t,this.$emit("change",{type:"default",value:this.selectType.value})},customSureClick:function(){this.startTime&&this.endTime&&(this.sureCustomContent=!0,this.showTypePopover=!1,this.$emit("change",{type:"custom",startTime:this.startTime,endTime:this.endTime}))}}},n=(i("w4JZ"),i("KHd+")),s=Object(n.a)(a,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-popover",{attrs:{placement:"bottom",width:"200","popper-class":"no-padding-popover",trigger:"click"},model:{value:t.showTypePopover,callback:function(e){t.showTypePopover=e},expression:"showTypePopover"}},[i("div",{staticClass:"type-popper"},[i("div",{staticClass:"type-content"},[t._l(t.typeOptions,function(e,a){return i("div",{key:a,staticClass:"type-content-item",class:{selected:t.selectType.value==e.value&&!t.showCustomContent},on:{click:function(i){t.typeSelectClick(e)}}},[i("div",{staticClass:"mark"}),t._v(t._s(e.label)+"\n      ")])}),t._v(" "),i("div",{staticClass:"type-content-item",class:{selected:t.showCustomContent},on:{click:function(e){t.showCustomContent=!0}}},[i("div",{staticClass:"mark"}),t._v("Tùy chỉnh\n      ")])],2),t._v(" "),t.showCustomContent?i("div",{staticClass:"type-content-custom"},[i("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"Chọn ngày bắt đầu"},model:{value:t.startTime,callback:function(e){t.startTime=e},expression:"startTime"}}),t._v(" "),i("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"Chọn ngày kết thúc"},model:{value:t.endTime,callback:function(e){t.endTime=e},expression:"endTime"}}),t._v(" "),i("el-button",{on:{click:t.customSureClick}},[t._v("OK")])],1):t._e()]),t._v(" "),i("el-input",{staticClass:"type-select",attrs:{slot:"reference",readonly:!0,placeholder:"Vui lòng chọn"},slot:"reference",model:{value:t.typeShowValue,callback:function(e){t.typeShowValue=e},expression:"typeShowValue"}},[i("i",{class:["el-input__icon","el-icon-"+t.iconClass],attrs:{slot:"suffix"},slot:"suffix"})])],1)},[],!1,null,"398cb27e",null);s.options.__file="index.vue";e.a=s.exports},uumG:function(t,e,i){"use strict";var a=i("LEQn");i.n(a).a},vPra:function(t,e,i){"use strict";i.d(e,"c",function(){return n}),i.d(e,"a",function(){return s}),i.d(e,"b",function(){return l});var a=i("t3Un");function n(t){return Object(a.a)({url:"comment/setComment",method:"post",data:t})}function s(t){return Object(a.a)({url:"comment/deleteComment",method:"post",data:t})}function l(t){return Object(a.a)({url:"comment/queryCommentList",method:"post",data:t})}},w4JZ:function(t,e,i){"use strict";var a=i("7F1U");i.n(a).a},wlfA:function(t,e,i){"use strict";var a=i("5X97");i.n(a).a},woiz:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjhGQTE4Q0EzRjM4ODExRThCNjlDOEQxMEUxMzYwREE0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjhGQTE4Q0E0RjM4ODExRThCNjlDOEQxMEUxMzYwREE0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OEZBMThDQTFGMzg4MTFFOEI2OUM4RDEwRTEzNjBEQTQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OEZBMThDQTJGMzg4MTFFOEI2OUM4RDEwRTEzNjBEQTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4R34ZtAAABfUlEQVR42pzUPUsDQRDG8eTQVBZiQhqxU6KoWKiFhaAQ21gqQcXGTxDFSsRKBOMXsBGi+NLFlBYighbmClGLgFZiE1+wECGd/4HnZDmSIA78uNzN7LC3t5touVyOhKINS5jGIDrwgTsUsYsvd4AXapBFBaPIoxdRXfN6XlHdb7Q4v9exgAz8UPNXlGQYJ+jBhtskqwZjqEaah6+6azxh39MabGPmDw2CqKp+B+3WZBHnCFb4UuqFm7P6M8x5WoNCqDjaZBZuzsZlbE36nVlYjDdpEM7dYsBmksBb5H/xjrinHwknUUOswaCY8kHEbbw1uceIk3jWHqgX9vzFuR/CgzU5xbyTONTGqxdroY9g44rWZA+Tzmw20Ykj9KFVV7vvwpbqrH4q2Gx2mFZUlMQ30jojJeVLuk8rn1R9Dp/Btj9AN660E329Ur3XsrNzrNcqhA+gHaZHrdGF1sbX549r+rOYwKq9RqO/AptRCjdY1n9ITV8wp02ZchtY/AgwAM3YV79CKIEGAAAAAElFTkSuQmCC"},x5wg:function(t,e,i){},x6i0:function(t,e,i){"use strict";var a=i("u3Hk");i.n(a).a},y9lt:function(t,e,i){"use strict";var a=i("FyfS"),n=i.n(a),s=i("KzkL"),l={name:"FollowScheduleCell",components:{},filters:{getRemindtypeText:function(t){switch(t){case 0:return"Không";case 1:return"Nhắc nhở đúng giờ";case 2:return"Trước 5 phút";case 3:return"Trước 15 phút";case 4:return"Trước 30 phút";case 5:return"Trước 1 giờ";case 6:return"Trước 2 giờ";case 7:return"Trước 1 ngày";case 8:return"Trước 2 ngày";case 9:return"Trước 1 tuần"}return""}},props:{data:Object},data:function(){return{}},computed:{},mounted:function(){},methods:{checkRelatedDetail:function(t,e){this.$emit("on-handle",{type:"related-detail",data:{type:t,item:e}})},handleCommand:function(t){this.$emit("on-handle",{type:t,data:{item:this.data}})}}},o=(i("0T5w"),i("KHd+")),c=Object(o.a)(l,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"fl-c"},[a("flexbox",{staticClass:"fl-h"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:t.data.createUser,expression:"data.createUser"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.data.createUser.img),expression:"$options.filters.filterUserLazyImg(data.createUser.img)",arg:"background-image"}],staticClass:"div-photo fl-h-img"}),t._v(" "),a("div",{staticClass:"fl-h-b"},[a("div",{staticClass:"fl-h-name"},[t._v(t._s(t.data.createUser.realname))]),t._v(" "),a("div",{staticClass:"fl-h-time"},[t._v(t._s(t.data.createTime))])]),t._v(" "),!t.data.permission||1!=t.data.permission.isUpdate&&1!=t.data.permission.isDelete?t._e():a("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[a("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD"}}),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t.data.permission&&1==t.data.permission.isUpdate?a("el-dropdown-item",{attrs:{command:"edit"}},[t._v("Chỉnh sửa")]):t._e(),t._v(" "),t.data.permission&&1==t.data.permission.isDelete?a("el-dropdown-item",{attrs:{command:"delete"}},[t._v("Xóa")]):t._e()],1)],1)],1),t._v(" "),a("div",{staticClass:"fl-b"},[a("div",[a("div",{staticClass:"state-color",style:{"background-color":t.data.color?t.data.color:"#fff"}}),t._v(t._s(t.data.title)+"\n    ")]),t._v(" "),a("div",{staticClass:"fl-b-des"},[a("flexbox",{staticClass:"fl-b-des-item"},[a("div",{staticClass:"fl-b-des-item-name"},[t._v("Người tham gia:")]),t._v(" "),a("div",{staticClass:"owner-list"},t._l(t.data.ownerList,function(e,i){return a("span",{key:i},[a("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",[t._v(t._s(e.realname))])]),t._v(" "),a("div",{directives:[{name:"photo",rawName:"v-photo",value:e,expression:"k"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(e.img),expression:"$options.filters.filterUserLazyImg(k.img)",arg:"background-image"}],key:e.img,staticClass:"div-photo header-circle"})])],1)}))]),t._v(" "),a("flexbox",{staticClass:"fl-b-des-item"},[a("div",{staticClass:"fl-b-des-item-name"},[t._v("Thời gian bắt đầu:")]),t._v(" "),a("div",[t._v(t._s(t.data.startTime))])]),t._v(" "),a("flexbox",{staticClass:"fl-b-des-item"},[a("div",{staticClass:"fl-b-des-item-name"},[t._v("Thời gian kết thúc:")]),t._v(" "),a("div",[t._v(t._s(t.data.endTime))])]),t._v(" "),a("flexbox",{staticClass:"fl-b-des-item"},[a("div",{staticClass:"fl-b-des-item-name"},[t._v("Mô tả:")]),t._v(" "),a("div",[t._v(t._s(t.data.remark))])])],1),t._v(" "),t.data.contactsList.length>0||t.data.customerList.length>0||t.data.businessList.length>0||t.data.contractList.length>0?a("div",{staticClass:"related-business"},[a("div",{staticClass:"label"},[t._v("Cơ hội kinh doanh liên quan")]),t._v(" "),t._l(t.data.contactsList,function(e,n){return a("p",{key:"contacts"+n,on:{click:function(i){t.checkRelatedDetail("contacts",e)}}},[a("img",{attrs:{src:i("AFlK"),alt:""}}),t._v("\n        Người liên hệ-"+t._s(e.name)+"\n      ")])}),t._v(" "),t._l(t.data.customerList,function(e,n){return a("p",{key:"customer"+n,on:{click:function(i){t.checkRelatedDetail("customer",e)}}},[a("img",{attrs:{src:i("AFlK"),alt:""}}),t._v("\n        Khách hàng-"+t._s(e.customerName)+"\n      ")])}),t._v(" "),t._l(t.data.businessList,function(e,n){return a("p",{key:"business"+n,on:{click:function(i){t.checkRelatedDetail("business",e)}}},[a("img",{attrs:{src:i("AFlK"),alt:""}}),t._v("\n        Kinh doanh-"+t._s(e.businessName)+"\n      ")])}),t._v(" "),t._l(t.data.contractList,function(e,n){return a("p",{key:"contract"+n,on:{click:function(i){t.checkRelatedDetail("contract",e)}}},[a("img",{attrs:{src:i("AFlK"),alt:""}}),t._v("\n        Hợp đồng-"+t._s(e.name)+"\n      ")])})],2):t._e()])],1)},[],!1,null,"54d48002",null);c.options.__file="FollowScheduleCell.vue";var r=c.exports,d=i("Dh/N"),u={name:"ScheduleLog",components:{FollowScheduleCell:r,CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-660d"),i.e("chunk-4b7d"),i.e("chunk-7962")]).then(i.bind(null,"uMjE"))},CreateSchedule:i("BuGm").default},props:{id:[String,Number],crmType:{type:String,default:""}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[],showFullDetail:!1,detailCRMType:"",rowID:"",showDialog:!1,formData:{checkList:[]},newtext:""}},computed:{},watch:{id:function(t){this.refreshList()}},mounted:function(){var t=this,e=document.getElementById("follow-log-content");e.onscroll=function(){var i=e.scrollTop+e.clientHeight-e.scrollHeight;Math.abs(i)<10&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var t=this;this.loading=!0;var e={page:this.page,limit:10};e[this.crmType+"Ids"]=this.id,Object(s.j)(e).then(function(e){t.list=t.list.concat(e.data.list),e.data.list.length<10?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.loading=!1,t.isPost=!1}).catch(function(){t.isPost=!1,t.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},examineCellHandle:function(t){var e=this;if("edit"==t.type){this.newText="Chỉnh sửa lịch biểu";var i=t.data.item;i.startTime=i.startTime,i.endTime=i.endTime,i.ownerUserIds=[];var a=!0,s=!1,l=void 0;try{for(var o,c=n()(i.ownerList);!(a=(o=c.next()).done);a=!0){var r=o.value;i.ownerUserIds.push(r.userId)}}catch(t){s=!0,l=t}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}this.formData=i,this.showDialog=!0}else"delete"==t.type?this.$confirm("Xác nhận xóa?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){Object(d.b)({eventId:t.data.item.eventId}).then(function(t){e.refreshList(),e.$message({type:"success",message:"Thành công!"})})}).catch(function(){e.$message({type:"info",message:"Không thành công"})}):"related-detail"==t.type&&(this.rowID=t.data.item[t.data.type+"Id"],this.detailCRMType=t.data.type,this.showFullDetail=!0)},onSubmit:function(t,e){this.refreshList(),this.newText,this.$message.success("Thành công"),this.showDialog=!1}}},h=(i("bH4c"),Object(o.a)(u,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length,expression:"list.length === 0"}]},[i("div",{staticClass:"log-items"},[t._l(t.list,function(e,a){return i("follow-schedule-cell",{key:a,attrs:{data:e},on:{"on-handle":t.examineCellHandle}})}),t._v(" "),i("div",{staticClass:"load"},[i("el-button",{attrs:{loading:t.loadMoreLoading,type:"text"}},[t._v(t._s(t.loadMoreLoading?"Tải thêm":"Không có dữ liệu"))])],1)],2)]),t._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,"crm-type":t.detailCRMType,id:t.rowID},on:{"update:visible":function(e){t.showFullDetail=e}}}),t._v(" "),t.showDialog?i("create-schedule",{attrs:{text:t.newText,"form-data":t.formData,"append-to-body":!0},on:{onSubmit:t.onSubmit,closeDialog:function(e){t.showDialog=!1}}}):t._e()],1)},[],!1,null,"fa4e4034",null));h.options.__file="ScheduleLog.vue";e.a=h.exports},ySAc:function(t,e,i){}}]);