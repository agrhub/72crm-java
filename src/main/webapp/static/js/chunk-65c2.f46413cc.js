(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-65c2"],{"+H+P":function(e,t,i){"use strict";var n={name:"EditImage",components:{VueCropper:i("fnnb").VueCropper},props:{width:{type:String,default:"450px"},title:{type:String,default:"Chỉnh sửa ảnh đại diện"},saveButtonTitle:{type:String,default:"Bắt đầu tải lên"},show:{type:Boolean,default:!1},fixedNumber:{type:Array,default:function(){return[1,1]}},previewWidth:{type:String,default:"70px"},previewHeight:{type:String,default:"70px"},previewRadius:{type:String,default:"35px"},file:[File],image:String},data:function(){return{loading:!1,showDialog:!1,cropperImg:"",previewImg:""}},computed:{},watch:{show:{handler:function(e){this.showDialog=e},deep:!0,immediate:!0},image:function(e){this.cropperImg=e}},mounted:function(){this.cropperImg=this.image},methods:{realTime:function(e){var t=this;this.$refs.cropper.getCropData(function(e){t.previewImg=e})},submiteImage:function(){var e=this;this.$refs.cropper.getCropBlob(function(t){e.$emit("save",{blob:t,file:e.file,image:e.previewImg}),e.hiddenView()})},hiddenView:function(){this.$emit("close")}}},a=(i("B6D4"),i("KHd+")),o=Object(a.a)(n,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{title:e.title,width:e.width,"append-to-body":!0,visible:e.showDialog},on:{"update:visible":function(t){e.showDialog=t},close:e.hiddenView}},[i("flexbox",{staticClass:"content"},[i("div",{staticClass:"cropper-box"},[i("vueCropper",{ref:"cropper",attrs:{"can-move":!0,"auto-crop":!0,fixed:!0,"fixed-number":e.fixedNumber,img:e.cropperImg,"output-type":"png"},on:{realTime:e.realTime}})],1),e._v(" "),i("div",{staticClass:"preview"},[i("div",{staticClass:"preview-name"},[e._v("Xem trước")]),e._v(" "),i("img",{staticClass:"preview-img",style:{width:e.previewWidth,height:e.previewHeight,"border-radius":e.previewRadius},attrs:{src:e.previewImg}})])]),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submiteImage()}}},[e._v(e._s(e.saveButtonTitle))])],1)],1)},[],!1,null,"2214f45e",null);o.options.__file="EditImage.vue";t.a=o.exports},"/s93":function(e,t,i){},"2gch":function(e,t,i){"use strict";var n=i("kUw0");i.n(n).a},B6D4:function(e,t,i){"use strict";var n=i("/s93");i.n(n).a},Fdyo:function(e,t,i){"use strict";var n=i("Vgsc");i.n(n).a},Fj67:function(e,t,i){"use strict";i.r(t);var n=i("EJiy"),a=i.n(n),o=i("QbLZ"),s=i.n(o),r=i("UMFu"),l=i("L2JU"),u=i("+H+P"),c=i("7Qib"),d={name:"EditInfo",components:{},props:{show:{type:Boolean,default:!1}},data:function(){return{loading:!1,showDialog:!1,rules:{realname:[{required:!0,message:"Họ và tên không được trống",trigger:"blur"}],email:[{validator:function(e,t,i){!t||""==t||Object(c.l)(t)?i():i(new Error("Sai định dạng email"))},trigger:"change"}],username:[{required:!0,message:"Tên đăng nhập không được trống",trigger:"blur"}]},ruleForm:{realname:"",email:"",sex:"",username:""}}},computed:s()({},Object(l.b)(["userInfo"])),watch:{show:{handler:function(e){this.showDialog=e,this.ruleForm={realname:this.userInfo.realname,email:this.userInfo.email,sex:this.userInfo.sex,username:this.userInfo.username}},deep:!0,immediate:!0}},mounted:function(){},methods:{hiddenView:function(){this.$emit("close")},save:function(){var e=this;this.$refs.ruleForm.validate(function(t){if(!t)return!1;e.loading=!0,Object(r.c)(e.ruleForm).then(function(t){e.loading=!1,e.$emit("save"),e.hiddenView()}).catch(function(){e.loading=!1})})}}},m=(i("Fdyo"),i("KHd+")),p=Object(m.a)(d,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{visible:e.showDialog,"before-close":e.hiddenView,title:"Cập nhật thông tin",width:"500px"},on:{"update:visible":function(t){e.showDialog=t}}},[i("el-form",{ref:"ruleForm",staticClass:"create-box",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px","label-position":"top"}},[i("el-form-item",{staticClass:"create-item",attrs:{label:"Họ và tên",prop:"realname"}},[i("el-input",{model:{value:e.ruleForm.realname,callback:function(t){e.$set(e.ruleForm,"realname",t)},expression:"ruleForm.realname"}})],1),e._v(" "),i("el-form-item",{staticClass:"create-item",attrs:{label:"Email",prop:"email"}},[i("el-input",{model:{value:e.ruleForm.email,callback:function(t){e.$set(e.ruleForm,"email",t)},expression:"ruleForm.email"}})],1),e._v(" "),i("el-form-item",{staticClass:"create-item",attrs:{label:"Giới tính",prop:"sex"}},[i("el-select",{staticStyle:{display:"block"},attrs:{placeholder:"Chọn"},model:{value:e.ruleForm.sex,callback:function(t){e.$set(e.ruleForm,"sex",t)},expression:"ruleForm.sex"}},e._l([{label:"Nam",value:1},{label:"Nữ",value:2}],function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),i("el-form-item",{staticClass:"create-item",attrs:{label:"Tên đăng nhập",prop:"username"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}})],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("Lưu")]),e._v(" "),i("el-button",{on:{click:e.hiddenView}},[e._v("Hủy")])],1)],1)},[],!1,null,"51fa72a0",null);p.options.__file="EditInfo.vue";var f=p.exports,g=i("X4fA"),h={name:"EditPassword",components:{},props:{show:{type:Boolean,default:!1}},data:function(){return{loading:!1,showDialog:!1,rules:{oldPwd:[{required:!0,message:"Mật khẩu không được để trống",trigger:"blur"},{min:6,max:12,message:"Mật khẩu từ 6 đến 12 ký tự",trigger:"blur"}],newPwd:[{required:!0,message:"Mật khẩu không được để trống",trigger:"blur"},{min:6,max:12,message:"Mật khẩu từ 6 đến 12 ký tự",trigger:"blur"}]},ruleForm:{id:"",oldPwd:"",newPwd:""}}},computed:s()({},Object(l.b)(["userInfo"])),watch:{show:{handler:function(e){this.showDialog=e,this.ruleForm.id=this.userInfo.id},deep:!0,immediate:!0}},mounted:function(){},methods:{hiddenView:function(){this.$emit("close")},save:function(){var e=this;this.$refs.ruleForm.validate(function(t){if(!t)return!1;e.loading=!0,Object(r.b)(e.ruleForm).then(function(t){e.loading=!1,Object(g.c)().then(function(){e.$confirm("Cập nhật thành công, vui lòng đăng nhập lại","Thông báo",{confirmButtonText:"OK",showCancelButton:!1,type:"warning"}).then(function(){e.$router.push("/login")}).catch(function(){})})}).catch(function(){e.loading=!1})})}}},v=(i("zj5i"),Object(m.a)(h,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{visible:e.showDialog,"before-close":e.hiddenView,title:"Đổi mật khẩu",width:"500px"},on:{"update:visible":function(t){e.showDialog=t}}},[i("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px","label-position":"top"}},[i("el-form-item",{attrs:{label:"Mật khẩu cũ",prop:"oldPwd"}},[i("el-input",{model:{value:e.ruleForm.oldPwd,callback:function(t){e.$set(e.ruleForm,"oldPwd",t)},expression:"ruleForm.oldPwd"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Mật khẩu mới",prop:"newPwd"}},[i("el-input",{model:{value:e.ruleForm.newPwd,callback:function(t){e.$set(e.ruleForm,"newPwd",t)},expression:"ruleForm.newPwd"}})],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("Lưu")]),e._v(" "),i("el-button",{on:{click:e.hiddenView}},[e._v("Đóng")])],1)],1)},[],!1,null,"226c2b28",null));v.options.__file="EditPassword.vue";var w=v.exports,b={name:"Person",components:{EditImage:u.a,EditInfo:f,EditPassword:w},data:function(){return{loading:!1,showEditImage:!1,editImage:null,editFile:null,showEditInfo:!1,showEditPassword:!1,list:[{name:"Họ và tên",props:"realname"},{name:"Giới tính",props:"sex"},{name:"Tên đăng nhập",props:"username"},{name:"Email",props:"email"},{name:"Phòng ban",props:"deptName"},{name:"Chức vụ",props:"post"},{name:"Người quản lý",props:"parentName"}]}},computed:s()({},Object(l.b)(["userInfo"])),mounted:function(){this.getDetail()},methods:{getDetail:function(){var e=this;this.loading=!0,this.$store.dispatch("GetUserInfo").then(function(t){e.loading=!1}).catch(function(){e.loading=!1})},editClick:function(e){"password"==e?this.showEditPassword=!0:"info"==e?this.showEditInfo=!0:"back"==e&&this.$router.go(-1)},changePersonImage:function(){document.getElementById("inputFile").click()},uploadFile:function(e){var t=e.target.files[0],i=new FileReader,n=this;i.onload=function(e){var i=void 0;i="object"===a()(e.target.result)?window.URL.createObjectURL(new Blob([e.target.result])):e.target.result,n.editImage=i,n.editFile=t,n.showEditImage=!0,e.target.value=""},i.readAsDataURL(t)},submiteImage:function(e){var t=this;this.loading=!0;var i=new FormData;i.append("userId",this.userInfo.userId),i.append("file",e.blob,e.file.name),Object(r.d)(i).then(function(e){t.loading=!1,t.getDetail()}).catch(function(){t.loading=!1})}}},_=(i("2gch"),Object(m.a)(b,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"person-container"},[i("div",{staticClass:"header-handle"},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.editClick("password")}}},[e._v("Đổi mật khẩu")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.editClick("info")}}},[e._v("Cập nhật thông tin")]),e._v(" "),i("el-button",{attrs:{plain:""},on:{click:function(t){e.editClick("back")}}},[e._v("Đóng")])],1),e._v(" "),i("flexbox",{staticClass:"person-info"},[i("div",{staticClass:"person-head"},[i("div",{directives:[{name:"photo",rawName:"v-photo",value:e.userInfo,expression:"userInfo"},{name:"lazy",rawName:"v-lazy:background-image",value:e.$options.filters.filterUserLazyImg(e.userInfo.img),expression:"$options.filters.filterUserLazyImg(userInfo.img)",arg:"background-image"}],staticClass:"div-photo person-head-img"}),e._v(" "),i("div",{staticClass:"select-picture",on:{click:e.changePersonImage}},[i("div",[e._v("Nhấp để thay đổi hình đại diện")])])]),e._v(" "),i("div",{staticClass:"person-body"},[i("div",{staticClass:"person-name"},[e._v(e._s(e.userInfo.realname))]),e._v(" "),i("div",{staticClass:"person-detail"},[e._v("Phòng ban: "+e._s(e.userInfo.deptName)+"    Chức vụ: "+e._s(e.userInfo.post))])])]),e._v(" "),i("div",{staticClass:"segmentation"}),e._v(" "),i("div",{staticClass:"section"},[e._m(0),e._v(" "),i("flexbox",{staticClass:"content",attrs:{gutter:0,wrap:"wrap"}},e._l(e.list,function(t,n){return i("flexbox-item",{key:n,staticClass:"info-cell",attrs:{span:.5}},[i("flexbox",{staticClass:"info-cell-box",attrs:{align:"stretch"}},[i("div",{staticClass:"info-cell-box-name"},[e._v(e._s(t.name))]),e._v(" "),i("div",{staticClass:"info-cell-box-value"},[e._v(e._s("sex"!==t.props?e.userInfo[t.props]:1===e.userInfo[t.props]?"Nam":2===e.userInfo[t.props]?"Nữ":""))])])],1)}))],1),e._v(" "),i("input",{attrs:{id:"inputFile",type:"file",accept:"image/png, image/jpeg, image/gif, image/jpg"},on:{change:e.uploadFile}}),e._v(" "),i("edit-image",{attrs:{show:e.showEditImage,file:e.editFile,image:e.editImage},on:{save:e.submiteImage,close:function(t){e.showEditImage=!1}}}),e._v(" "),i("edit-info",{attrs:{show:e.showEditInfo},on:{save:e.getDetail,close:function(t){e.showEditInfo=!1}}}),e._v(" "),i("edit-password",{attrs:{show:e.showEditPassword},on:{save:e.getDetail,close:function(t){e.showEditPassword=!1}}})],1)},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"section-header"},[t("div",{staticClass:"section-mark"}),this._v(" "),t("div",{staticClass:"section-title"},[this._v("Thông tin cơ bản")])])}],!1,null,"07a2fefc",null));_.options.__file="index.vue";t.default=_.exports},Vgsc:function(e,t,i){},d2fo:function(e,t,i){},kUw0:function(e,t,i){},zj5i:function(e,t,i){"use strict";var n=i("d2fo");i.n(n).a}}]);