(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-79f1","chunk-4b7d","chunk-4f77","chunk-2a87","chunk-1c8d","chunk-5e9a"],{"+9th":function(e,t,i){"use strict";i.d(t,"k",function(){return n}),i.d(t,"a",function(){return s}),i.d(t,"d",function(){return l}),i.d(t,"e",function(){return c}),i.d(t,"g",function(){return o}),i.d(t,"h",function(){return r}),i.d(t,"b",function(){return d}),i.d(t,"f",function(){return h}),i.d(t,"c",function(){return u}),i.d(t,"j",function(){return m}),i.d(t,"i",function(){return p});var a=i("t3Un");function n(e){return Object(a.a)({url:"task/queryTaskList",method:"post",data:e})}function s(e){return Object(a.a)({url:"task/setTask",method:"post",data:e})}function l(e){return Object(a.a)({url:"task/deleteTask",method:"post",data:e})}function c(e){return Object(a.a)({url:"task/queryTaskInfo",method:"post",data:e})}function o(e){return Object(a.a)({url:"task/setTask",method:"post",data:e})}function r(e){return Object(a.a)({url:"task/saveTaskRelation",method:"post",data:e})}function d(e){return Object(a.a)({url:"taskLabel/setLabel",method:"post",data:e})}function h(e){return Object(a.a)({url:"taskLabel/setLabel",method:"post",data:e})}function u(e){return Object(a.a)({url:"taskLabel/deleteLabel",method:"post",data:e})}function m(e){return Object(a.a)({url:"taskLabel/getLabelList",method:"post",data:e})}function p(e){return Object(a.a)({url:"task/queryWorkTaskLog",method:"post",data:e})}},"+NTD":function(e,t,i){"use strict";var a=i("mX3o"),n=i("EgJF"),s=i("vG5h"),l=i("6zBA"),c=i("ooHJ"),o=i("7Qib"),r={name:"RelativeReturnMoney",components:{CRMCreateView:n.default,CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-660d"),i.e("chunk-4b7d"),i.e("chunk-7962")]).then(i.bind(null,"uMjE"))}},mixins:[a.a],props:{id:[String,Number],crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1},detail:{type:Object,default:function(){return{}}}},data:function(){return{list:[],fieldList:[],tableHeight:"250px",showFullDetail:!1,showFullCrmType:"receivables",showFullId:"",createCrmType:"receivables_plan",isCreate:!1,palnList:[],planFieldList:[],createActionInfo:{}}},computed:{},watch:{id:function(e){this.list=[],this.palnList=[],this.getList(),this.getPlanList()}},mounted:function(){this.planFieldList=[{prop:"num",width:"200",label:"Số kỳ"},{prop:"customerName",width:"200",label:"Tên khách hàng"},{prop:"contractNum",width:"200",label:"Mã hợp đồng"},{prop:"money",width:"200",label:"Số tiền thanh toán"},{prop:"returnDate",width:"200",label:"Ngày thành toán"},{prop:"returnType",width:"200",label:"Phương thức thanh toán"},{prop:"remind",width:"200",label:"Nhắc trước vài ngày"},{prop:"remark",width:"200",label:"Mô tả"}],this.getPlanList(),this.fieldList=[{prop:"receivablesNum",width:"200",label:"Mã biên nhận"},{prop:"contractName",width:"200",label:"Hợp đồng"},{prop:"contractMoney",width:"200",label:"Số tiền trên hợp đồng"},{prop:"receivablesMoney",width:"200",label:"Số tiền thanh toán"},{prop:"planNum",width:"200",label:"Số kỳ"},{prop:"ownerUserName",width:"200",label:"Người thanh toán"},{prop:"checkStatus",width:"200",label:"Trạng thái"},{prop:"returnTime",width:"200",label:"Ngày thanh toán"}],this.getList()},methods:{getPlanList:function(){var e=this;this.loading=!0,(0,{customer:s.s,contract:l.h}[this.crmType])(this.getParams()).then(function(t){e.loading=!1,e.palnList=t.data}).catch(function(){e.loading=!1})},getList:function(){var e=this;this.loading=!0,(0,{customer:s.r,contract:l.g}[this.crmType])(this.getParams()).then(function(t){e.loading=!1,e.list=t.data}).catch(function(){e.loading=!1})},getParams:function(){return"customer"===this.crmType?{customerId:this.id,pageType:0}:"contract"===this.crmType?{contractId:this.id,pageType:0}:{}},handleRowClick:function(e,t,i){this.showFullId=e.receivablesId,this.showFullCrmType="receivables",this.showFullDetail=!0},cellStyle:function(e){e.row,e.column,e.rowIndex;return 0==e.columnIndex?{color:"#3E84E9",textAlign:"center",cursor:"pointer"}:{textAlign:"center"}},planCellStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}},createClick:function(e){this.createActionInfo={type:"relative",crmType:this.crmType,data:{}},"money"==e?("contract"===this.crmType?(this.createActionInfo.data.customer=Object(o.k)(this.detail),this.createActionInfo.data.contract=Object(o.k)(this.detail)):"customer"===this.crmType&&(this.createActionInfo.data.customer=this.detail),this.createCrmType="receivables",this.isCreate=!0):"plan"==e&&("contract"===this.crmType?(this.createActionInfo.data.customer=Object(o.k)(this.detail),this.createActionInfo.data.contract=Object(o.k)(this.detail)):"customer"===this.crmType&&(this.createActionInfo.data.customer=this.detail),this.createCrmType="receivables_plan",this.isCreate=!0)},saveSuccess:function(){"receivables"==this.createCrmType?this.getList():this.getPlanList()},handleFile:function(e,t){var i=this;"edit"==e?(this.createActionInfo={type:"update",id:t.row.planId},this.createCrmType="receivables_plan",this.isCreate=!0):"delete"==e&&this.$confirm("Xác nhận xóa?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){Object(c.e)({planIds:t.row.planId}).then(function(e){i.palnList.splice(t.$index,1),i.$message.success("Thành công")}).catch(function(){})}).catch(function(){i.$message({type:"info",message:"Không thành công"})})},fieldFormatter:function(e,t,i){return"checkStatus"===t.property?this.getStatusName(e.checkStatus):["contractMoney","receivablesMoney","money"].includes(t.property)?Object(o.j)(i):i},getStatusName:function(e){return 0==e?"Đang chờ xử lý":1==e?"Đã duyệt":2==e?"Từ chối":3==e?"Đang xem xét":4==e?"Rút lại":5==e?"Chưa gởi":6==e?"Hủy":""},headerRowStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}},detailHandle:function(e){"delete"===e.type&&this.getList()}}},d=(i("ZiYz"),i("KHd+")),h=Object(d.a)(r,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"rc-cont"},[e.isSeas?e._e():i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(t){e.createClick("plan")}}},[e._v("Kế hoạch thanh toán mới")])],1),e._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:e.palnList,height:e.tableHeight,"header-cell-style":e.headerRowStyle,"cell-style":e.planCellStyle,stripe:""}},[e._l(e.planFieldList,function(t,a){return i("el-table-column",{key:a,attrs:{prop:t.prop,label:t.label,formatter:e.fieldFormatter,"show-overflow-tooltip":""}})}),e._v(" "),i("el-table-column",{attrs:{label:"Tùy chọn",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("flexbox",{attrs:{justify:"center"}},[i("el-button",{attrs:{type:"text"},nativeOn:{click:function(i){e.handleFile("edit",t)}}},[e._v("Chỉnh sửa")]),e._v(" "),i("el-button",{attrs:{type:"text"},nativeOn:{click:function(i){e.handleFile("delete",t)}}},[e._v("Xóa")])],1)]}}])})],2),e._v(" "),i("flexbox",{staticClass:"rc-head",staticStyle:{"margin-top":"15px"},attrs:{direction:"row-reverse"}},[e.isSeas?e._e():i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(t){e.createClick("money")}}},[e._v("Thanh toán mới")])],1),e._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:e.list,height:e.tableHeight,"header-cell-style":e.headerRowStyle,"cell-style":e.cellStyle,stripe:""},on:{"row-click":e.handleRowClick}},e._l(e.fieldList,function(t,a){return i("el-table-column",{key:a,attrs:{prop:t.prop,formatter:e.fieldFormatter,label:t.label,"show-overflow-tooltip":""}})})),e._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:e.showFullDetail,"crm-type":e.showFullCrmType,id:e.showFullId},on:{"update:visible":function(t){e.showFullDetail=t},handle:e.detailHandle}}),e._v(" "),e.isCreate?i("c-r-m-create-view",{attrs:{"crm-type":e.createCrmType,action:e.createActionInfo},on:{"save-success":e.saveSuccess,"hiden-view":function(t){e.isCreate=!1}}}):e._e()],1)},[],!1,null,"17ec48d0",null);h.options.__file="RelativeReturnMoney.vue";t.a=h.exports},"+xXq":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkJGMjBEQTUzNDE2NTExRTlBNTYyRkQzQzcyQzU1QTdEIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkJGMjBEQTU0NDE2NTExRTlBNTYyRkQzQzcyQzU1QTdEIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QkYyMERBNTE0MTY1MTFFOUE1NjJGRDNDNzJDNTVBN0QiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QkYyMERBNTI0MTY1MTFFOUE1NjJGRDNDNzJDNTVBN0QiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7hCk5DAAACAElEQVR42qSV20tUURTGv33GxgtjD0beGtBw8tKLoE/2VxiakC8i5IsYaFAm9qykE/qgIPog2JNKOhH9F0aUPoiNYGJOIEEQNjbmnL7NrMOc2+DkLPjBOXvv9Z211157HXUx0gsfC5JOoYPUkhQ5Ih/JJnkrYw4r8hG7T6ZIxOcjzcJDEiejZMO+yLA9B8hLWRDB5abXvBGfgF+EE+QZ/t8sn1F7hN0eseISqMFxGM+jXBXIR7TbEtS5mXFmKwjj0VOoyF0gVA7cqMzCD+WwWe2pt/yAhO0zqm8YaGjOvJSFYIxFna4HX5COvQYO9+2jt0iPIaXhMFVVm305SwLJ0yx/z4H6OzAGXzCMerdrp2IdHvChzjFcHabDOLd7Heb2FszlGUc6VM8AVNs9mLufYC5O2T2/6girPdn4foT0wiRw+guqpRW4FszOpVIwN1cyO7nd5PasKZJqL/aIHh8i/YpRlpQC564LEZBqM0343ZQEKfc9t58/vGMVN6G6+jN6e9vu2YQW/Ewa3TPGxBKjK8tdecnfMN+vuUe3tGDMKsq87M8ZI9uh2CpwknDPxvQp64zvu2vxCvaNNBhyKE9QuI3o+K27vE6mCxCbFg1H+xojc1cQmxdfTz+8II/lgOJ5CMWlDwyJb86OrZvmO1msu3e7XHwr8R/kF7Du9wv4J8AAdbF+5wQ+l40AAAAASUVORK5CYII="},"/BxL":function(e,t,i){},"/U9q":function(e,t,i){"use strict";var a=i("mX3o"),n=i("EgJF"),s=i("vG5h"),l=i("UcQx"),c=i("mkuN"),o={name:"RelativeContacts",components:{CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-660d"),i.e("chunk-4b7d"),i.e("chunk-7962")]).then(i.bind(null,"uMjE"))},CRMCreateView:n.default,CrmRelative:c.a},mixins:[a.a],props:{id:[String,Number],crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1},detail:{type:Object,default:function(){return{}}}},data:function(){return{nopermission:!1,list:[],fieldList:[],tableHeight:"400px",showFullDetail:!1,isCreate:!1,contactsId:"",createActionInfo:{type:"relative",crmType:this.crmType,data:{}},showRelativeView:!1,selectionList:[]}},computed:{customerId:function(){return this.detail.customerId},canRelation:function(){return"business"==this.crmType}},watch:{id:function(e){this.list=[],this.getDetail()}},mounted:function(){this.getDetail()},activated:function(){},deactivated:function(){},methods:{checkRelativeInfos:function(e){var t=this;if(e.data.length>0){var i={businessId:this.id};i.contactsIds=e.data.map(function(e){return e.contactsId}).join(","),Object(l.l)(i).then(function(e){t.getDetail(),t.$message.success("Thành công")}).catch(function(){})}},unRelevanceHandleClick:function(){var e=this;0==this.selectionList.length?this.$message.error("Chưa chọn liên lạc"):this.$confirm("Xác nhận xóa?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){var t={businessId:e.id};t.contactsIds=e.selectionList.map(function(e){return e.contactsId}).join(","),Object(l.t)(t).then(function(t){e.getDetail(),e.$message.success("Thành công")}).catch(function(){})}).catch(function(){e.$message.info("Không thành công")})},getFieldList:function(){this.fieldList.push({prop:"name",width:"200",label:"Tên liên hệ"}),this.fieldList.push({prop:"mobile",width:"200",label:"Số điện thoại di động"}),this.fieldList.push({prop:"post",width:"200",label:"Số điện thoại bàn"})},getDetail:function(){var e=this;this.loading=!0;var t={customer:s.o,business:l.g}[this.crmType],i={};i[this.crmType+"Id"]=this.id,t(i).then(function(t){0==e.fieldList.length&&e.getFieldList(),e.nopermission=!1,e.loading=!1,e.list=t.data.list}).catch(function(t){102==t.code&&(e.nopermission=!0),e.loading=!1})},handleRowClick:function(e,t,i){this.contactsId=e.contactsId,this.showFullDetail=!0},headerRowStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}},cellStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}},createClick:function(){"customer"==this.crmType?this.createActionInfo.data.customer=this.detail:"business"==this.crmType&&(this.createActionInfo.data.customer=this.detail,this.createActionInfo.relativeData={businessId:this.detail.businessId}),this.isCreate=!0},createSaveSuccess:function(){this.canRelation?this.$refs.crmrelative.refreshList():this.getDetail()}}},r=(i("so1z"),i("KHd+")),d=Object(r.a)(o,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"empty",rawName:"v-empty",value:e.nopermission,expression:"nopermission"}],staticClass:"rc-cont",attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"Không có quyền"}},[e.isSeas?e._e():i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(t){return e.createClick(t)}}},[e._v("Thêm liên lạc mới")]),e._v(" "),e.canRelation?i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(t){return e.unRelevanceHandleClick(t)}}},[e._v("Xóa liên lạc")]):e._e(),e._v(" "),e.canRelation?i("el-popover",{staticStyle:{"margin-right":"20px"},attrs:{placement:"bottom",width:"700","popper-class":"no-padding-popover",trigger:"click"},model:{value:e.showRelativeView,callback:function(t){e.showRelativeView=t},expression:"showRelativeView"}},[i("crm-relative",{ref:"crmrelative",attrs:{show:e.showRelativeView,radio:!1,action:{type:"condition",data:{moduleType:"customer",customerId:e.customerId}},"selected-data":{contacts:e.list},"crm-type":"contacts"},on:{close:function(t){e.showRelativeView=!1},changeCheckout:e.checkRelativeInfos},model:{value:e.showRelativeView,callback:function(t){e.showRelativeView=t},expression:"showRelativeView"}}),e._v(" "),i("el-button",{staticClass:"rc-head-item",staticStyle:{"margin-right":"0"},attrs:{slot:"reference",type:"primary"},nativeOn:{click:function(t){e.showRelativeView=!0}},slot:"reference"},[e._v("Quan hệ")])],1):e._e()],1),e._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:e.list,height:e.tableHeight,"header-cell-style":e.headerRowStyle,"cell-style":e.cellStyle,stripe:""},on:{"row-click":e.handleRowClick,"selection-change":function(t){e.selectionList=t}}},[e.canRelation&&e.fieldList.length>0?i("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"selection",align:"center",width:"55"}}):e._e(),e._v(" "),e._l(e.fieldList,function(e,t){return i("el-table-column",{key:t,attrs:{prop:e.prop,label:e.label,"show-overflow-tooltip":""}})})],2),e._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:e.showFullDetail,id:e.contactsId,"crm-type":"contacts"},on:{"update:visible":function(t){e.showFullDetail=t}}}),e._v(" "),e.isCreate?i("c-r-m-create-view",{attrs:{action:e.createActionInfo,"crm-type":"contacts"},on:{"save-success":e.createSaveSuccess,"hiden-view":function(t){e.isCreate=!1}}}):e._e()],1)},[],!1,null,"0dbbbee9",null);d.options.__file="RelativeContacts.vue";t.a=d.exports},"/bsb":function(e,t,i){},"0T5w":function(e,t,i){"use strict";var a=i("LnKz");i.n(a).a},"0pN2":function(e,t,i){},"1AAk":function(e,t,i){},"1RnH":function(e,t,i){"use strict";var a=i("QbLZ"),n=i.n(a),s=i("+9th"),l=i("mkuN"),c=i("Er7M"),o=i("7Qib"),r=i("L2JU"),d={components:{CrmRelative:l.a,RelatedBusinessCell:c.a},props:{marginLeft:{type:String,default:"20px"},allData:{type:Object,default:function(){return{contacts:[],customer:[],business:[],contract:[]}}},isTask:{type:Boolean,default:!1},taskID:Number,alterable:{type:Boolean,default:!0},alterableColor:{type:String,default:"#999"}},data:function(){return{showTypes:["customer","contacts","business","contract"],showPopover:!1,relevanceAll:{customerIds:[],contractIds:[],contactsIds:[],businessIds:[]},relatedListData:{},showRelative:!1,showTaskRelative:!1}},computed:n()({},Object(r.b)(["crm"]),{showCRMPermission:function(){return this.crm}}),watch:{allData:function(){this.relatedListData=this.allData}},mounted:function(){this.relatedListData=this.allData},methods:{crmrelativeClose:function(){this.showPopover=!1},checkInfos:function(e){var t=this;this.showPopover=!1,this.relatedListData=e.data;var i=function(i){var a=e.data[i];t.relevanceAll[i+"Ids"]=a.map(function(e,t,a){return e[i+"Id"]})};for(var a in e.data)i(a);this.$emit("checkInfos",this.relevanceAll)},delRelevance:function(e,t,i){var a=this;this.$confirm("Xác nhận xóa?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning",customClass:"is-particulars"}).then(function(){var i={taskId:a.taskID},n=Object(o.k)(a.relatedListData);n[e].splice(t,1);for(var l=function(e){var t=a.showTypes[e],s=n[t]||[];i[t+"Ids"]=s.map(function(e){return e[t+"Id"]}).join(",")},c=0;c<a.showTypes.length;c++)l(c);Object(s.h)(i).then(function(i){a.relatedListData[e].splice(t,1),a.relatedListData=Object(o.k)(a.relatedListData),a.$message.success("Thành công")}).catch(function(){})}).catch(function(){a.$message.info("Không thành công")})},checkRelatedDetail:function(e,t){t.key=t[e+"Id"],this.$emit("checkRelatedDetail",e,t)}}},h=(i("uumG"),i("KHd+")),u=Object(h.a)(d,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"related-business",style:{"margin-left":e.marginLeft}},[!e.isTask&&e.alterable?a("el-popover",{attrs:{placement:"bottom",width:"800","popper-class":"no-padding-popover",trigger:"click"},model:{value:e.showPopover,callback:function(t){e.showPopover=t},expression:"showPopover"}},[e.showRelative?a("crm-relative",{ref:"crmrelative",attrs:{show:e.showPopover,radio:!1,"selected-data":e.relatedListData,"show-types":e.showTypes},on:{close:e.crmrelativeClose,changeCheckout:e.checkInfos}}):e._e(),e._v(" "),e.showCRMPermission?a("p",{staticClass:"add-file",attrs:{slot:"reference"},on:{click:function(t){e.showRelative=!0}},slot:"reference"},[a("img",{attrs:{src:i("AFlK"),alt:""}}),e._v("\n      Cơ hội kinh doanh liên quan\n    ")]):e._e()],1):e._e(),e._v(" "),e.alterable?e._e():a("p",{staticClass:"alterable-p",style:{color:e.alterableColor}},[e._v("Cơ hội kinh doanh liên quan")]),e._v(" "),e._l(e.relatedListData,function(t,i){return a("div",{key:i},e._l(t,function(t,n){return a("related-business-cell",{key:n,attrs:{data:t,"cell-index":n,type:i,"show-foot":e.isTask},on:{unbind:e.delRelevance,detail:function(a){e.checkRelatedDetail(i,t)}}})}))}),e._v(" "),e.isTask?a("el-popover",{attrs:{placement:"bottom",width:"800","popper-class":"no-padding-popover",trigger:"click"},model:{value:e.showPopover,callback:function(t){e.showPopover=t},expression:"showPopover"}},[e.showTaskRelative?a("crm-relative",{ref:"crmrelative",attrs:{radio:!1,show:e.showPopover,"selected-data":e.relatedListData,"show-types":e.showTypes},on:{close:e.crmrelativeClose,changeCheckout:e.checkInfos}}):e._e(),e._v(" "),e.showCRMPermission?a("p",{staticClass:"add-file",attrs:{slot:"reference"},on:{click:function(t){e.showTaskRelative=!0}},slot:"reference"},[a("img",{attrs:{src:i("AFlK"),alt:""}}),e._v("\n      Liên kết\n    ")]):e._e()],1):e._e()],2)},[],!1,null,"bcec8706",null);u.options.__file="relatedBusiness.vue";t.a=u.exports},"3biH":function(e,t,i){"use strict";var a=i("KzkL"),n=i("ExMk"),s=i("Ktth"),l=i.n(s),c=i("QhmF"),o={name:"CheckFlow",components:{},filters:{statusIcon:function(e){return 2==e?i("migV"):1==e?i("y4JV"):4==e?i("+xXq"):3==e?i("wu/m"):0==e||6==e?i("6pZM"):5==e?i("wu/m"):""},stepName:function(e){return"Đầu tiên"+l.a.encodeS(e)+"cấp"}},props:{examineType:{type:String,default:""},id:[String,Number]},data:function(){return{loading:!1,list:[]}},computed:{},watch:{id:function(e){e&&(this.list=[],this.getDetail())}},mounted:function(){},methods:{getDetail:function(){var e=this;this.id&&(this.loading=!0,(0,{crm_contract:a.d,crm_receivables:a.d,oa_examine:n.f}[this.examineType])({recordId:this.id}).then(function(t){e.loading=!1,e.list=t.data}).catch(function(){e.loading=!1}))},getStatusName:function(e){return 0==e?"Chưa được đánh giá ":1==e?"Thông qua":2==e?"Từ chối":3==e?"Đang xem xét":4==e?"Rút lại":5==e?"Tạo":6==e?"Chưa nộp":""},close:function(){this.$emit("close")}}},r=(i("vkES"),i("KHd+")),d=Object(r.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"},{name:"empty",rawName:"v-empty",value:e.list,expression:"list"}],attrs:{"xs-empty-icon":"none","xs-empty-text":"Không có hồ sơ"}},[a("flexbox",{staticClass:"flow-head"},[a("div",{staticClass:"flow-head-name"},[e._v("Quy trình phê duyệt")]),e._v(" "),a("img",{staticClass:"flow-head-close",attrs:{src:i("cjwK")},on:{click:e.close}})]),e._v(" "),a("div",{staticClass:"flow-body"},e._l(e.list,function(t,i){return a("flexbox",{key:i,staticClass:"cf-flow-item",attrs:{align:"stretch",justify:"flex-start"}},[a("img",{staticClass:"cf-flow-item-img",attrs:{src:e._f("statusIcon")(t.examineStatus)}}),e._v(" "),a("div",[a("flexbox",{staticClass:"cf-flow-item-head"},[a("div",{staticClass:"cf-flow-item-des"},[e._v(e._s(e._f("stepName")(t.orderId)))]),e._v(" "),a("div",[e._v(e._s(t.examineTime))])]),e._v(" "),a("flexbox",{staticClass:"cf-flow-item-info"},[a("div",{staticClass:"cf-flow-item-name"},[e._v(e._s(t.realname))]),e._v(" "),a("div",[a("span",[e._v(e._s(e.getStatusName(t.examineStatus)))]),e._v("Kiểm tra")])]),e._v(" "),t.remarks?a("div",{staticClass:"cf-flow-item-content"},[e._v(e._s(t.remarks)+"\n          "),a("div",{staticClass:"cf-flow-item-content-arrow"})]):e._e()],1),e._v(" "),a("div",{staticClass:"cf-flow-item-line"})])}))],1)},[],!1,null,"36e3da56",null);d.options.__file="CheckFlow.vue";var h=d.exports,u={name:"ExamineInfo",components:{ExamineHandle:c.default,CheckFlow:h},filters:{statusIcon:function(e){return 2==e?i("migV"):1==e?i("y4JV"):4==e?i("+xXq"):3==e?i("wu/m"):0==e||6==e?i("6pZM"):5==e?i("wu/m"):""},detailName:function(e){return 2==e.stepType?e.userList.length+"Họ tên và chữ ký":3==e.stepType?e.userList.length+"Mọi người ký tên":1==e.stepType?"Người phụ trách":4==e.stepType?"Người giám sát cấp trên của người phê duyệt":5==e.stepType?"Người đề xuất":void 0},stepName:function(e){return"Đầu tiên"+l.a.encodeS(e)+"cấp"}},props:{examineType:{type:String,default:""},id:[String,Number],recordId:[String,Number],ownerUserId:[String,Number]},data:function(){return{loading:!1,examineInfo:{},showFlowPopover:!1,examineHandleInfo:{status:1},showExamineHandle:!1}},computed:{},watch:{recordId:{handler:function(e){e&&(this.examineInfo={},this.getFlowStepList(),this.$refs.checkFlow&&this.$refs.checkFlow.getDetail())},deep:!0,immediate:!0}},mounted:function(){},methods:{getFlowStepList:function(){var e=this;this.recordId&&this.id&&(this.loading=!0,(0,{crm_contract:a.e,crm_receivables:a.e,oa_examine:n.g}[this.examineType])({recordId:this.recordId,ownerUserId:this.ownerUserId}).then(function(t){e.loading=!1,e.examineInfo=t.data,e.$emit("value-change",{config:t.data.examineType,value:[]})}).catch(function(){e.loading=!1}))},examineHandle:function(e){this.examineHandleInfo.status=e,this.showExamineHandle=!0},getStatusName:function(e){return 0==e?"Chưa được đánh giá":1==e?"Thông qua":2==e?"Từ chối":3==e?"Đang xem xét":4==e?"Rút lại":5==e?"Tạo":6==e?"Nộp":""},getContentFilters:function(e){for(var t="",i=0;i<e.length;i++){var a=e[i];t=i==e.length-1?t+a.realname+"："+this.getStatusName(a.checkType):t+a.realname+"："+this.getStatusName(a.checkType)+"、"}return t},examineHandleClick:function(e){this.getFlowStepList(),this.$refs.checkFlow&&this.$refs.checkFlow.getDetail(),this.$emit("on-handle",e)}}},m=(i("VExD"),Object(r.a)(u,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"contract-flow-box"},[a("flexbox",{staticStyle:{position:"relative"},attrs:{direction:"row-reverse"}},[a("el-popover",{attrs:{placement:"bottom",width:"300",trigger:"click"},model:{value:e.showFlowPopover,callback:function(t){e.showFlowPopover=t},expression:"showFlowPopover"}},[a("check-flow",{ref:"checkFlow",attrs:{id:e.recordId,"examine-type":e.examineType},on:{close:function(t){e.showFlowPopover=!1}}}),e._v(" "),a("el-button",{staticClass:"check-flow-button",attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("Xem lịch sử phê duyệt")])],1),e._v(" "),a("div",{staticStyle:{"min-height":"40px"}},[1==e.examineInfo.isRecheck?a("el-button",{staticClass:"flow-button white",on:{click:function(t){e.examineHandle(4)}}},[e._v("Rút lại đánh giá")]):e._e(),e._v(" "),1==e.examineInfo.isCheck?a("el-button",{staticClass:"flow-button red",on:{click:function(t){e.examineHandle(2)}}},[e._v("Từ chối")]):e._e(),e._v(" "),1==e.examineInfo.isCheck?a("el-button",{staticClass:"flow-button blue",on:{click:function(t){e.examineHandle(1)}}},[e._v("Thông qua")]):e._e()],1)],1),e._v(" "),2==e.examineInfo.examineType?a("flexbox",{staticClass:"check-items"},e._l(e.examineInfo.steps,function(t,i){return a("flexbox",{key:i,staticClass:"check-item"},[a("div",[a("flexbox",{staticClass:"check-item-user",staticStyle:{width:"auto"}},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:t.examinUser,expression:"item.examinUser"},{name:"lazy",rawName:"v-lazy:background-image",value:e.$options.filters.filterUserLazyImg(t.examinUser.img),expression:"$options.filters.filterUserLazyImg(item.examinUser.img)",arg:"background-image"}],staticClass:"div-photo check-item-img"}),e._v(" "),a("div",{staticClass:"check-item-name"},[e._v(e._s(t.examinUser.realname))])]),e._v(" "),a("flexbox",{staticClass:"check-item-info"},[a("img",{staticClass:"check-item-img",attrs:{src:e._f("statusIcon")(t.examineStatus)}}),e._v(" "),a("div",{staticClass:"check-item-name"},[e._v(e._s(e.getStatusName(t.examineStatus)))])])],1),e._v(" "),e.examineInfo.steps.length-1!=i?a("i",{staticClass:"el-icon-arrow-right check-item-arrow"}):e._e()])})):1==e.examineInfo.examineType?a("flexbox",{staticClass:"check-items",attrs:{wrap:"wrap"}},e._l(e.examineInfo.steps,function(t,n){return a("el-popover",{key:n,attrs:{disabled:!t.userList||0==t.userList.length,placement:"bottom",trigger:"hover"}},[a("div",{staticClass:"popover-detail"},e._l(t.userList,function(t,i){return a("flexbox",{key:i,staticClass:"popover-detail-item",attrs:{align:"stretch"}},[a("img",{staticClass:"popover-detail-item-img",attrs:{src:e._f("statusIcon")(t.examineStatus)}}),e._v(" "),a("div",[a("div",{staticClass:"popover-detail-item-time"},[e._v(e._s(t.examineTime))]),e._v(" "),a("flexbox",{staticClass:"popover-detail-item-examine"},[a("div",{staticClass:"examine-name"},[e._v(e._s(t.realname))]),e._v(" "),a("div",{staticClass:"examine-info"},[e._v(e._s(e.getStatusName(t.examineStatus))+"此申请")])])],1)])})),e._v(" "),a("flexbox",{staticClass:"fixed-examine-item",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"fixed-examine-info"},[a("img",{attrs:{src:i("dZj0")}}),e._v(" "),a("div",{staticClass:"detail"},[e._v(e._s(e._f("detailName")(t)))]),e._v(" "),a("flexbox",{staticClass:"check-item-info"},[a("img",{staticClass:"check-item-img",attrs:{src:e._f("statusIcon")(t.examineStatus)}}),e._v(" "),a("div",{staticClass:"check-item-name"},[e._v(e._s(e.getStatusName(t.examineStatus)))])])],1),e._v(" "),e.examineInfo.steps.length-1!=n?a("i",{staticClass:"el-icon-arrow-right check-item-arrow"}):e._e()])],1)})):e._e(),e._v(" "),a("examine-handle",{attrs:{show:e.showExamineHandle,id:e.id,"record-id":e.recordId,"examine-type":e.examineType,detail:e.examineInfo,status:e.examineHandleInfo.status},on:{close:function(t){e.showExamineHandle=!1},save:e.examineHandleClick}})],1)},[],!1,null,"3aac4688",null));m.options.__file="ExamineInfo.vue";t.a=m.exports},"3gs7":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAASCAYAAABSO15qAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjcxMEMyOTg1QzBBMzExRThCRjRERkU3Mzg5NDBDQTlCIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjcxMEMyOTg2QzBBMzExRThCRjRERkU3Mzg5NDBDQTlCIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NzEwQzI5ODNDMEEzMTFFOEJGNERGRTczODk0MENBOUIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NzEwQzI5ODRDMEEzMTFFOEJGNERGRTczODk0MENBOUIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4G5F1NAAAA5UlEQVR42mJctWpVAwMDQyUQszGQBn4CcRMLkKgC4j9AfJZEA7SBuAZkwEUgNgTiTCA+TaRmJyDeA8SHmIBEERCD6NlAzEKEZj4gng/EH4E4EaTxMBAvB2J9IC4hwoB+IJYD4lQgvs8EFSwD4i9AXAfEKng0+wBxEhDPAOI1DFCng8BTIG4FYk6oJCMWzUJQb4LCrBAmyITmtNtA7AzE8VgMmA7EvEAcAcQ/sBnwE8nkDjTNnUAcBsRZQHwDWYIJTeFWKC2OJl4GpRehO4uJgUIwDAzAlnQ3UWqA/4B7gYEUbwEEGAANECY5RBCuPwAAAABJRU5ErkJggg=="},"3vFt":function(e,t,i){},"3yi6":function(e,t,i){"use strict";var a=i("7Qib"),n=i("KzkL"),s={name:"FollowRecordCell",components:{CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-66f9"),i.e("chunk-660d"),i.e("chunk-4b7d"),i.e("chunk-4f77"),i.e("chunk-7962e")]).then(i.bind(null,"uMjE"))}},props:{item:{type:Object,default:function(){return{}}},crmType:{type:String,default:""},index:[String,Number]},data:function(){return{showFullDetail:!1,relationID:"",relationCrmType:""}},computed:{},mounted:function(){},methods:{previewImg:function(e,t){this.$bus.emit("preview-image-bus",{index:t,data:e.map(function(e,t,i){return e.url=e.filePath,e})})},downloadFile:function(e){Object(a.b)({path:e.filePath,name:e.name})},handleCommand:function(e){var t=this;this.$confirm("Xác nhận xóa?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){Object(n.p)({recordId:t.item.recordId}).then(function(i){t.$emit("on-handle",{type:e,data:{item:t.item,index:t.index}}),t.$message.success("Thành công")}).catch(function(){})}).catch(function(){t.$message({type:"info",message:"Không thành công"})})},checkRelationDetail:function(e,t){this.relationID=t,this.relationCrmType=e,this.showFullDetail=!0}}},l=(i("VPeB"),i("KHd+")),c=Object(l.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fl-c"},[a("flexbox",{staticClass:"fl-h"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:{img:e.item.userImg,realname:e.item.realname},expression:"{img: item.userImg, realname: item.realname}"},{name:"lazy",rawName:"v-lazy:background-image",value:e.$options.filters.filterUserLazyImg(e.item.userImg),expression:"$options.filters.filterUserLazyImg(item.userImg)",arg:"background-image"}],staticClass:"div-photo fl-h-img"}),e._v(" "),a("div",{staticClass:"fl-h-b"},[a("div",{staticClass:"fl-h-name"},[e._v(e._s(e.item.realname))]),e._v(" "),a("div",{staticClass:"fl-h-time"},[e._v(e._s(e.item.createTime))])]),e._v(" "),a("flexbox",{staticClass:"fl-h-mark"},[a("img",{staticClass:"fl-h-mark-img",attrs:{src:i("N0PQ")}}),e._v(" "),a("div",{staticClass:"fl-h-mark-name"},[e._v("Hồ sơ theo dõi")])]),e._v(" "),a("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},[a("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD","margin-left":"8px"}}),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"delete"}},[e._v("Xóa")])],1)],1)],1),e._v(" "),a("div",{staticClass:"fl-b"},[a("div",{staticClass:"fl-b-content"},[e._v(e._s(e.item.content))]),e._v(" "),e.item.img&&e.item.img.length>0?a("flexbox",{staticClass:"fl-b-images",attrs:{wrap:"wrap"}},e._l(e.item.img,function(t,i){return a("div",{directives:[{name:"lazy",rawName:"v-lazy:background-image",value:t.filePath,expression:"file.filePath",arg:"background-image"}],key:t.filePath,staticClass:"fl-b-img-item",on:{click:function(t){e.previewImg(e.item.img,i)}}})})):e._e(),e._v(" "),e.item.file&&e.item.file.length>0?a("div",{staticClass:"fl-b-files"},e._l(e.item.file,function(t,n){return a("flexbox",{key:n,staticClass:"cell"},[a("img",{staticClass:"cell-head",attrs:{src:i("6KEE")}}),e._v(" "),a("div",{staticClass:"cell-body"},[e._v(e._s(t.name)),a("span",{staticStyle:{color:"#ccc"}},[e._v("（"+e._s(t.size)+"）")])]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:function(i){e.downloadFile(t)}}},[e._v("Tải về")])],1)})):e._e(),e._v(" "),e.item.category||e.item.nextTime?a("div",{staticClass:"follow"},[e.item.category?a("span",{staticClass:"follow-info"},[e._v(e._s(e.item.category))]):e._e(),e._v(" "),e.item.nextTime?a("span",{staticClass:"follow-info"},[e._v(e._s(e.item.nextTime))]):e._e()]):e._e(),e._v(" "),e.item.contactsList&&e.item.contactsList.length>0?a("div",{staticClass:"fl-b-other"},[a("div",{staticClass:"fl-b-other-name"},[e._v("Các địa chỉ liên hệ")]),e._v(" "),a("div",e._l(e.item.contactsList,function(t,i){return a("flexbox",{key:i,staticClass:"cell",nativeOn:{click:function(i){e.checkRelationDetail("contacts",t.contactsId)}}},[a("i",{staticClass:"wukong wukong-contacts cell-head crm-type",style:{opacity:0==i?1:0}}),e._v(" "),a("div",{staticClass:"cell-body",staticStyle:{color:"#6394E5",cursor:"pointer"}},[e._v(e._s(t.name))])])}))]):e._e(),e._v(" "),e.item.businessList&&e.item.businessList.length>0?a("div",{staticClass:"fl-b-other"},[a("div",{staticClass:"fl-b-other-name"},[e._v("Các cơ hội kinh doanh")]),e._v(" "),a("div",e._l(e.item.businessList,function(t,i){return a("flexbox",{key:i,staticClass:"cell",nativeOn:{click:function(i){e.checkRelationDetail("business",t.businessId)}}},[a("i",{staticClass:"wukong wukong-business cell-head crm-type",style:{opacity:0==i?1:0}}),e._v(" "),a("div",{staticClass:"cell-body",staticStyle:{color:"#6394E5",cursor:"pointer"}},[e._v(e._s(t.businessName))])])}))]):e._e(),e._v(" "),e._t("default")],2),e._v(" "),a("c-r-m-full-screen-detail",{attrs:{visible:e.showFullDetail,"crm-type":e.relationCrmType,id:e.relationID},on:{"update:visible":function(t){e.showFullDetail=t}}})],1)},[],!1,null,"6a5917be",null);c.options.__file="FollowRecordCell.vue";t.a=c.exports},"4HcF":function(e,t,i){"use strict";var a=i("4S5L");i.n(a).a},"4S5L":function(e,t,i){},"5X97":function(e,t,i){},"5hU7":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjZDRTM3MDlBRUUzODExRTg4Njk3OTRBOTFDQjJDRjRCIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjZDRTM3MDlCRUUzODExRTg4Njk3OTRBOTFDQjJDRjRCIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NkNFMzcwOThFRTM4MTFFODg2OTc5NEE5MUNCMkNGNEIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NkNFMzcwOTlFRTM4MTFFODg2OTc5NEE5MUNCMkNGNEIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz52FujQAAAAVklEQVR42mK0a3nJQC44WC3GwMRAISBkwBEgPoxPAQsBA6wpdQHD0DIAFGD/0TAMoIsfptQFjNhiwQaLwv/oGoZhLBBKiUcpNcCGYHT8//+fIi8ABBgA6ZAToBWLB7IAAAAASUVORK5CYII="},"5j45":function(e,t,i){"use strict";var a=i("mX3o"),n=i("EgJF"),s=i("vG5h"),l=i("qbf4"),c=i("mkuN"),o=i("7Qib"),r={name:"RelativeBusiness",components:{CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-660d"),i.e("chunk-4b7d"),i.e("chunk-7962")]).then(i.bind(null,"uMjE"))},CRMCreateView:n.default,CrmRelative:c.a},mixins:[a.a],props:{id:[String,Number],crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1},detail:{type:Object,default:function(){return{}}}},data:function(){return{nopermission:!1,list:[],fieldList:[],tableHeight:"400px",showFullDetail:!1,isCreate:!1,businessId:"",createActionInfo:{type:"relative",crmType:this.crmType,data:{}},showRelativeView:!1,selectionList:[]}},computed:{customerId:function(){return this.detail.customerId},canRelation:function(){return"contacts"==this.crmType}},watch:{id:function(e){this.list=[],this.getDetail()}},mounted:function(){this.getDetail()},activated:function(){},deactivated:function(){},methods:{checkRelativeInfos:function(e){var t=this;if(e.data.length>0){var i={contactsId:this.id};i.businessIds=e.data.map(function(e){return e.businessId}).join(","),Object(l.l)(i).then(function(e){t.getDetail(),t.$message.success("Thành công")}).catch(function(){})}},unRelevanceHandleClick:function(){var e=this;0==this.selectionList.length?this.$message.error("Chưa chọn cơ hội kinh doanh"):this.$confirm("Xóa cơ hội kinh doanh?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){var t={contactsId:e.id};t.businessIds=e.selectionList.map(function(e){return e.businessId}).join(","),Object(l.o)(t).then(function(t){e.getDetail(),e.$message.success("Thành công")}).catch(function(){})}).catch(function(){e.$message.info("Không thành công")})},getFieldList:function(){this.fieldList.push({prop:"businessName",width:"200",label:"Tên cơ hội"}),this.fieldList.push({prop:"money",width:"200",label:"Số tiền dự kiến"}),this.fieldList.push({prop:"customerName",width:"200",label:"Tên khách hàng"}),this.fieldList.push({prop:"typeName",width:"200",label:"Loại cơ hội"}),this.fieldList.push({prop:"statusName",width:"200",label:"Trạng thái"})},getDetail:function(){var e=this;this.loading=!0;var t={contacts:l.g,customer:s.n}[this.crmType],i={};i[this.crmType+"Id"]=this.id,t(i).then(function(t){0==e.fieldList.length&&e.getFieldList(),e.nopermission=!1,e.loading=!1,e.list=t.data.list}).catch(function(t){102==t.code&&(e.nopermission=!0),e.loading=!1})},handleRowClick:function(e,t,i){this.businessId=e.businessId,this.showFullDetail=!0},headerRowStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}},cellStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}},createClick:function(){"contacts"==this.crmType?(this.createActionInfo.data.customer=this.detail,this.createActionInfo.relativeData={contactsId:this.detail.contactsId}):"customer"==this.crmType&&(this.createActionInfo.data.customer=this.detail),this.isCreate=!0},createSaveSuccess:function(){this.canRelation?this.$refs.crmrelative.refreshList():this.getDetail()},fieldFormatter:function(e,t){return"money"==t.property?Object(o.j)(e[t.property]):e[t.property]||"--"}}},d=(i("i7tK"),i("KHd+")),h=Object(d.a)(r,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"empty",rawName:"v-empty",value:e.nopermission,expression:"nopermission"}],staticClass:"rc-cont",attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"Không có quyền"}},[e.isSeas?e._e():i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(t){return e.createClick(t)}}},[e._v("Thêm cơ hội kinh doanh mới")]),e._v(" "),e.canRelation?i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(t){return e.unRelevanceHandleClick(t)}}},[e._v("Xóa cơ hội kinh doanh")]):e._e(),e._v(" "),e.canRelation?i("el-popover",{staticStyle:{"margin-right":"20px"},attrs:{placement:"bottom",width:"700","popper-class":"no-padding-popover",trigger:"click"},model:{value:e.showRelativeView,callback:function(t){e.showRelativeView=t},expression:"showRelativeView"}},[i("crm-relative",{ref:"crmrelative",attrs:{show:e.showRelativeView,radio:!1,action:{type:"condition",data:{moduleType:"customer",customerId:e.customerId}},"selected-data":{business:e.list},"crm-type":"business"},on:{close:function(t){e.showRelativeView=!1},changeCheckout:e.checkRelativeInfos},model:{value:e.showRelativeView,callback:function(t){e.showRelativeView=t},expression:"showRelativeView"}}),e._v(" "),i("el-button",{staticClass:"rc-head-item",staticStyle:{"margin-right":"0"},attrs:{slot:"reference",type:"primary"},nativeOn:{click:function(t){e.showRelativeView=!0}},slot:"reference"},[e._v("Xem")])],1):e._e()],1),e._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:e.list,height:e.tableHeight,"header-cell-style":e.headerRowStyle,"cell-style":e.cellStyle,stripe:""},on:{"row-click":e.handleRowClick,"selection-change":function(t){e.selectionList=t}}},[e.canRelation&&e.fieldList.length>0?i("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"selection",align:"center",width:"55"}}):e._e(),e._v(" "),e._l(e.fieldList,function(t,a){return i("el-table-column",{key:a,attrs:{prop:t.prop,label:t.label,formatter:e.fieldFormatter,"show-overflow-tooltip":""}})})],2),e._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:e.showFullDetail,id:e.businessId,"crm-type":"business"},on:{"update:visible":function(t){e.showFullDetail=t}}}),e._v(" "),e.isCreate?i("c-r-m-create-view",{attrs:{action:e.createActionInfo,"crm-type":"business"},on:{"save-success":e.createSaveSuccess,"hiden-view":function(t){e.isCreate=!1}}}):e._e()],1)},[],!1,null,"08a51d28",null);h.options.__file="RelativeBusiness.vue";t.a=h.exports},"5u+S":function(e,t,i){"use strict";var a=i("arjo");i.n(a).a},"62Ps":function(e,t,i){},"6pZM":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjAyMzg4NTNCNDE2NjExRTk4MkE1QUI2Q0I2MDkxQ0RDIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjAyMzg4NTNDNDE2NjExRTk4MkE1QUI2Q0I2MDkxQ0RDIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDIzODg1Mzk0MTY2MTFFOTgyQTVBQjZDQjYwOTFDREMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MDIzODg1M0E0MTY2MTFFOTgyQTVBQjZDQjYwOTFDREMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7hsdBeAAABLklEQVR42mL8WxjFgAWwAXEAFFsCsRQQ/wLiJ0B8HojXA/FGqBgKYMFiWCAQdwGxChZLNKA4EojvAHE5EK9DVsSExGYG4k6oAhUGwgCkZi1UDzM2F7YBcRkD6QCmpxzZhSH4DGPKrQNjAoaGwAwEhU0/XjcoqkMwfjABZBbIwFAglmGgHEgDcRgTNGlQCwSADDSlooEmIAMlqGigJAs0tbMTo5qpbymm4P2bDP8mN6Ek7OcETQJqwg0YkTnPQS68BMRq+MxDdgEBcAbkwg1UDMMNIANXQ0sRSsFTkFlM0EgpooKBhUD8E5aXQa7spsCwbqgZKMVXJRBPIcOwqVC9GOXhXyDOhZYad4gw6A60HMiB6sVZYoMKzc1QxaDS2xia8WEBfxZaBazGVgUABBgAnqU8Wz9MmZkAAAAASUVORK5CYII="},"71zx":function(e,t,i){},"7F7P":function(e,t,i){},"8KPp":function(e,t,i){"use strict";var a=i("FyfS"),n=i.n(a),s=i("Qldq"),l=i("Iae0"),c=i("KzkL"),o={name:"JournalLog",components:{JournalCell:l.a,CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-660d"),i.e("chunk-4b7d"),i.e("chunk-7962")]).then(i.bind(null,"uMjE"))},NewDialog:function(){return i.e("chunk-0b2f").then(i.bind(null,"kFvY"))}},props:{id:[String,Number],crmType:{type:String,default:""}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[],rowID:"",showFullDetail:!1,detailCRMType:"",showNewDialog:!1,formData:{},dialogTitle:"",imgFileList:[],accessoryFileList:[],newLoading:!1}},computed:{},watch:{id:function(e){this.refreshList()}},mounted:function(){var e=this,t=document.getElementById("follow-log-content");t.onscroll=function(){var i=t.scrollTop+t.clientHeight-t.scrollHeight;Math.abs(i)<10&&1==e.loadMoreLoading&&(e.isPost?e.loadMoreLoading=!1:(e.isPost=!0,e.page++,e.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var e=this;this.loading=!0;var t={page:this.page,limit:10};t[this.crmType+"Ids"]=this.id,Object(c.n)(t).then(function(t){e.list=e.list.concat(t.data.list),t.data.list.length<10?e.loadMoreLoading=!1:e.loadMoreLoading=!0,e.loading=!1,e.isPost=!1}).catch(function(){e.isPost=!1,e.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},jourecallCellHandle:function(e){var t=this;if("edit"==e.type){var i=e.data.item;if(this.showNewDialog=!0,this.dialogTitle="Chỉnh sửa nhật ký",this.formData=i,this.imgFileList=[],i.imgList){var a=!0,l=!1,c=void 0;try{for(var o,r=n()(i.imgList);!(a=(o=r.next()).done);a=!0){var d=o.value;d.url=d.filePath,this.imgFileList.push(d)}}catch(e){l=!0,c=e}finally{try{!a&&r.return&&r.return()}finally{if(l)throw c}}}if(this.accessoryFileList=[],i.fileList){var h=!0,u=!1,m=void 0;try{for(var p,f=n()(i.fileList);!(h=(p=f.next()).done);h=!0){var v=p.value;v.url=v.filePath,this.accessoryFileList.push(v)}}catch(e){u=!0,m=e}finally{try{!h&&f.return&&f.return()}finally{if(u)throw m}}}this.formData.depData=i.sendStructList?i.sendStructList:[],this.formData.sentWhoList=i.sendUserList?i.sendUserList:[]}else"delete"==e.type?this.$confirm("Xác nhận xóa?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){Object(s.b)({logId:e.data.item.logId}).then(function(i){for(var a in t.$message({type:"success",message:"Thành công!"}),t.list)if(t.list[a].logId==e.data.item.logId){t.list.splice(a,1);break}})}).catch(function(){t.$message({type:"info",message:"Không thành công"})}):"related-detail"==e.type&&(this.rowID=e.data.item.key,this.detailCRMType=e.data.type,this.showFullDetail=!0)},submitBtn:function(e,t,i,a){var l=this;this.newLoading=!0,console.log(a,"==relevanceAll==");var c=[],o=[],r=[];if(this.formData.depData){var d=!0,h=!1,u=void 0;try{for(var m,p=n()(this.formData.depData);!(d=(m=p.next()).done);d=!0){var f=m.value;r.push(f.id)}}catch(e){h=!0,u=e}finally{try{!d&&p.return&&p.return()}finally{if(h)throw u}}}var v=[];if(this.formData.sentWhoList){var g=!0,b=!1,y=void 0;try{for(var C,w=n()(this.formData.sentWhoList);!(g=(C=w.next()).done);g=!0){var I=C.value;v.push(I.id)}}catch(e){b=!0,y=e}finally{try{!g&&w.return&&w.return()}finally{if(b)throw y}}}var k=!0,T=!1,x=void 0;try{for(var _,A=n()(this.imgFileList);!(k=(_=A.next()).done);k=!0){var D=_.value;c.push(D.fileId)}}catch(e){T=!0,x=e}finally{try{!k&&A.return&&A.return()}finally{if(T)throw x}}var N=!0,R=!1,L=void 0;try{for(var S,E=n()(this.accessoryFileList);!(N=(S=E.next()).done);N=!0){var j=S.value;o.push(j.fileId)}}catch(e){R=!0,L=e}finally{try{!N&&E.return&&E.return()}finally{if(R)throw L}}var M={};M=a||{};var O={logId:this.formData.logId,categoryId:e,content:this.formData.content,tomorrow:this.formData.tomorrow,question:this.formData.question,file:o.concat(c),sendUserIds:v.join(","),sendStructureIds:r.join(","),customerIds:M.customerIds.join(","),contactsIds:M.contactsIds.join(","),businessIds:M.businessIds.join(","),contractIds:M.contractIds.join(",")};Object(s.c)(O).then(function(e){l.refreshList(),l.showNewDialog=!1,l.$message.success("Thành công"),l.newLoading=!1}).catch(function(){l.newLoading=!1,l.$message.error("Không thành công")})}}},r=(i("DqJb"),i("KHd+")),d=Object(r.a)(o,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:0===e.list.length,expression:"list.length === 0"}]},[i("div",{staticClass:"log-items"},[e._l(e.list,function(t,a){return i("journal-cell",{key:a,staticClass:"list-cell",attrs:{data:t},on:{"on-handle":e.jourecallCellHandle}})}),e._v(" "),i("div",{staticClass:"load"},[i("el-button",{attrs:{loading:e.loadMoreLoading,type:"text"}},[e._v(e._s(e.loadMoreLoading?"Tải thêm":"Không có dữ liệu"))])],1)],2)]),e._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:e.showFullDetail,"crm-type":e.detailCRMType,id:e.rowID},on:{"update:visible":function(t){e.showFullDetail=t}}}),e._v(" "),e.showNewDialog?i("new-dialog",{attrs:{"form-data":e.formData,"dialog-title":e.dialogTitle,"img-file-list":e.imgFileList,"accessory-file-list":e.accessoryFileList,"new-loading":e.newLoading},on:{close:function(t){e.showNewDialog=!1},submitBtn:e.submitBtn}}):e._e()],1)},[],!1,null,"74ea8a37",null);d.options.__file="JournalLog.vue";t.a=d.exports},"8gwX":function(e,t,i){"use strict";var a=i("YrMO"),n=i("Ew9n"),s=i("F03V"),l=i("U05J"),c=i("C+sD"),o=i("8DbX"),r=i("EgJF"),d=i("4+0Q"),h={name:"ProductDetail",components:{SlideView:n.a,CRMDetailHead:s.a,CRMBaseInfo:l.a,RelativeFiles:c.a,RelativeHandle:o.a,CRMCreateView:r.default},mixins:[d.a],props:{id:[String,Number],listenerIDs:{type:Array,default:function(){return["crm-main-container"]}},noListenerIDs:{type:Array,default:function(){return[]}},noListenerClass:{type:Array,default:function(){return["el-table__body"]}}},data:function(){return{loading:!1,crmType:"product",detailData:{},headDetails:[{title:"Danh mục sản phẩm",value:""},{title:"Đơn vị sản phẩm",value:""},{title:"Giá sản phẩm",value:""},{title:"Mã sản phẩm (SKU)",value:""}],tabnames:[{label:"Thông tin sản phẩm",name:"basicinfo"},{label:"Ảnh sản phẩm",name:"file"},{label:"Nhật ký",name:"operationlog"}],tabCurrentName:"basicinfo",isCreate:!1}},computed:{tabName:function(){return"basicinfo"==this.tabCurrentName?"c-r-m-base-info":"file"==this.tabCurrentName?"relative-files":"operationlog"==this.tabCurrentName?"relative-handle":""}},mounted:function(){},methods:{getDetial:function(){var e=this;this.loading=!0,Object(a.g)({productId:this.id}).then(function(t){e.loading=!1,e.detailData=t.data,e.headDetails[0].value=t.data.categoryName,e.headDetails[1].value=t.data.单位,e.headDetails[2].value=e.moneyFormat(t.data.price),e.headDetails[3].value=t.data.num}).catch(function(){e.loading=!1})},hideView:function(){this.$emit("hide-view")},handleClick:function(e,t){},editSaveSuccess:function(){this.$emit("handle",{type:"save-success"}),this.getDetial()}}},u=(i("rq0Q"),i("KHd+")),m=Object(u.a)(h,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("slide-view",{directives:[{name:"empty",rawName:"v-empty",value:!e.canShowDetail,expression:"!canShowDetail"}],attrs:{"listener-ids":e.listenerIDs,"no-listener-ids":e.noListenerIDs,"no-listener-class":e.noListenerClass,"body-style":{padding:0,height:"100%"},"xs-empty-icon":"nopermission","xs-empty-text":"Không có quyền"},on:{"side-close":e.hideView}},[e.canShowDetail?i("flexbox",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"d-container",attrs:{direction:"column",align:"stretch"}},[i("c-r-m-detail-head",{attrs:{detail:e.detailData,"head-details":e.headDetails,id:e.id,"crm-type":"product"},on:{handle:e.detailHeadHandle,close:e.hideView}}),e._v(" "),i("div",{staticClass:"tabs"},[i("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.tabCurrentName,callback:function(t){e.tabCurrentName=t},expression:"tabCurrentName"}},e._l(e.tabnames,function(e,t){return i("el-tab-pane",{key:t,attrs:{label:e.label,name:e.name}})}))],1),e._v(" "),i("div",{staticClass:"t-loading-content"},[i("keep-alive",[i(e.tabName,{tag:"component",attrs:{detail:e.detailData,id:e.id,"crm-type":"product"}})],1)],1)],1):e._e(),e._v(" "),e.isCreate?i("c-r-m-create-view",{attrs:{action:{type:"update",id:e.id,batchId:e.detailData.batchId},"crm-type":"product"},on:{"save-success":e.editSaveSuccess,"hiden-view":function(t){e.isCreate=!1}}}):e._e()],1)},[],!1,null,"e3446368",null);m.options.__file="ProductDetail.vue";t.a=m.exports},AnnZ:function(e,t,i){"use strict";var a=i("BirF");i.n(a).a},B7ox:function(e,t,i){"use strict";var a=i("Qq94");i.n(a).a},BLwn:function(e,t,i){"use strict";var a=i("Z9VC");i.n(a).a},BirF:function(e,t,i){},BuGm:function(e,t,i){"use strict";i.r(t);var a=i("gDS+"),n=i.n(a),s=i("FyfS"),l=i.n(s),c=i("Dh/N"),o=i("1RnH"),r=i("0hym"),d=i("7Qib"),h={components:{relatedBusiness:o.a,XhUser:r.a},props:{formData:{type:Object,default:function(){return{color:""}}},text:{type:String,default:"Tạo lịch biểu"},appendToBody:{type:Boolean,default:!1}},data:function(){var e=this,t=function(t,i,a){e.formData.startTime&&e.formData.endTime&&Object(d.e)(e.formData.startTime)>=Object(d.e)(e.formData.endTime)&&a(new Error("Thời gian bắt đầu phải nhỏ hơn thời gian kết thúc")),a()};return{zIndex:Object(d.h)(),formList:[{label:"Tên",field:"title",type:"color"},{label:"Giờ bắt đầu",field:"startTime",type:"time"},{label:"Giờ kết thức",field:"endTime",type:"time"},{label:"Người tham dự",field:"ownerUserIds",type:"participant"},{label:"Mô tả",field:"remark",type:"textarea",width:"100%"}],options:[{value:0,label:"Không nhắc"},{value:1,label:"Nhắc đúng giờ"},{value:2,label:"Nhắc trước 5 phút"},{value:3,label:"Nhắc trước 15 phút"},{value:4,label:"Nhắc trước 30 phút"},{value:5,label:"Nhắc trước 1 giờ"},{value:6,label:"Nhắc trước 2 giờ"},{value:7,label:"Nhắc trước 1 ngày"},{value:8,label:"Nhắc trước 2 ngày"},{value:9,label:"Nhắc trước 1 tuần"}],fileList:[],loading:!1,colorList:["#3E8EF7","#11C06C","#0BB2D4","#EB6709","#FF4C52","#526069","#9262F4"],rules:{title:[{required:!0,message:"Tên không được trống",trigger:"blur"},{max:50,message:"Tên tối đa 50 ký tự",trigger:"blur"}],startTime:[{required:!0,message:"Phải chọn giờ bắt đầu",trigger:"blur"},{validator:t,trigger:"blur"}],endTime:[{required:!0,message:"Phải chọn giờ kết thúc",trigger:"blur"},{validator:t,trigger:"blur"}]},relevanceAll:{},allData:{},colleaguesList:[]}},created:function(){},mounted:function(){this.appendToBody&&document.body.appendChild(this.$el),this.allData.business=this.formData.businessList?this.formData.businessList:[],this.allData.contacts=this.formData.contactsList?this.formData.contactsList:[],this.allData.contract=this.formData.contractList?this.formData.contractList:[],this.allData.customer=this.formData.customerList?this.formData.customerList:[],this.formData.ownerList&&(this.colleaguesList=[].concat(this.formData.ownerList)),"Tạo lịch biểu"==this.text&&this.$set(this.formData,"color","#3E8EF7")},beforeDestroy:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},methods:{close:function(){1==this.$route.query.routerKey?this.$router.go(-1):this.$emit("closeDialog")},checkInfos:function(e){this.relevanceAll=e},onSubmit:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return!1;e.loading=!0;var i=e.formData,a=[],s=!0,o=!1,r=void 0;try{for(var d,h=l()(e.colleaguesList);!(s=(d=h.next()).done);s=!0){var u=d.value;a.push(u.userId)}}catch(e){o=!0,r=e}finally{try{!s&&h.return&&h.return()}finally{if(o)throw r}}if("Tạo lịch biểu"==e.text)Object(c.a)({title:i.title,startTime:i.startTime,endTime:i.endTime,ownerUserIds:a.join(","),remark:i.remark,color:i.color,customerIds:e.relevanceAll.customerIds?e.relevanceAll.customerIds.join(","):[],contactsIds:e.relevanceAll.contactsIds?e.relevanceAll.contactsIds.join(","):[],businessIds:e.relevanceAll.businessIds?e.relevanceAll.businessIds.join(","):[],contractIds:e.relevanceAll.contractIds?e.relevanceAll.contractIds.join(","):[]}).then(function(t){1==e.$route.query.routerKey?e.$router.push("schedule"):e.$emit("onSubmit"),e.loading=!1}).catch(function(){e.loading=!1});else{var m={customerIds:[],contractIds:[],contactsIds:[],businessIds:[]};if(e.allData.customer){var p=!0,f=!1,v=void 0;try{for(var g,b=l()(e.allData.customer);!(p=(g=b.next()).done);p=!0){var y=g.value;m.customerIds.push(y.customerId)}}catch(e){f=!0,v=e}finally{try{!p&&b.return&&b.return()}finally{if(f)throw v}}}if(e.allData.contract){var C=!0,w=!1,I=void 0;try{for(var k,T=l()(e.allData.contract);!(C=(k=T.next()).done);C=!0){var x=k.value;m.contractIds.push(x.contractId)}}catch(e){w=!0,I=e}finally{try{!C&&T.return&&T.return()}finally{if(w)throw I}}}if(e.allData.contacts){var _=!0,A=!1,D=void 0;try{for(var N,R=l()(e.allData.contacts);!(_=(N=R.next()).done);_=!0){var L=N.value;m.contactsIds.push(L.contactsId)}}catch(e){A=!0,D=e}finally{try{!_&&R.return&&R.return()}finally{if(A)throw D}}}if(e.allData.business){var S=!0,E=!1,j=void 0;try{for(var M,O=l()(e.allData.business);!(S=(M=O.next()).done);S=!0){var F=M.value;m.businessIds.push(F.businessId)}}catch(e){E=!0,j=e}finally{try{!S&&O.return&&O.return()}finally{if(E)throw j}}}var B="{}"==n()(e.relevanceAll)?m:e.relevanceAll;Object(c.c)({eventId:i.eventId,title:i.title,startTime:i.startTime,endTime:i.endTime,ownerUserIds:a.join(","),remark:i.remark,color:i.color,customerIds:B.customerIds.join(","),contactsIds:B.contactsIds.join(","),businessIds:B.businessIds.join(","),contractIds:B.contractIds.join(",")}).then(function(t){e.$emit("onSubmit"),e.loading=!1}).catch(function(){e.loading=!1})}})},httpRequest:function(e){this.fileList.push(e.file)},onRemove:function(e){for(var t in this.fileList)this.fileList[t].uid==e.uid&&this.fileList.splice(t,1)},changeColor:function(e){this.$set(this.formData,"color",e)},changeCheckout:function(e){this.colleaguesList=e.data},selectDelect:function(e,t){this.$refs.xhuser[0].cancelCheckItem(e),this.colleaguesList.splice(t,1)}}},u=(i("h+C4"),i("KHd+")),m=Object(u.a)(h,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"create-schedule",style:{"z-index":e.zIndex}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"add-schedule"},[a("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"text"},[e._v(e._s(e.text))]),e._v(" "),a("img",{staticClass:"el-icon-close rt",attrs:{src:i("cjwK"),alt:""},on:{click:e.close}})]),e._v(" "),a("div",{staticClass:"content"},[a("el-form",{ref:"form",attrs:{model:e.formData,rules:e.rules}},e._l(e.formList,function(t,i){return a("el-form-item",{key:i,class:"el-form-item-"+t.field,style:{width:t.width},attrs:{prop:t.field,label:t.label}},["time"==t.type?[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"Chọn"},model:{value:e.formData[t.field],callback:function(i){e.$set(e.formData,t.field,i)},expression:"formData[item.field]"}})]:"textarea"==t.type?[a("el-input",{attrs:{autosize:{minRows:6},type:"textarea",placeholder:"Vui lòng nhập nội dung"},model:{value:e.formData[t.field],callback:function(i){e.$set(e.formData,t.field,i)},expression:"formData[item.field]"}})]:"participant"==t.type?[a("el-popover",{attrs:{placement:"bottom-end",width:"280",trigger:"click"}},[a("xh-user",{ref:"xhuser",refInFor:!0,attrs:{"selected-data":e.colleaguesList},on:{changeCheckout:e.changeCheckout}}),e._v(" "),a("div",{staticClass:"select-box",attrs:{slot:"reference"},slot:"reference"},[e._l(e.colleaguesList,function(t,i){return a("span",{key:i,staticClass:"select-box-span"},[e._v("\n                  "+e._s(t.realname)+"\n                  "),a("span",{staticClass:"el-icon-close",on:{click:function(a){a.stopPropagation(),e.selectDelect(t,i)}}})])}),e._v(" "),a("span",{staticClass:"el-icon-plus"})],2)],1)]:"select"==t.type?[a("el-select",{attrs:{placeholder:"Chọn"},model:{value:e.formData[t.field],callback:function(i){e.$set(e.formData,t.field,i)},expression:"formData[item.field]"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))]:"color"==t.type?[a("el-input",{attrs:{placeholder:"Vui lòng nhập nội dung"},model:{value:e.formData[t.field],callback:function(i){e.$set(e.formData,t.field,i)},expression:"formData[item.field]"}},[a("i",{staticClass:"el-input__icon",attrs:{slot:"prefix"},slot:"prefix"},[a("span",{staticClass:"bg-color",style:{background:e.formData.color}})])]),e._v(" "),a("div",{staticClass:"color-box"},e._l(e.colorList,function(t,i){return a("span",{key:i,style:{background:t},on:{click:function(i){e.changeColor(t)}}})}))]:a("el-input",{model:{value:e.formData[t.field],callback:function(i){e.$set(e.formData,t.field,i)},expression:"formData[item.field]"}})],2)})),e._v(" "),a("related-business",{attrs:{"all-data":e.allData},on:{checkInfos:e.checkInfos}})],1),e._v(" "),a("div",{staticClass:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("Lưu")]),e._v(" "),a("el-button",{on:{click:e.close}},[e._v("Hủy")])],1)])])},[],!1,null,"4bb86ca4",null);m.options.__file="createSchedule.vue";t.default=m.exports},"C+yI":function(e,t,i){"use strict";var a=i("HSrj");i.n(a).a},DPCt:function(e,t,i){},DUlf:function(e,t,i){"use strict";var a=i("mX3o"),n=i("eOzp"),s=i("vG5h"),l=i("UcQx"),c=i("6zBA"),o={name:"RelativeTeam",components:{TeamsHandle:n.a},mixins:[a.a],props:{id:[String,Number],detail:{type:Object,default:function(){return{}}},crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1}},data:function(){return{list:[],fieldList:[],tableHeight:"400px",teamsDialogShow:!1,handleType:1,editPermissionShow:!1,selectionList:[]}},computed:{},watch:{id:function(e){this.list=[],this.getDetail()}},mounted:function(){this.fieldList.push({prop:"realname",width:"200",label:"Họ và tên"}),this.fieldList.push({prop:"name",width:"200",label:"Chức vụ"}),this.fieldList.push({prop:"groupRole",width:"200",label:"Vai trò trong nhóm"}),this.fieldList.push({prop:"power",width:"200",label:"Quyền"}),this.getDetail()},activated:function(){},deactivated:function(){},methods:{getDetail:function(){var e=this;this.loading=!0;var t={customer:s.B,business:l.r,contract:c.o}[this.crmType],i={};i[this.crmType+"Id"]=this.id,t(i).then(function(t){e.loading=!1,e.list=t.data}).catch(function(){e.loading=!1})},handleSelectionChange:function(e){this.selectionList=e},handleClick:function(e){var t=this;"add"==e?this.teamsDialogShow=!0:0==this.selectionList.length?this.$message.error("Chưa chọn thành viên"):"edit"==e?this.editPermissionShow=!0:"remove"==e&&this.$confirm("Xác nhận xóa thành viên khỏi nhóm?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){var e=t.selectionList.map(function(e,t,i){return e.id}),i={customer:s.z,contract:c.m,business:l.n}[t.crmType],a={ids:t.id,memberIds:e.join(",")};t.loading=!0,i(a).then(function(e){t.$message({type:"success",message:"Thành công"}),t.loading=!1,t.getDetail()}).catch(function(){t.loading=!1})}).catch(function(){t.$message({type:"info",message:"Không thành công"})})},handleCallBack:function(e){this.getDetail()},handleEditConfirm:function(){var e=this,t=this.selectionList.map(function(e,t,i){return e.id});this.loading=!0,(0,{customer:s.D,business:l.u,contract:c.q}[this.crmType])({ids:this.id,memberIds:t.join(","),power:this.handleType}).then(function(t){e.editPermissionShow=!1,e.$message({type:"success",message:"Thành công"}),e.loading=!1,e.getDetail()}).catch(function(){e.loading=!1})},handleSelectable:function(e,t){return"Quản lý nhóm"!=e.power},handleRowClick:function(e,t,i){},headerRowStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}},cellStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}}}},r=(i("x6i0"),i("KHd+")),d=Object(r.a)(o,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"rc-cont"},[e.isSeas?e._e():i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(t){e.handleClick("remove")}}},[e._v("Xóa")]),e._v(" "),i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(t){e.handleClick("edit")}}},[e._v("Chỉnh sửa")]),e._v(" "),i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(t){e.handleClick("add")}}},[e._v("Thêm mới")])],1),e._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:e.list,height:e.tableHeight,"header-cell-style":e.headerRowStyle,"cell-style":e.cellStyle,stripe:""},on:{"row-click":e.handleRowClick,"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{selectable:e.handleSelectable,"show-overflow-tooltip":"",type:"selection",align:"center",width:"55"}}),e._v(" "),e._l(e.fieldList,function(e,t){return i("el-table-column",{key:t,attrs:{prop:e.prop,label:e.label,"show-overflow-tooltip":""}})})],2),e._v(" "),i("teams-handle",{attrs:{"crm-type":e.crmType,"selection-list":[e.detail],"dialog-visible":e.teamsDialogShow,title:"Thêm thành viên trong nhóm"},on:{"update:dialogVisible":function(t){e.teamsDialogShow=t},handle:e.handleCallBack}}),e._v(" "),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{visible:e.editPermissionShow,"append-to-body":!0,title:"Chỉnh sửa quyền",width:"400px"},on:{"update:visible":function(t){e.editPermissionShow=t}}},[i("div",{staticClass:"handle-box"},[i("flexbox",{staticClass:"handle-item"},[i("div",{staticClass:"handle-item-name"},[e._v("Quyền:")]),e._v(" "),i("el-radio-group",{model:{value:e.handleType,callback:function(t){e.handleType=t},expression:"handleType"}},[i("el-radio",{attrs:{label:1}},[e._v("Chỉ xem")]),e._v(" "),i("el-radio",{attrs:{label:2}},[e._v("Chỉnh sửa")])],1)],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{nativeOn:{click:function(t){e.editPermissionShow=!1}}},[e._v("Đóng")]),e._v(" "),i("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.handleEditConfirm(t)}}},[e._v("Lưu")])],1)])],1)},[],!1,null,"763f508c",null);d.options.__file="RelativeTeam.vue";t.a=d.exports},"Dh/N":function(e,t,i){"use strict";i.d(t,"d",function(){return n}),i.d(t,"a",function(){return s}),i.d(t,"b",function(){return l}),i.d(t,"c",function(){return c});var a=i("t3Un");function n(e){return Object(a.a)({url:"OaEvent/queryList",method:"post",data:e})}function s(e){return Object(a.a)({url:"OaEvent/add",method:"post",data:e})}function l(e){return Object(a.a)({url:"OaEvent/delete",method:"post",data:e})}function c(e){return Object(a.a)({url:"OaEvent/update",method:"post",data:e})}},DqJb:function(e,t,i){"use strict";var a=i("3vFt");i.n(a).a},F5VI:function(e,t,i){"use strict";var a=i("g1XH");i.n(a).a},Fpl1:function(e,t,i){"use strict";var a=i("Er7M"),n=i("O1Uw"),s={name:"ExamineCell",components:{RelatedBusinessCell:a.a,FileCell:n.a},mixins:[],props:{data:Object},data:function(){return{}},computed:{relatedListData:function(){return{contacts:this.data.contactsList||[],customer:this.data.customerList||[],business:this.data.businessList||[],contract:this.data.contractList||[]}}},watch:{},mounted:function(){},methods:{getStatusName:function(e){return 0==e?"Đang chờ xử lý":1==e?"Đã duyệt":2==e?"Bị từ chối":3==e?"Đang xem xét":4==e?"Rút lại":""},getStatusColor:function(e){return 0==e?"#F3A633":1==e?"#93E06D":2==e?"#FF0000":3==e?"#F3A633":4==e?"#FF0000":""},imgZoom:function(e,t){this.$bus.emit("preview-image-bus",{index:t,data:e.map(function(e,t,i){return{url:e.filePath,name:e.name}})})},handleCommand:function(e){this.$emit("on-handle",{type:e,data:{item:this.data}})},checkDetail:function(e){this.$emit("on-handle",{type:"view",data:{item:this.data}})},checkRelatedDetail:function(e,t){this.$emit("on-handle",{type:"related-detail",data:{type:e,item:t}})}}},l=(i("4HcF"),i("KHd+")),c=Object(l.a)(s,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"list"},[i("div",{staticClass:"list-content"},[i("flexbox",{staticClass:"header"},[i("div",{directives:[{name:"photo",rawName:"v-photo",value:e.data.createUser,expression:"data.createUser"},{name:"lazy",rawName:"v-lazy:background-image",value:e.$options.filters.filterUserLazyImg(e.data.createUser.img),expression:"$options.filters.filterUserLazyImg(data.createUser.img)",arg:"background-image"}],staticClass:"div-photo head-img"}),e._v(" "),i("div",{staticClass:"name-time"},[i("span",{staticClass:"name"},[e._v(e._s(e.data.createUser.realname))]),e._v(" "),i("span",{staticClass:"time"},[e._v(e._s(e.data.createtime))])]),e._v(" "),i("div",{staticClass:"rt-setting"},[i("span",{staticClass:"bg-color",style:{"background-color":e.getStatusColor(e.data.examineStatus)}}),e._v(" "),i("span",{staticClass:"dep"},[i("span",[e._v(e._s(e.data.categoryTitle)+" - ")]),e._v(" "),i("span",[e._v(e._s(e.getStatusName(e.data.examineStatus)))])]),e._v(" "),e.data.permission&&(e.data.permission.isChecked||e.data.permission.isUpdate||e.data.permission.isDelete)?i("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},[i("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD",cursor:"pointer"}}),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e.data.permission&&e.data.permission.isChecked?i("el-dropdown-item",{attrs:{command:"withdraw"}},[e._v("Rút lại")]):e._e(),e._v(" "),e.data.permission&&e.data.permission.isUpdate?i("el-dropdown-item",{attrs:{command:"edit"}},[e._v("Chỉnh sửa")]):e._e(),e._v(" "),e.data.permission&&e.data.permission.isDelete?i("el-dropdown-item",{attrs:{command:"delete"}},[e._v("Xóa")]):e._e()],1)],1):e._e()],1)]),e._v(" "),i("div",{staticClass:"row",on:{click:function(t){e.checkDetail(e.data)}}},[e.data.content?i("p",{staticClass:"text"},[e._v(e._s(e.data.content))]):e._e(),e._v(" "),e.data.causeTitle?i("p",{staticClass:"title"},[e._v(e._s(e.data.causeTitle))]):e._e()]),e._v(" "),e.data.file.length>0||e.data.img.length>0?i("div",{staticClass:"accessory"},[i("div",{staticClass:"upload-img-box"},e._l(e.data.img,function(t,a){return i("div",{key:a,staticClass:"img-list",on:{click:function(t){e.imgZoom(e.data.img,a)}}},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.filePath,expression:"imgItem.filePath"}]})])})),e._v(" "),i("div",{staticClass:"accessory-box"},e._l(e.data.file,function(e,t){return i("file-cell",{key:t,attrs:{data:e,"cell-index":t}})}))]):e._e(),e._v(" "),e.relatedListData.contacts.length>0||e.relatedListData.customer.length>0||e.relatedListData.business.length>0||e.relatedListData.contract.length>0?i("div",{staticClass:"related-business"},[i("div",{staticClass:"label"},[e._v("Hỗ trợ kinh doanh")]),e._v(" "),e._l(e.relatedListData,function(t,a){return i("div",{key:a},e._l(t,function(t,n){return i("related-business-cell",{key:n,attrs:{data:t,"cell-index":n,type:a,"show-foot":!1},nativeOn:{click:function(i){e.checkRelatedDetail(a,t)}}})}))})],2):e._e()],1)])},[],!1,null,"7cac94fc",null);c.options.__file="examineCell.vue";t.a=c.exports},GugH:function(e,t,i){"use strict";var a=i("KJoY");i.n(a).a},"H+hK":function(e,t,i){},HSrj:function(e,t,i){},HbFV:function(e,t,i){},HfS2:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjZBOTA3QjY4RUUzODExRTg5NkQyQzE5MENDMkUwODZEIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjZBOTA3QjY5RUUzODExRTg5NkQyQzE5MENDMkUwODZEIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NkE5MDdCNjZFRTM4MTFFODk2RDJDMTkwQ0MyRTA4NkQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NkE5MDdCNjdFRTM4MTFFODk2RDJDMTkwQ0MyRTA4NkQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz77tjJFAAABTElEQVR42qTTzyvEQRjH8V0hbk6r/Ngc2CgnthC2Jc7KKsVfIOtGrbuNoiRaf4FSGzlL2oMD+XHSJvaEhJM9rRvvR5+tOXz3G5l61czOM8/OzDPfYGzlLfCfVuUzl8eX5P+aoBHNaBDrh7wCq53+NlpwizmkUdRcWrvYRTeeseDuIIpJ5FCPPuxgHINK3q+5nGKj7g4yWMeWxsM4RUHjdsxiUeOgkg6UExxiGfsoIYsZJbE2igNEtAuL3XR3sIYYelGHC2dxQP1zjOET11pTsQo1Hr/V+pUxpX+3zCfqx524EfRo7kbzKfcIdqureNV4Cnt40G7akFBZi4qdtmOUE8zjSK+uVfXuxJDmz9CEDTxhCRPuES5VibiqYJeYxLEkdYklxVjs1U89K3xM9pTvEdb4ER1493vKbrOsL/jQ+M5rsV8Ca12/+Zy/BRgAE3dJqM+BEpAAAAAASUVORK5CYII="},I0zU:function(e,t,i){},Iae0:function(e,t,i){"use strict";var a=i("QbLZ"),n=i.n(a),s=i("Xjjk"),l=i.n(s),c=i("S3Kq"),o=i("Qldq"),r=i("vPra"),d=i("1RnH"),h=i("L2JU"),u=i("O1Uw"),m={name:"JournalCell",components:{emoji:c.a,relatedBusiness:d.a,FileCell:u.a},mixins:[],props:{data:Object,logIndex:{type:Number,default:0},showWorkbench:{type:Boolean,default:!1}},data:function(){return{commentsTextarea:"",childCommentsTextarea:"",commentsPopover:!1,replyChildComment:null,replyChildIndex:-1,childCommentsPopover:!1,blurIndex:0,contentLoading:!1,parentTarget:null,awaitMoment:!1,replyList:[]}},computed:n()({},Object(h.b)(["userInfo"]),{allData:function(){var e={};return e.business=this.data.businessList,e.contacts=this.data.contactsList,e.contract=this.data.contractList,e.customer=this.data.customerList,e},allDataShow:function(){return 0!=this.data.businessList.length||0!=this.data.contactsList.length||0!=this.data.contractList.length||0!=this.data.customerList.length}}),watch:{},mounted:function(){var e=this;0!=this.data.isRead||this.showWorkbench||(this.$bus.on("journal-list-box-scroll",function(t){e.observePreview(t)}),this.observePreview(document.getElementById("journal-cell"+this.logIndex).parentNode)),this.replyList=this.data.replyList},beforeDestroy:function(){this.$bus.off("journal-list-box-scroll")},methods:{observePreview:function(e){var t=this;if(0==this.data.isRead){e&&(this.parentTarget=e);var i=this.whetherPreview();!this.awaitMoment&&i&&(this.awaitMoment=!0,setTimeout(function(){t.awaitMoment=!1,t.whetherPreview()&&t.submiteIsRead()},3e3))}},whetherPreview:function(){var e=this.parentTarget.children[this.logIndex];if(this.parentTarget.getBoundingClientRect()){var t=this.parentTarget.getBoundingClientRect().top-e.getBoundingClientRect().top,i=!1;return t<=0&&Math.abs(t)<this.parentTarget.clientHeight?i=!0:t>0&&t<e.clientHeight&&(i=!0),i}return!1},submiteIsRead:function(){var e=this;Object(o.e)({logId:this.showWorkbench?this.data.actionId:this.data.logId}).then(function(t){e.$store.dispatch("GetOAMessageNum","log"),e.data.isRead=1}).catch(function(){})},getCommentList:function(){var e=this;Object(r.b)({typeId:this.data.logId,type:1}).then(function(t){e.replyList=t.data}).catch(function(){})},verifyAwaitInfo:function(){},handleCommand:function(e){this.$emit("on-handle",{type:e,data:{item:this.data}})},checkRelatedDetail:function(e,t){this.$emit("on-handle",{type:"related-detail",data:{type:e,item:t}})},discussDelete:function(e,t,i){var a=this;this.$confirm("Xác nhận xóa?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){Object(r.a)({commentId:e.commentId}).then(function(e){a.$message({type:"success",message:"Thành công!"}),t.splice(i,1),a.$emit("on-handle",{type:"discuss-delete",data:{item:a.data}})})}).catch(function(){a.$message({type:"info",message:"Không thành công"})})},discussBtn:function(e,t){e.show?(this.$set(e,"show",!1),this.replyChildComment=null):(this.$set(e,"show",!0),this.$set(e,"showComment",!1),this.replyChildComment=e,this.replyChildIndex=t)},childCommentSubmit:function(){var e=this;if(this.replyChildComment&&this.childCommentsTextarea){var t=-1==this.replyChildIndex?this.replyChildComment:this.replyChildComment.childCommentList[this.replyChildIndex];this.contentLoading=!0,Object(r.c)({pid:t.userId,typeId:t.typeId,mainId:0==t.mainId?t.commentId:t.mainId,type:2,content:l()(this.childCommentsTextarea)}).then(function(i){e.childCommentsPopover=!1,i.data.user=e.userInfo,i.data.replyUser=t.user,e.replyChildComment.childCommentList.push(i.data),e.$message.success("Thành công"),e.replyChildComment.show=!1,e.replyChildComment=null,e.contentLoading=!1,e.childCommentsTextarea="",e.$emit("on-handle",{type:"discuss-submit",data:{item:e.data}})}).catch(function(){e.$message.error("Không thành công"),e.contentLoading=!1})}},commentSubmit:function(){var e=this;this.commentsTextarea&&(this.contentLoading=!0,Object(r.c)({typeId:this.showWorkbench?this.data.actionId:this.data.logId,type:2,content:l()(this.commentsTextarea)}).then(function(t){e.$set(e.data,"showComment",!1),t.data.childCommentList=[],t.data.show=!1,t.data.user=e.userInfo,e.replyList.push(t.data),e.commentsTextarea="",e.$message.success("Thành công"),e.contentLoading=!1}).catch(function(){e.$message.error("Không thành công"),e.contentLoading=!1}))},commentBtn:function(e){e.showComment?this.$set(e,"showComment",!1):(this.replyChildComment&&(this.replyChildComment.show=!1),this.$set(e,"showComment",!0))},selectEmoji:function(e){var t=this.commentsTextarea.split("");t.splice(this.blurIndex,0,e),this.commentsTextarea=t.join(""),this.commentsPopover=!1},childSelectEmoji:function(e){var t=this.childCommentsTextarea.split("");t.splice(this.blurIndex,0,e),this.childCommentsTextarea=t.join(""),this.childCommentsPopover=!1},blurFun:function(e){this.blurIndex=e.target.selectionEnd},imgZoom:function(e,t){this.$bus.emit("preview-image-bus",{index:t,data:e.map(function(e,t,i){return{url:e.filePath,name:e.name}})})}}},p=(i("wlfA"),i("KHd+")),f=Object(p.a)(m,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list",attrs:{id:"journal-cell"+e.logIndex}},[a("div",{staticClass:"list-content"},[a("div",{staticClass:"header"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:e.data.createUser,expression:"data.createUser"},{name:"lazy",rawName:"v-lazy:background-image",value:e.$options.filters.filterUserLazyImg(e.data.createUser.img),expression:"$options.filters.filterUserLazyImg(data.createUser.img)",arg:"background-image"}],key:e.data.createUser.img,staticClass:"div-photo head-img header-circle"}),e._v(" "),a("div",{staticClass:"row"},[a("p",{staticClass:"row-title"},[a("span",{staticClass:"name"},[e._v(e._s(e.data.createUser.realname))]),e._v(" "),e.showWorkbench?a("span",{staticClass:"item-content"},[e._v(e._s(e.data.actionContent))]):a("span",{staticClass:"read",style:{color:0==e.data.isRead?"#3E84E9":"#ccc"}},[e._v(e._s(0==e.data.isRead?"Chưa đọc":"Đã đọc"))])]),e._v(" "),a("span",{staticClass:"time"},[e._v(e._s(e._f("moment")(e.data.createTime,"YYYY-MM-DD HH:mm")))]),e._v(" "),a("el-tooltip",{attrs:{disabled:!(e.data.sendUserList.length>0||e.data.sendDeptList.length>0),placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("div",{staticClass:"members-dep-title"},[e.data.sendUserList?a("span",e._l(e.data.sendUserList,function(t,i){return a("span",{key:i},[e._v("\n                  "+e._s(0==e.data.sendDeptList.length&&i==e.data.sendUserList.length-1?t.realname:t.realname+"，")+"\n                ")])})):e._e(),e._v(" "),e._l(e.data.sendDeptList,function(t,i){return a("span",{directives:[{name:"show",rawName:"v-show",value:0!=e.data.sendDeptList.legnth,expression:"data.sendDeptList.legnth != 0"}],key:i},[e._v("\n                "+e._s(i==e.data.sendDeptList.length-1?t.name:t.name+"，")+"\n              ")])})],2)]),e._v(" "),a("p",{staticClass:"row-title",staticStyle:{display:"inline-block"}},[e.data.sendDeptList?a("span",[e._v(e._s(e.data.sendDeptList.length)+" Phòng ban, ")]):e._e(),e._v(" "),e.data.sendUserList?a("span",[e._v(e._s(e.data.sendUserList.length)+" Nhân viên")]):e._e()])])],1),e._v(" "),!e.showWorkbench&&e.data.permission&&(e.data.permission.isUpdate||e.data.permission.isDelete)?a("div",{staticClass:"rt-setting"},[a("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},[a("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD",cursor:"pointer"}}),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e.data.permission.isUpdate?a("el-dropdown-item",{attrs:{command:"edit"}},[e._v("Chỉnh sửa")]):e._e(),e._v(" "),e.data.permission.isDelete?a("el-dropdown-item",{attrs:{command:"delete"}},[e._v("Xóa")]):e._e()],1)],1)],1):e._e()]),e._v(" "),a("div",{staticClass:"text"},[e.data.content?a("p",{staticClass:"row"},[a("span",{staticClass:"title"},[e._v(e._s(1==e.data.categoryId?"Nội dung công việc hôm nay":2==e.data.categoryId?"Làm việc trong tuần này":"Làm việc trong tháng này")+"：")]),e._v(e._s(e.data.content))]):e._e(),e._v(" "),e.data.tomorrow?a("p",{staticClass:"row"},[a("span",{staticClass:"title"},[e._v(e._s(1==e.data.categoryId?"Nội dung công việc ngày mai":2==e.data.categoryId?"Nội dung công việc tuần sau":"Nội dung công việc tháng sau")+"：")]),e._v(e._s(e.data.tomorrow))]):e._e(),e._v(" "),e.data.question?a("p",{staticClass:"row"},[a("span",{staticClass:"title"},[e._v("Những vấn đề bắt gặp:")]),e._v(e._s(e.data.question))]):e._e()]),e._v(" "),a("div",{staticClass:"accessory"},[0!=e.data.img.length?a("div",{staticClass:"upload-img-box"},e._l(e.data.img,function(t,i){return a("div",{key:i,staticClass:"img-list",on:{click:function(t){e.imgZoom(e.data.img,i)}}},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.filePath,expression:"imgItem.filePath"}],key:t.filePath})])})):e._e(),e._v(" "),0!=e.data.file.length?a("div",{staticClass:"accessory-box"},e._l(e.data.file,function(e,t){return a("file-cell",{key:t,attrs:{data:e,"cell-index":t}})})):e._e()]),e._v(" "),e.allDataShow?a("related-business",{attrs:{"margin-left":"0",alterable:!1,"all-data":e.allData},on:{checkRelatedDetail:e.checkRelatedDetail}}):e._e(),e._v(" "),e.replyList&&0!=e.replyList.length?a("div",{staticClass:"discuss"},[a("div",{staticClass:"border"}),e._v(" "),e._l(e.replyList,function(t,n){return a("div",{key:n,staticClass:"discuss-list"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:t.user,expression:"discussItem.user"},{name:"lazy",rawName:"v-lazy:background-image",value:e.$options.filters.filterUserLazyImg(t.user.img),expression:"$options.filters.filterUserLazyImg(discussItem.user.img)",arg:"background-image"}],key:t.user.img,staticClass:"div-photo head-img header-circle"}),e._v(" "),a("span",{staticClass:"name"},[e._v(e._s(t.user.realname))]),e._v(" "),a("span",{staticClass:"time"},[e._v(e._s(t.createTime))]),e._v(" "),a("div",{staticClass:"rt"},[a("span",{on:{click:function(i){e.discussDelete(t,e.replyList,n)}}},[e._v("Xóa")]),e._v(" "),a("span",{on:{click:function(i){e.discussBtn(t,-1)}}},[e._v("Trả lời")])]),e._v(" "),a("p",{staticClass:"reply-title"},[a("span",{domProps:{innerHTML:e._s(e.emoji(t.content))}})]),e._v(" "),t.childCommentList&&t.childCommentList.length>0?a("div",{staticClass:"children-reply"},e._l(t.childCommentList,function(i,n){return a("div",{key:n,staticClass:"discuss-list"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:i.user,expression:"childDiscussItem.user"},{name:"lazy",rawName:"v-lazy:background-image",value:e.$options.filters.filterUserLazyImg(i.user.img),expression:"$options.filters.filterUserLazyImg(childDiscussItem.user.img)",arg:"background-image"}],key:i.user.img,staticClass:"div-photo head-img header-circle"}),e._v(" "),a("span",{staticClass:"name"},[e._v(e._s(i.user.realname))]),e._v(" "),a("span",{staticClass:"time"},[e._v(e._s(i.createTime))]),e._v(" "),a("div",{staticClass:"rt"},[a("span",{on:{click:function(a){e.discussDelete(i,t.childCommentList,n)}}},[e._v("Xóa")]),e._v(" "),a("span",{on:{click:function(i){e.discussBtn(t,n)}}},[e._v("Trả lời")])]),e._v(" "),a("p",{staticClass:"reply-title"},[[a("span",[e._v("Trả lời")]),e._v(" "),i.replyUser?a("span",{staticClass:"reply"},[e._v("@"+e._s(i.replyUser.realname)+"：")]):e._e()],e._v(" "),a("span",{domProps:{innerHTML:e._s(e.emoji(i.content))}})],2)])})):e._e(),e._v(" "),t.show?a("div",{staticClass:"comment-box"},[a("el-input",{attrs:{rows:2,type:"textarea",placeholder:"Nhập nội dung"},on:{blur:e.blurFun},model:{value:e.childCommentsTextarea,callback:function(t){e.childCommentsTextarea=t},expression:"childCommentsTextarea"}}),e._v(" "),a("div",{staticClass:"btn-group"},[a("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"},model:{value:e.childCommentsPopover,callback:function(t){e.childCommentsPopover=t},expression:"childCommentsPopover"}},[a("emoji",{on:{select:e.childSelectEmoji}}),e._v(" "),a("img",{staticClass:"smiling-img",attrs:{slot:"reference",src:i("woiz")},slot:"reference"})],1),e._v(" "),a("div",{staticClass:"btn-box"},[a("el-button",{attrs:{loading:e.contentLoading,type:"primary"},on:{click:function(t){e.childCommentSubmit()}}},[e._v("Lưu")]),e._v(" "),a("el-button",{on:{click:function(e){t.show=!1}}},[e._v("Hủy")])],1)],1)],1):e._e(),e._v(" "),a("div",{staticClass:"border"})])})],2):e._e()],1),e._v(" "),a("div",{staticClass:"footer"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-chat-line-round"},on:{click:function(t){e.commentBtn(e.data)}}},[e._v("Trả lời")])],1),e._v(" "),e.data.showComment?a("div",{staticClass:"comment-box"},[a("el-input",{attrs:{rows:3,type:"textarea",placeholder:"Nhập nội dung"},on:{blur:e.blurFun},model:{value:e.commentsTextarea,callback:function(t){e.commentsTextarea=t},expression:"commentsTextarea"}}),e._v(" "),a("div",{staticClass:"btn-group"},[a("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"},model:{value:e.commentsPopover,callback:function(t){e.commentsPopover=t},expression:"commentsPopover"}},[a("emoji",{on:{select:e.selectEmoji}}),e._v(" "),a("img",{staticClass:"smiling-img",attrs:{slot:"reference",src:i("woiz")},slot:"reference"})],1),e._v(" "),a("div",{staticClass:"btn-box"},[a("el-button",{attrs:{loading:e.contentLoading,type:"primary"},on:{click:function(t){e.commentSubmit()}}},[e._v("Lưu")]),e._v(" "),a("el-button",{on:{click:function(t){e.data.showComment=!1}}},[e._v("Hủy bỏ")])],1)],1)],1):e._e()])},[],!1,null,"1fb107c6",null);f.options.__file="journalCell.vue";t.a=f.exports},JXju:function(e,t,i){"use strict";var a=i("7Qib"),n=i("mqlf"),s=i("ppJE"),l=i("PS1M"),c=i("n1dw"),o=i("xfX+"),r=i("8gwX"),d=i("K6D0"),h={name:"CRMAllDetail",components:{ClueDetail:n.a,CustomerDetail:s.a,ContactsDetail:l.a,BusinessDetail:c.a,ContractDetail:o.a,ProductDetail:r.a,MoneyDetail:d.a},props:{id:[String,Number],crmType:{type:String,default:""},visible:{type:Boolean,default:!1},listenerIDs:{type:Array,default:function(){return["crm-main-container"]}},noListenerIDs:{type:Array,default:function(){return[]}},noListenerClass:{type:Array,default:function(){return["el-table__body"]}}},data:function(){return{tabName:""}},computed:{},watch:{crmType:function(e){"leads"==this.crmType?this.tabName="clue-detail":"customer"==this.crmType?this.tabName="customer-detail":"contacts"==this.crmType?this.tabName="contacts-detail":"business"==this.crmType?this.tabName="business-detail":"contract"==this.crmType?this.tabName="contract-detail":"product"==this.crmType?this.tabName="product-detail":"receivables"==this.crmType&&(this.tabName="money-detail")}},mounted:function(){this.visible&&(document.body.appendChild(this.$el),this.$el.style.zIndex=Object(a.h)())},destroyed:function(){this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},methods:{hiddenView:function(){this.$emit("update:visible",!1)},detailHandle:function(e){this.$emit("handle",e)}}},u=(i("AnnZ"),i("KHd+")),m=Object(u.a)(h,function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.id&&e.visible?i(e.tabName,{tag:"component",staticClass:"d-view",attrs:{"crm-type":e.crmType,id:e.id,"listener-ids":e.listenerIDs,"no-listener-ids":e.noListenerIDs},on:{handle:e.detailHandle,"hide-view":e.hiddenView}}):e._e()},[],!1,null,"30fef6ca",null);m.options.__file="CRMAllDetail.vue";t.a=m.exports},KJoY:function(e,t,i){},KKWy:function(e,t,i){},LEQn:function(e,t,i){},LnKz:function(e,t,i){},M9eM:function(e,t,i){},N0PQ:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjZGRjBCRTYxRTBBNzExRTg5QkREOEQxRjlDMkUxOUExIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjZGRjBCRTYyRTBBNzExRTg5QkREOEQxRjlDMkUxOUExIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NkZGMEJFNUZFMEE3MTFFODlCREQ4RDFGOUMyRTE5QTEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NkZGMEJFNjBFMEE3MTFFODlCREQ4RDFGOUMyRTE5QTEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz704RrgAAABwUlEQVR42uSXz0sCQRTH36h1sGNlaHjpVJoHC0KCOnVJOwSdqmM/6NZ/EF071rluQaduGQWd9BZEqWBhQQQmHYIQikDU6bs6G8Oy4q7sskYPPuzOzFu+++a9mZ1lnHNywlzkkDkm7JEb7/m8rWIDoVBHEc+DEuAaSmLMtqk+An6dfr8Ys0T4BHxJUbUzJq6q/yc47kR4CXg1fevgTcf3Faxp+vrAsuHikqxH054A5y2mWvYxnEaPwZTc/Kl1zJPJBt27gbR667YlnUjYMNWMORMxi8edETZhH+AZ9IIx4LZb+A5sieskGALfYMWW4hIFdQtmwJyIVt5gruEziucfrF5OVbAKZsGpzq42BVIQH+6suFovlRRQojnTzWethl73IO52wYaVEd+DcTDSaFUqRPV6c6RYJJ5ON8WJFqwuLkWl/7cWMhmE4SLm8xHP5YhFIkrEJPsYibhqQDgKCur3moXDROUy8Wy2KRoMqn5PZoQLBoSnxTf7otHyeonFYsSiUVlUsUMzwttAOfnV2my3e2ATvKjiFAjIPpdg30yOr0DYRL6VpbMDFoEPPIpz2EGrl2fyn0S3Hm8tNfbv/p1+BBgA+Vdv2Iz9D6cAAAAASUVORK5CYII="},N99G:function(e,t,i){"use strict";var a=i("qd/y");i.n(a).a},NS7n:function(e,t,i){"use strict";var a={name:"FilterContent",props:{obj:{type:Object,required:!0,default:function(){return{}}}},data:function(){return{optionsNames:{is:"bằng",isNot:"không bằng",contains:"chứa",notContains:"không chứa",startWith:"bắt đầu từ ngày",endWith:"kết thúc vào ngày",isNull:"rỗng",isNotNull:"không rỗng",eq:"bằng",neq:"không bằng",gt:"lớn hơn",egt:"lớn hơn hoặc bằng",lt:"nhỏ hơn",elt:"nhỏ hơn hoặc bằng"},showObj:{}}},computed:{},watch:{obj:function(e){this.showObj=e}},mounted:function(){this.showObj=this.obj},methods:{handleDelete:function(e,t){this.$delete(this.showObj.obj,e.fieldName),this.showObj.form.splice(t,1),this.$emit("delete",{item:e,index:t,obj:this.showObj})},getTypesName:function(e){return e.typeId&&e.typeOption.find(function(t){return t.typeId===e.typeId}).name||""},getCheckName:function(e){var t="";return e.setting.forEach(function(i){i.value!==e.value||(t=i.name)}),t},getStatusName:function(e){if(e.statusId){var t=e.statusOption.find(function(t){return t.statusId===e.statusId});return t.name?"-"+t.name:""}return""}}},n=(i("BLwn"),i("KHd+")),s=Object(n.a)(a,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"wrapper"},[i("ul",{staticClass:"list"},e._l(e.showObj.form,function(t,a){return i("li",{key:a,staticClass:"list-item"},["date"==t.formType?i("span",[e._v(e._s(t.name+" “"+t.value[0]+"-"+t.value[1]+"”"))]):"datetime"===t.formType?i("span",[e._v(e._s(t.name+" “"+t.value[0]+"-"+t.value[1]+"”"))]):"business_type"===t.formType?i("span",[e._v(e._s(t.name+" “"+e.getTypesName(t)+e.getStatusName(t)+"”"))]):"map_address"===t.formType?i("span",[e._v(e._s(t.name+" "+t.address.state+" "+t.address.city+" "+t.address.area))]):"checkStatus"===t.formType?i("span",[e._v(e._s(t.name+" “"+e.optionsNames[t.condition]+"” "+e.getCheckName(t)))]):"user"===t.formType?i("span",[e._v(e._s(t.name+" "+e.optionsNames[t.condition]+"“"+t.value[0].realname+"”"))]):"category"===t.formType&&t.value.length>0?i("span",[e._v(e._s(t.name+" “"+t.valueContent+"”"))]):i("span",[e._v(e._s(t.name+" "+e.optionsNames[t.condition]+"“"+t.value+"”"))]),e._v(" "),i("i",{staticClass:"el-icon-close icon",on:{click:function(i){e.handleDelete(t,a)}}})])}))])},[],!1,null,"79ead4d3",null);s.options.__file="filterContent.vue";t.a=s.exports},O1Uw:function(e,t,i){"use strict";var a=i("7Qib"),n=i("KTTK"),s={name:"FileCell",props:{cellIndex:Number,data:Object,showFoot:{type:Boolean,default:!0},cursorPointer:{type:Boolean,default:!1},showDelete:{type:Boolean,default:!1},module_id:[String,Number]},data:function(){return{}},computed:{},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{downloadClick:function(){Object(a.b)({path:this.data.filePath,name:this.data.name})},deleteClick:function(){var e=this;this.$confirm("Xác nhận xóa?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){Object(n.c)({id:e.data.fileId}).then(function(t){e.$message.success("Thành công"),e.$emit("delete",e.cellIndex,e.data)}).catch(function(){})}).catch(function(){e.$message({type:"info",message:"Không thành công"})})}}},l=(i("aNXn"),i("KHd+")),c=Object(l.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("flexbox",{staticClass:"cell"},[a("img",{staticClass:"cell-head",attrs:{src:i("6KEE"),alt:""}}),e._v(" "),a("div",{staticClass:"cell-body",class:{"cursor-pointer":e.cursorPointer}},[a("span",[e._v(e._s(e.data.name.length>20?e.data.name.substring(0,20)+"...":e.data.name))]),e._v(" "),a("span",{staticClass:"size"},[e._v("("+e._s(e.data.size)+")")])]),e._v(" "),a("div",{staticClass:"cell-foot"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:e.downloadClick}},[e._v("Tải về")]),e._v(" "),e.showDelete?a("i",{staticClass:"el-icon-delete",on:{click:e.deleteClick}}):e._e()],1)])},[],!1,null,"4aac2a97",null);c.options.__file="index.vue";t.a=c.exports},OPCT:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjVENDNERTkxRTA5QjExRThBQkRDQjRERjVBMjY3MzE0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjVENDNERTkyRTA5QjExRThBQkRDQjRERjVBMjY3MzE0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NUQ0M0RFOEZFMDlCMTFFOEFCRENCNERGNUEyNjczMTQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NUQ0M0RFOTBFMDlCMTFFOEFCRENCNERGNUEyNjczMTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7c1/V2AAABIElEQVR42mL8//8/AwicPXuWgVxgbGwMZzMRUBsGxBeB+AXITigfL2DBIxcCxHlA7AnEz4CYB4gnQ+VW4dKEz4UNQBwNNQwEvgBxBhAn4XMhPgMFgPghmthPIP5NroF/cYgzkmsgMw7x/+Qa+AGIZbBEIgu5BjYC8VIgloLyQbE8E4gXkJtsVkMt3Ak1DOTiDiBeSa6BDFDNK0nJNdi8rArEa4H4IzQC0PFHqLwqMQaqA/ERID4IxIrQJIKOFaDyR6Dq8Xq5DYon4fHVe6g8J1RtMD4XugDxYiKDazYQu5GSbMgC6AbuAeJYIvWmAPEuQmFYDQ3w/1Cvv8dikCDU0mIgtifkwhtAbAdV+BBHsnkIlbeDqieYsG+ixxwpACDAAIZEQR7SM/O0AAAAAElFTkSuQmCC"},Op00:function(e,t,i){"use strict";var a=i("+9th"),n={name:"TaskCell",components:{},mixins:[],props:{data:Object,dataIndex:Number},data:function(){return{}},computed:{},watch:{},mounted:function(){},methods:{taskOverClick:function(e){var t=this;Object(a.g)({taskId:e.taskId,status:e.checked?5:1}).then(function(e){t.$store.dispatch("GetOAMessageNum","task")}).catch(function(){e.checked=!1})},rowFun:function(e){this.$emit("on-handle",{type:"view",data:{item:this.data,index:this.dataIndex}})},onmouseoverFun:function(e){this.$refs.itemSpan.offsetWidth>this.$refs.listLeft.offsetWidth-21?this.$set(e,"show",!0):this.$set(e,"show",!1)}}},s=(i("n5gA"),i("KHd+")),l=Object(s.a)(n,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"taskRow",staticClass:"list",style:{"border-left-color":1==e.data.priority?"#8bb5f0":2==e.data.priority?"#FF9668":3==e.data.priority?"#ED6363":"transparent"},on:{click:function(t){e.rowFun(e.data)}}},[i("div",{ref:"listLeft",staticClass:"list-left"},[i("div",{class:e.data.checked?"title title-active":"title",on:{click:function(e){e.stopPropagation()}}},[i("el-checkbox",{on:{change:function(t){e.taskOverClick(e.data)}},model:{value:e.data.checked,callback:function(t){e.$set(e.data,"checked",t)},expression:"data.checked"}})],1),e._v(" "),i("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"task-tooltip tooltip-change-border"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("span",[e._v(e._s(e.data.name))])]),e._v(" "),i("span",{ref:"itemSpan",class:e.data.checked?"item-name-active":"item-name"},[e._v("\n        "+e._s(e.data.name)+"\n      ")])])],1),e._v(" "),i("div",{staticClass:"list-right"},[e.data.labelList&&e.data.labelList.length>0?i("div",{staticClass:"tag-box"},[e.data.labelList.length<=2?e._l(e.data.labelList,function(t,a){return i("div",{key:a,staticClass:"item-label"},[i("span",{staticClass:"k-name",style:{background:t.color}},[e._v(e._s(t.labelName))])])}):[i("span",{staticClass:"k-name",style:{background:e.data.labelList[0].color}},[e._v(e._s(e.data.labelList[0].labelName))]),e._v(" "),i("span",{staticClass:"k-name",style:{background:e.data.labelList[1].color}},[e._v(e._s(e.data.labelList[1].labelName))]),e._v(" "),i("el-tooltip",{attrs:{placement:"top",effect:"light","popper-class":"tooltip-change-border task-tooltip"}},[i("div",{staticClass:"tooltip-content",staticStyle:{margin:"10px 10px 10px 0"},attrs:{slot:"content"},slot:"content"},e._l(e.data.labelList,function(t,a){return i("div",{key:a,staticClass:"item-label",staticStyle:{display:"inline-block","margin-right":"10px"}},[a>=2?i("span",{staticClass:"k-name",staticStyle:{"border-radius":"3px",color:"#FFF",padding:"3px 10px"},style:{background:t.color||"#ccc"}},[e._v(e._s(t.labelName))]):e._e()])})),e._v(" "),i("span",{staticClass:"color-label-more"},[i("i",[e._v("...")])])])]],2):e._e(),e._v(" "),i("div",{staticClass:"img-group"},[e.data.relationCount?i("div",{staticClass:"img-box"},[i("i",{staticClass:"wukong wukong-relevance"}),e._v(" "),i("span",[e._v(e._s(e.data.relationCount))])]):e._e(),e._v(" "),e.data.childAllCount>0?i("div",{staticClass:"img-box"},[i("i",{staticClass:"wukong wukong-sub-task"}),e._v(" "),i("span",[e._v(e._s(e.data.childWCCount)+"/"+e._s(e.data.childAllCount))])]):e._e(),e._v(" "),e.data.fileCount?i("div",{staticClass:"img-box"},[i("i",{staticClass:"wukong wukong-file"}),e._v(" "),i("span",[e._v(e._s(e.data.fileCount))])]):e._e(),e._v(" "),e.data.commentCount?i("div",{staticClass:"img-box"},[i("i",{staticClass:"wukong wukong-comment-task"}),e._v(" "),i("span",[e._v(e._s(e.data.commentCount))])]):e._e(),e._v(" "),e.data.stopTime?i("div",{staticClass:"img-box"},[i("i",{staticClass:"wukong wukong-time-task",style:{color:1!=e.data.isEnd||e.data.checked?"#999":"red"}}),e._v(" "),i("span",{style:{color:1!=e.data.isEnd||e.data.checked?"#999":"red"}},[e._v(e._s(e._f("moment")(e.data.stopTime,"MM-DD"))+" Lọc")])]):e._e()]),e._v(" "),i("div",{staticClass:"item-own-box"},[e.data.mainUser&&e.data.mainUser.id?i("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("span",[e._v(e._s(e.data.mainUser.realname))])]),e._v(" "),i("div",{directives:[{name:"photo",rawName:"v-photo",value:e.data.mainUser,expression:"data.mainUser"},{name:"lazy",rawName:"v-lazy:background-image",value:e.$options.filters.filterUserLazyImg(e.data.mainUser.img),expression:"$options.filters.filterUserLazyImg(data.mainUser.img)",arg:"background-image"}],staticClass:"div-photo"})]):e._e()],1)])])},[],!1,null,"fef6349e",null);l.options.__file="taskCell.vue";t.a=l.exports},PZm3:function(e,t,i){"use strict";var a=i("qThd");i.n(a).a},QJC7:function(e,t,i){"use strict";var a=i("3yi6"),n=i("5tgW"),s=i("vG5h"),l=i("qbf4"),c=i("UcQx"),o=i("6zBA"),r={name:"RecordLog",components:{FollowRecordCell:a.a},props:{id:[String,Number],crmType:{type:String,default:""}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[]}},computed:{},watch:{id:function(e){this.refreshList()}},mounted:function(){var e=this;this.$bus.on("follow-log-refresh",function(t){"record-log"==t.type&&e.refreshList()});var t=document.getElementById("follow-log-content");t.onscroll=function(){var i=t.scrollTop+t.clientHeight-t.scrollHeight;Math.abs(i)<10&&1==e.loadMoreLoading&&(e.isPost?e.loadMoreLoading=!1:(e.isPost=!0,e.page++,e.getList()))},this.getList()},activated:function(){},deactivated:function(){},beforeDestroy:function(){this.$bus.off("follow-log-refresh")},methods:{getList:function(){var e=this;this.loading=!0;var t={customer:s.v,leads:n.i,contacts:l.j,business:c.j,contract:o.j}[this.crmType],i={page:this.page,limit:10};i[this.crmType+"Id"]=this.id,t(i).then(function(t){e.list=e.list.concat(t.data),t.data.length<10?e.loadMoreLoading=!1:e.loadMoreLoading=!0,e.loading=!1,e.isPost=!1}).catch(function(){e.isPost=!1,e.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},cellHandle:function(e){"delete"==e.type&&this.list.splice(e.data.index,1)}}},d=(i("gs/v"),i("KHd+")),h=Object(d.a)(r,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:0===e.list.length,expression:"list.length === 0"}]},[i("div",{staticClass:"log-items"},[e._l(e.list,function(t,a){return i("follow-record-cell",{key:a,attrs:{item:t,index:a,"crm-type":e.crmType},on:{"on-handle":e.cellHandle}})}),e._v(" "),i("div",{staticClass:"load"},[i("el-button",{attrs:{loading:e.loadMoreLoading,type:"text"}},[e._v(e._s(e.loadMoreLoading?"Tải thêm":"Không có dữ liệu"))])],1)],2)])])},[],!1,null,"cfac43fc",null);h.options.__file="RecordLog.vue";t.a=h.exports},QhQt:function(e,t,i){},QhmF:function(e,t,i){"use strict";i.r(t);var a=i("KzkL"),n=i("ExMk"),s={name:"ExamineHandle",components:{XhUserCell:i("8GhS").p},props:{show:{type:Boolean,default:!1},status:{type:[String,Number],default:1},id:[String,Number],recordId:[String,Number],detail:{type:Object,default:function(){return{}}},examineType:{type:String,default:""}},data:function(){return{loading:!1,showDialog:!1,handleType:1,selectUsers:[],content:""}},computed:{title:function(){return 1==this.status?"Đồng ý":2==this.status?"Phê duyệt bị từ chối":4==this.status?"Rút lại phê duyệt":""},placeholder:function(){return 1==this.status?"Vui lòng nhập nhận xét phê duyệt (tùy chọn)":2==this.status?"Vui lòng nhập nhận xét phê duyệt (bắt buộc)":4==this.status?"Vui lòng nhập lý do rút phê duyệt (bắt buộc)":""}},watch:{show:{handler:function(e){this.showDialog=e},deep:!0,immediate:!0}},mounted:function(){},methods:{submitInfo:function(){2!=this.status&&4!=this.status||this.content?2==this.status||1==this.status?this.handlePassAndReject():4==this.status&&this.handleRevoke():this.$message.error(this.placeholder)},handleRevoke:function(){var e=this;this.loading=!0,this.getRequest()({id:this.id,recordId:this.recordId,status:this.status,remarks:this.content}).then(function(t){e.loading=!1,e.$message.success("Thành công"),e.$emit("save"),e.$bus.emit("examine-handle-bus"),e.$store.dispatch("GetMessageNum"),e.hiddenView()}).catch(function(){e.loading=!1})},getRequest:function(){return{crm_contract:a.c,crm_receivables:a.c,oa_examine:n.e}[this.examineType]},handlePassAndReject:function(){var e=this;this.loading=!0;var t={id:this.id,recordId:this.recordId,status:this.status,remarks:this.content};1==this.status&&2==this.detail.examineType&&1!=this.handleType&&(t.nextUserId=this.selectUsers[0].userId),this.getRequest()(t).then(function(t){e.loading=!1,e.$message.success("Thành công"),e.$emit("save",{type:e.status}),e.hiddenView(),e.$bus.emit("examine-handle-bus"),e.$store.dispatch("GetMessageNum")}).catch(function(){e.loading=!1})},handleClick:function(e){"cancel"==e?this.hiddenView():"confirm"==e&&this.submitInfo()},selectUserFocus:function(){this.handleType=2},selectExamineUser:function(e){this.selectUsers=e.value},hiddenView:function(){this.$emit("close")}}},l=(i("F5VI"),i("KHd+")),c=Object(l.a)(s,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{title:e.title,"append-to-body":!0,visible:e.showDialog,width:"400px"},on:{"update:visible":function(t){e.showDialog=t},close:e.hiddenView}},[1==e.status&&2==e.detail.examineType?i("div",{staticClass:"handle-type"},[i("flexbox",{staticClass:"handle-item"},[i("el-radio",{attrs:{label:1},model:{value:e.handleType,callback:function(t){e.handleType=t},expression:"handleType"}},[i("span")]),e._v(" "),i("div",{staticStyle:{"font-size":"12px"},nativeOn:{click:function(t){e.handleType=1}}},[e._v("Kết thúc đánh giá")])],1),e._v(" "),i("flexbox",{staticClass:"handle-item",attrs:{id:"selectUser"}},[i("el-radio",{attrs:{label:2},model:{value:e.handleType,callback:function(t){e.handleType=t},expression:"handleType"}},[i("span")]),e._v(" "),i("xh-user-cell",{staticClass:"select-user",attrs:{placeholder:"Chọn người phê duyệt tiếp theo"},on:{focus:e.selectUserFocus,"value-change":e.selectExamineUser}})],1)],1):e._e(),e._v(" "),1==e.status&&2==e.detail.examineType?i("div",{staticClass:"title"},[e._v("Ý kiến")]):e._e(),e._v(" "),i("el-input",{attrs:{rows:5,maxlength:200,placeholder:e.placeholder,type:"textarea",resize:"none","show-word-limit":""},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.handleClick("cancel")}}},[e._v("Hủy")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleClick("confirm")}}},[e._v("Xác nhận")])],1)],1)},[],!1,null,"4e4c68fc",null);c.options.__file="ExamineHandle.vue";t.default=c.exports},Qldq:function(e,t,i){"use strict";i.d(t,"d",function(){return n}),i.d(t,"a",function(){return s}),i.d(t,"c",function(){return l}),i.d(t,"b",function(){return c}),i.d(t,"e",function(){return o});var a=i("t3Un");function n(e){return Object(a.a)({url:"OaLog/queryList",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:e})}function s(e){return Object(a.a)({url:"OaLog/addOrUpdate",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:e})}function l(e){return Object(a.a)({url:"OaLog/addOrUpdate",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:e})}function c(e){return Object(a.a)({url:"OaLog/deleteById",method:"post",data:e})}function o(e){return Object(a.a)({url:"OaLog/readLog",method:"post",data:e})}},Qq94:function(e,t,i){},R8hg:function(e,t,i){"use strict";var a=i("etft");i.n(a).a},S3Kq:function(e,t,i){"use strict";var a=i("GQeE"),n=i.n(a),s=i("sCIN"),l={name:"Emoji",data:function(){return{emojiData:s.a,pannels:["Công thức","Tự nhiên","Mục","Địa điểm","Ký hiệu"],activeIndex:0}},computed:{emojis:function(){var e=this;return this.pannels.map(function(t){return n()(e.emojiData[t])})}},created:function(){},methods:{changeActive:function(e){this.activeIndex=e},getPureName:function(e){return e.replace(/:/g,"")},selectItem:function(e){this.$emit("select",e)}}},c=(i("hIMY"),i("KHd+")),o=Object(c.a)(l,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"emoji"},[i("ul",{staticClass:"emoji-controller"},e._l(e.pannels,function(t,a){return i("li",{key:a,class:{active:a===e.activeIndex},on:{click:function(t){e.changeActive(a)}}},[e._v("\n      "+e._s(t)+"\n    ")])})),e._v(" "),i("ul",{staticClass:"emoji-container"},e._l(e.emojis,function(t,a){return a===e.activeIndex?i("li",{key:a,staticStyle:{padding:"0"}},[e._v("\n      "+e._s(t)+"--"+e._s(a)+"\n      "),e._l(t,function(t,a){return i("a",{key:a,attrs:{href:"javascript:;"},on:{click:function(i){e.selectItem(t)}}},[i("span",{staticClass:"emoji-item",class:"sprite-"+e.getPureName(t),attrs:{title:t}})])})],2):e._e()}))])},[],!1,null,"41e5b7aa",null);o.options.__file="emoji.vue";t.a=o.exports},SE13:function(e,t,i){"use strict";var a=i("mX3o"),n=i("UcQx"),s=i("6zBA"),l=i("7Qib"),c={name:"RelativeProduct",components:{CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-660d"),i.e("chunk-7962ee")]).then(i.bind(null,"uMjE"))}},mixins:[a.a],props:{id:[String,Number],detail:{type:Object,default:function(){return{}}},crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1}},data:function(){return{nopermission:!1,list:[],fieldList:[],tableHeight:"400px",showFullDetail:!1,productId:"",totalInfo:{money:"0.00",discountRate:"0.00"}}},computed:{},watch:{id:function(e){this.list=[],this.getDetail()}},mounted:function(){this.getDetail()},activated:function(){},deactivated:function(){},methods:{getFieldList:function(){this.fieldList.push({prop:"productName",width:"200",label:"Tên sản phẩm"}),this.fieldList.push({prop:"categoryName",width:"200",label:"Doanh mục sản phẩm"}),this.fieldList.push({prop:"unit",width:"200",label:"Đơn vị"}),this.fieldList.push({prop:"price",width:"200",label:"Giá bán"}),this.fieldList.push({prop:"salesPrice",width:"200",label:"Giá khuyến mãi"}),this.fieldList.push({prop:"num",width:"200",label:"Số lượng"}),this.fieldList.push({prop:"discount",width:"200",label:"Giảm giá（%）"}),this.fieldList.push({prop:"subtotal",width:"200",label:"Tổng cộng"})},getDetail:function(){var e=this;this.loading=!0,this.getRequest()(this.getParams()).then(function(t){0==e.fieldList.length&&e.getFieldList(),e.nopermission=!1,e.loading=!1,e.list=t.data.list,e.totalInfo.money=Object(l.j)(t.data.money),e.totalInfo.discountRate=t.data.discountRate}).catch(function(t){102==t.code&&(e.nopermission=!0),e.loading=!1})},getRequest:function(){return"business"==this.crmType?n.f:"contract"==this.crmType?s.f:void 0},getParams:function(){return"business"==this.crmType?{businessId:this.id,pageType:0}:"contract"==this.crmType?{contractId:this.id,pageType:0}:void 0},handleRowClick:function(e,t,i){this.productId=e.productId,this.showFullDetail=!0},headerRowStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}},cellStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}},fieldFormatter:function(e,t){return["price","subtotal","salesPrice"].includes(t.property)?Object(l.j)(e[t.property]):e[t.property]||"--"}}},o=(i("VwCy"),i("KHd+")),r=Object(o.a)(c,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"empty",rawName:"v-empty",value:e.nopermission,expression:"nopermission"}],staticClass:"rc-cont",attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"Không có quyền"}},[i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}}),e._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:e.list,height:e.tableHeight,"header-cell-style":e.headerRowStyle,"cell-style":e.cellStyle,stripe:""},on:{"row-click":e.handleRowClick}},e._l(e.fieldList,function(t,a){return i("el-table-column",{key:a,attrs:{prop:t.prop,label:t.label,formatter:e.fieldFormatter,"show-overflow-tooltip":""}})})),e._v(" "),i("flexbox",{staticClass:"handle-footer"},[i("div",{staticClass:"discount-title"},[e._v("Giảm giá toàn bộ đơn hàng（%）："),i("span",{staticClass:"discount-title-value"},[e._v(e._s(e.totalInfo.discountRate))])]),e._v(" "),i("div",{staticClass:"total-info"},[e._v("Sản phẩm được chọn："),i("span",{staticClass:"info-yellow"},[e._v(e._s(e.list.length))]),e._v(" sản phẩm  Tổng cộng："),i("span",{staticClass:"info-yellow"},[e._v(e._s(e.totalInfo.money))]),e._v(" đồng")])]),e._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:e.showFullDetail,id:e.productId,"crm-type":"product"},on:{"update:visible":function(t){e.showFullDetail=t}}})],1)},[],!1,null,"610114c2",null);r.options.__file="RelativeProduct.vue";t.a=r.exports},UEWd:function(e,t,i){"use strict";var a=i("7Qib"),n=i("KTTK"),s={name:"MixAdd",components:{CrmRelative:i("mkuN").a},props:{showRelativeBusiness:{type:Boolean,default:!1},showRelativeContacts:{type:Boolean,default:!1},id:[String,Number],crmType:{type:String,default:""}},data:function(){return{content:"",inputAutosize:{minRows:1,maxRows:6},barItems:[{img:i("S1Xc"),title:"Hình ảnh",type:"img",data:"image/*"},{img:i("rl4O"),title:"Đính kèm",type:"file",data:"*.*"}],imgFiles:[],files:[],business:[],contacts:[],showRelativeType:"",batchId:""}},computed:{},mounted:function(){this.showRelativeBusiness&&this.barItems.push({img:i("i91G"),title:"Cơ hội kinh doanh",type:"business",show:!1}),this.showRelativeContacts&&this.barItems.push({img:i("OPCT"),title:"Thông tin liên hệ",type:"contacts",show:!1}),this.$on("submit-info",function(){this.$emit("mixadd-info",{content:this.content,files:this.files,images:this.imgFiles,business:this.business,contacts:this.contacts,batchId:this.batchId})})},beforeDestroy:function(){this.$off("submit-info")},methods:{resetInfo:function(){this.content="",this.imgFiles=[],this.files=[],this.business=[],this.contacts=[],this.showRelativeType="",this.batchId=""},checkRelativeInfos:function(e){"business"==this.showRelativeType?this.business=e.data:"contacts"==this.showRelativeType&&(this.contacts=e.data)},barClick:function(e){this.showRelativeType=e.type,"business"==e.type?e.show=!0:"contacts"==e.type&&(e.show=!0)},uploadFile:function(e){var t=this,i=e.target.files;if(i.length){for(var a=0;a<i.length;a++){if(-1==i[a].type.indexOf("image")&&"img"==this.showRelativeType)return void this.$message.error("Vui lòng chọn đúng hình ảnh")}var n="image/*"==e.target.accept?"img":"file",s=i[0];this.sendFileRequest(s,n,function(){for(var a=1;a<i.length;a++){var s=i[a];t.sendFileRequest(s,n)}e.target.value=""})}},sendFileRequest:function(e,t,i){var s=this,l={file:e,type:t};this.batchId&&(l.batchId=this.batchId),Object(n.e)(l).then(function(n){""==s.batchId&&(s.batchId=n.batchId),n.size=Object(a.d)(e.size),"img"==t?s.imgFiles.push(n):(n.icon=Object(a.g)(e),s.files.push(n)),i&&i()}).catch(function(){})},deleteAllImg:function(){this.imgFiles=[]},deleteImgOrFile:function(e,t,i){var a=this;Object(n.c)({id:t.fileId}).then(function(t){"image"==e?a.imgFiles.splice(i,1):a.files.splice(i,1),a.$message.success("Thành công")}).catch(function(){})},mouseImgOver:function(e,t){e.showDelete=!0,this.$set(this.imgFiles,t,e)},mouseImgLeave:function(e,t){e.showDelete=!1,this.$set(this.imgFiles,t,e)},inputFocus:function(){var e=this;this.inputAutosize={minRows:3,maxRows:6},this.$nextTick(function(){e.$refs.textarea.resizeTextarea()})}}},l=(i("B7ox"),i("KHd+")),c=Object(l.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mix-container"},[a("div",{staticClass:"i-cont"},[a("el-input",{ref:"textarea",attrs:{autosize:e.inputAutosize,type:"textarea",clearable:"",resize:"none",placeholder:"Vui lòng nhập nội dung"},on:{focus:e.inputFocus},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1),e._v(" "),e.imgFiles.length>0?a("section",{staticClass:"img-cont"},[a("flexbox",{attrs:{wrap:"wrap"}},[e._l(e.imgFiles,function(t,i){return a("div",{key:i,staticClass:"img-item",style:{"background-image":"url("+t.url+")"},on:{mouseover:function(a){e.mouseImgOver(t,i)},mouseleave:function(a){e.mouseImgLeave(t,i)}}},[t.showDelete?a("div",{staticClass:"img-delete",on:{click:function(a){e.deleteImgOrFile("image",t,i)}}},[e._v("×")]):e._e()])}),e._v(" "),a("div",{staticClass:"img-item-add"},[a("input",{staticClass:"img-item-iput",attrs:{type:"file",accept:"image/*",multiple:""},on:{change:e.uploadFile}})])],2),e._v(" "),a("div",{staticClass:"img-bar",on:{click:e.deleteAllImg}},[e._v("Xóa tất cả")])],1):e._e(),e._v(" "),e.files.length>0?a("section",{staticClass:"file-cont"},[a("flexbox",{staticClass:"f-header"},[a("img",{staticClass:"f-logo",attrs:{src:i("rl4O")}}),e._v(" "),a("div",{staticClass:"f-name"},[e._v("Đính kèm")])]),e._v(" "),a("div",{staticClass:"f-body"},e._l(e.files,function(t,i){return a("flexbox",{key:i,staticClass:"f-item"},[a("img",{staticClass:"f-img",attrs:{src:t.icon}}),e._v(" "),a("div",{staticClass:"f-name"},[e._v(e._s(t.name+"("+t.size+")"))]),e._v(" "),a("div",{staticClass:"close-button",on:{click:function(a){e.deleteImgOrFile("file",t,i)}}},[e._v("×")])])})),e._v(" "),a("div",{staticClass:"img-bar",on:{click:function(t){e.files=[]}}},[e._v("Xóa tất cả")])],1):e._e(),e._v(" "),e.business.length>0?a("section",{staticClass:"c-cont"},[a("flexbox",{staticClass:"c-header"},[a("img",{staticClass:"c-logo",attrs:{src:i("i91G")}}),e._v(" "),a("div",{staticClass:"c-name"},[e._v("Gởi")])]),e._v(" "),a("div",{staticClass:"c-body"},[a("flexbox",{attrs:{wrap:"wrap"}},e._l(e.business,function(t,i){return a("flexbox",{key:i,staticClass:"c-item"},[a("div",{staticClass:"c-item-name"},[e._v(e._s(t.businessName))]),e._v(" "),a("div",{staticClass:"c-item-close",on:{click:function(t){e.business.splice(i,1)}}},[e._v("×")])])}))],1)],1):e._e(),e._v(" "),e.contacts.length>0?a("section",{staticClass:"c-cont"},[a("flexbox",{staticClass:"c-header"},[a("img",{staticClass:"c-logo",attrs:{src:i("OPCT")}}),e._v(" "),a("div",{staticClass:"c-name"},[e._v("Người liên hệ")])]),e._v(" "),a("div",{staticClass:"c-body"},[a("flexbox",{attrs:{wrap:"wrap"}},e._l(e.contacts,function(t,i){return a("flexbox",{key:i,staticClass:"c-item"},[a("div",{staticClass:"c-item-name"},[e._v(e._s(t.name))]),e._v(" "),a("div",{staticClass:"c-item-close",on:{click:function(t){e.contacts.splice(i,1)}}},[e._v("×")])])}))],1)],1):e._e(),e._v(" "),a("flexbox",{staticClass:"bar-cont"},[e._l(e.barItems,function(t,i){return["img"==t.type||"file"==t.type?a("flexbox",{key:i,staticClass:"bar-item",nativeOn:{click:function(i){e.barClick(t)}}},[a("input",{staticClass:"bar-input",attrs:{accept:t.data,type:"file",multiple:""},on:{change:e.uploadFile}}),e._v(" "),a("img",{staticClass:"bar-img",attrs:{src:t.img}}),e._v(" "),a("div",{staticClass:"bar-title"},[e._v(e._s(t.title))])]):a("el-popover",{key:i,attrs:{placement:"bottom",width:"700","popper-class":"no-padding-popover",trigger:"click"},model:{value:t.show,callback:function(i){e.$set(t,"show",i)},expression:"item.show"}},[a("crm-relative",{ref:"crmrelative",refInFor:!0,attrs:{show:t.show,radio:!1,action:{type:"condition",data:{moduleType:e.crmType,customerId:e.id}},"selected-data":"business"==t.type?{business:e.business}:{contacts:e.contacts},"crm-type":t.type},on:{close:function(e){t.show=!1},changeCheckout:e.checkRelativeInfos}}),e._v(" "),a("flexbox",{staticClass:"bar-item",attrs:{slot:"reference"},nativeOn:{click:function(i){e.barClick(t)}},slot:"reference"},[a("img",{staticClass:"bar-img",attrs:{src:t.img}}),e._v(" "),a("div",{staticClass:"bar-title"},[e._v(e._s(t.title))])])],1)]})],2)],1)},[],!1,null,"604eed47",null);c.options.__file="MixAdd.vue";t.a=c.exports},UYZx:function(e,t,i){"use strict";var a=i("w1wW");i.n(a).a},UllR:function(e,t,i){},VExD:function(e,t,i){"use strict";var a=i("HbFV");i.n(a).a},VPeB:function(e,t,i){"use strict";var a=i("I0zU");i.n(a).a},VwCy:function(e,t,i){"use strict";var a=i("tWWo");i.n(a).a},YEIV:function(e,t,i){"use strict";t.__esModule=!0;var a=function(e){return e&&e.__esModule?e:{default:e}}(i("SEkw"));t.default=function(e,t,i){return t in e?(0,a.default)(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}},YsaG:function(e,t,i){"use strict";var a=i("l4ns");i.n(a).a},YtBf:function(e,t,i){"use strict";var a=i("H+hK");i.n(a).a},Z9VC:function(e,t,i){},ZiYz:function(e,t,i){"use strict";var a=i("62Ps");i.n(a).a},aNXn:function(e,t,i){"use strict";var a=i("QhQt");i.n(a).a},"aQg/":function(e,t,i){"use strict";var a=i("d0bK"),n=i("Op00"),s=i("KzkL"),l=i("7Qib"),c={name:"TaskLog",components:{TaskCell:n.a,Particulars:function(){return Promise.all([i.e("chunk-660d"),i.e("chunk-4b7d"),i.e("chunk-631f")]).then(i.bind(null,"+Gvz"))}},mixins:[a.a],props:{id:[String,Number],crmType:{type:String,default:""}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[]}},computed:{},watch:{id:function(e){this.refreshList()}},mounted:function(){var e=this,t=document.getElementById("follow-log-content");t.onscroll=function(){var i=t.scrollTop+t.clientHeight-t.scrollHeight;Math.abs(i)<10&&1==e.loadMoreLoading&&(e.isPost?e.loadMoreLoading=!1:(e.isPost=!0,e.page++,e.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var e=this;this.loading=!0;var t={page:this.page,limit:10};t[this.crmType+"Ids"]=this.id,Object(s.o)(t).then(function(t){t.data.list.forEach(function(e){5==e.status&&(e.checked=!0)}),e.list=e.list.concat(t.data.list),t.data.list.length<10?e.loadMoreLoading=!1:e.loadMoreLoading=!0,e.loading=!1,e.isPost=!1}).catch(function(){e.isPost=!1,e.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},taskCellHandle:function(e){var t=this;"view"==e.type&&this.showDetailView(e.data.item,e.data.index,function(){t.$nextTick(function(){document.body.appendChild(t.$refs.taskShade),t.$refs.taskShade.style.zIndex=Object(l.h)(),t.$refs.taskShade.addEventListener("click",t.handleDocumentClick,!1)})})},handleDocumentClick:function(e){e.stopPropagation(),this.$refs.taskShade==e.target&&(this.taskDetailShow=!1)}}},o=(i("dHxP"),i("KHd+")),r=Object(o.a)(c,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:0===e.list.length,expression:"list.length === 0"}]},[i("div",{staticClass:"log-items"},[e._l(e.list,function(t,a){return i("task-cell",{key:a,attrs:{data:t,"data-index":a},on:{"on-handle":e.taskCellHandle}})}),e._v(" "),i("div",{staticClass:"load"},[i("el-button",{attrs:{loading:e.loadMoreLoading,type:"text"}},[e._v(e._s(e.loadMoreLoading?"Tải thêm":"Không còn dữ liệu"))])],1)],2)]),e._v(" "),e.taskDetailShow?i("div",{ref:"taskShade",staticClass:"full-container"},[i("particulars",{staticClass:"d-view",attrs:{id:e.taskID,"detail-index":e.detailIndex},on:{"on-handle":e.detailHandle,close:e.closeBtn}})],1):e._e()])},[],!1,null,"27faf482",null);r.options.__file="TaskLog.vue";t.a=r.exports},arjo:function(e,t,i){},bH4c:function(e,t,i){"use strict";var a=i("/bsb");i.n(a).a},bwvB:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjdFOTRBNUY2RjEzRTExRThCMzE4RjAyMzQwQTc5RjQ3IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjdFOTRBNUY3RjEzRTExRThCMzE4RjAyMzQwQTc5RjQ3Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6N0U5NEE1RjRGMTNFMTFFOEIzMThGMDIzNDBBNzlGNDciIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6N0U5NEE1RjVGMTNFMTFFOEIzMThGMDIzNDBBNzlGNDciLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4t60rSAAAAkUlEQVR42mL8//8/AzUBEwOVAQuMsXr1arINCQ0NJdmFOtT0ch0QXwbiepK8jAOADIH5B0Y3kuvCGqghjlC+I5RfQ66BD6CGvIbyX0P5D8j18hIsYq9xiNMuHQ49A0nN2P/JdSHjoPHycyC2IVKvNRC/IJQOU0AFDxBLEGHgUyBOJmTgNiCWpMTLjIO+xAYIMABJgBzD8GiSjgAAAABJRU5ErkJggg=="},cYid:function(e,t,i){"use strict";var a=i("mX3o"),n=i("EgJF"),s=i("vG5h"),l=i("UcQx"),c=i("7Qib"),o={name:"RelativeContract",components:{CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-660d"),i.e("chunk-4b7d"),i.e("chunk-7962")]).then(i.bind(null,"uMjE"))},CRMCreateView:n.default},mixins:[a.a],props:{id:[String,Number],crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1},detail:{type:Object,default:function(){return{}}}},data:function(){return{nopermission:!1,list:[],fieldList:[],tableHeight:"400px",showFullDetail:!1,isCreate:!1,contractId:"",createActionInfo:{type:"relative",crmType:this.crmType,data:{}}}},computed:{},watch:{id:function(e){this.list=[],this.getDetail()}},mounted:function(){this.getDetail()},activated:function(){},deactivated:function(){},methods:{getFieldList:function(){this.fieldList.push({prop:"num",width:"200",label:"Số kỳ"}),this.fieldList.push({prop:"contractName",width:"200",label:"Hợp đồng"}),this.fieldList.push({prop:"customerName",width:"200",label:"Tên khách hàng"}),this.fieldList.push({prop:"money",width:"200",label:"Số tiền trong hợp đồng"}),this.fieldList.push({prop:"startTime",width:"200",label:"Ngày bắt đầu"}),this.fieldList.push({prop:"endTime",width:"200",label:"Ngày kết thúc"}),this.fieldList.push({prop:"checkStatus",width:"200",label:"Trạng thái"})},getDetail:function(){var e=this;this.loading=!0;var t={customer:s.p,business:l.h}[this.crmType],i={pageType:0};i[this.crmType+"Id"]=this.id,t(i).then(function(t){0==e.fieldList.length&&e.getFieldList(),e.nopermission=!1,e.loading=!1,e.list=t.data}).catch(function(t){102==t.code&&(e.nopermission=!0),e.loading=!1})},fieldFormatter:function(e,t){return"checkStatus"===t.property?this.getStatusName(e.checkStatus):"money"==t.property?Object(c.j)(e[t.property]):e[t.property]},getStatusName:function(e){return 0==e?"Chờ xử lý":1==e?"Đã duyệt":2==e?"Từ chối":3==e?"Đang xem xét":4==e?"Rút lại":5==e?"Chưa gởi":6==e?"Hủy":""},handleRowClick:function(e,t,i){this.contractId=e.contractId,this.showFullDetail=!0},headerRowStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}},cellStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return{textAlign:"center"}},createClick:function(){"business"==this.crmType?(this.createActionInfo.data.customer=this.detail,this.createActionInfo.data.business=this.detail):"customer"==this.crmType&&(this.createActionInfo.data.customer=this.detail),this.isCreate=!0},createSaveSuccess:function(){this.getDetail()}}},r=(i("GugH"),i("KHd+")),d=Object(r.a)(o,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"empty",rawName:"v-empty",value:e.nopermission,expression:"nopermission"}],staticClass:"rc-cont",attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"Không có quyền"}},[e.isSeas?e._e():i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(t){return e.createClick(t)}}},[e._v("Tạo hợp đồng mới\n    ")])],1),e._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:e.list,height:e.tableHeight,"header-cell-style":e.headerRowStyle,"cell-style":e.cellStyle,stripe:""},on:{"row-click":e.handleRowClick}},e._l(e.fieldList,function(t,a){return i("el-table-column",{key:a,attrs:{prop:t.prop,formatter:e.fieldFormatter,label:t.label,"show-overflow-tooltip":""}})})),e._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:e.showFullDetail,id:e.contractId,"crm-type":"contract"},on:{"update:visible":function(t){e.showFullDetail=t}}}),e._v(" "),e.isCreate?i("c-r-m-create-view",{attrs:{action:e.createActionInfo,"crm-type":"contract"},on:{"save-success":e.createSaveSuccess,"hiden-view":function(t){e.isCreate=!1}}}):e._e()],1)},[],!1,null,"21ec09c9",null);d.options.__file="RelativeContract.vue";t.a=d.exports},d0bK:function(e,t,i){"use strict";t.a={components:{},data:function(){return{taskID:"",detailIndex:-1,taskDetailShow:!1}},mounted:function(){},methods:{closeBtn:function(){this.taskDetailShow=!1},showDetailView:function(e,t,i){this.taskID=e.taskId,this.detailIndex=t,this.taskDetailShow=!0,i&&i()},detailHandle:function(e){if(0==e.index||e.index)if("title-check"==e.type)this.$set(this.list[e.index],"checked",e.value);else if("delete"==e.type)this.list.splice(e.index,1);else if("change-stop-time"==e.type){new Date(e.value).getTime()/1e3+86399>new Date(new Date).getTime()/1e3?this.list[e.index].isEnd=!1:this.list[e.index].isEnd=!0,this.list[e.index].stopTime=e.value}else if("change-priority"==e.type)this.list[e.index].priority=e.value.id;else if("change-name"==e.type)this.list[e.index].name=e.value;else if("change-comments"==e.type){var t=this.list[e.index].commentCount;"add"==e.value?this.list[e.index].commentCount=t+1:this.list[e.index].commentCount=t-1}else"change-sub-task"==e.type&&(this.list[e.index].childWCCount=e.value.subdonecount,this.list[e.index].childAllCount=e.value.allcount)}},deactivated:function(){}}},dHxP:function(e,t,i){"use strict";var a=i("DPCt");i.n(a).a},e738:function(e,t,i){},e9ks:function(e,t,i){"use strict";var a=i("0pN2");i.n(a).a},enjo:function(e,t,i){"use strict";var a=i("e738");i.n(a).a},etft:function(e,t,i){},g1XH:function(e,t,i){},gd5k:function(e,t,i){"use strict";var a=i("Fpl1"),n=i("+zsY"),s=i("KzkL"),l=i("ExMk"),c={name:"ExamineLog",components:{ExamineCell:a.a,CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-660d"),i.e("chunk-4b7d"),i.e("chunk-7962")]).then(i.bind(null,"uMjE"))},ExamineHandle:function(){return i.e("chunk-5e9a").then(i.bind(null,"QhmF"))},ExamineCreateView:n.a},props:{id:[String,Number],crmType:{type:String,default:""}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[],rowID:"",showExamineHandle:!1,isCreate:!1,createAction:{type:"save"},createInfo:{},showFullDetail:!1,detailCRMType:""}},computed:{},watch:{id:function(e){this.refreshList()}},mounted:function(){var e=this,t=document.getElementById("follow-log-content");t.onscroll=function(){var i=t.scrollTop+t.clientHeight-t.scrollHeight;Math.abs(i)<10&&1==e.loadMoreLoading&&(e.isPost?e.loadMoreLoading=!1:(e.isPost=!0,e.page++,e.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var e=this;this.loading=!0;var t={page:this.page,limit:10};t[this.crmType+"Ids"]=this.id,Object(s.k)(t).then(function(t){e.list=e.list.concat(t.data.list),t.data.list.length<10?e.loadMoreLoading=!1:e.loadMoreLoading=!0,e.loading=!1,e.isPost=!1}).catch(function(){e.isPost=!1,e.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},examineCellHandle:function(e){var t=this;"edit"==e.type?(e.data.item.title=e.data.item.categoryName,this.createInfo=e.data.item,this.createAction={type:"update",id:e.data.item.examineId,data:e.data.item},this.isCreate=!0):"delete"==e.type?this.$confirm("Xác nhận xóa?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){Object(l.d)({examineId:e.data.item.examineId}).then(function(e){t.refreshList(),t.$message({type:"success",message:"Thành công!"})})}).catch(function(){t.$message({type:"info",message:"Không thành công"})}):"withdraw"==e.type?(this.rowID=e.data.item.examineId,this.showExamineHandle=!0):"view"==e.type?(this.detailCRMType="examine",this.rowID=e.data.item.examineId,this.showFullDetail=!0):"related-detail"==e.type&&(this.rowID=e.data.item[e.data.type+"Id"],this.detailCRMType=e.data.type,this.showFullDetail=!0)}}},o=(i("iEOG"),i("KHd+")),r=Object(o.a)(c,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:0===e.list.length,expression:"list.length === 0"}]},[i("div",{staticClass:"log-items"},[e._l(e.list,function(t,a){return i("examine-cell",{key:a,attrs:{data:t},on:{"on-handle":e.examineCellHandle}})}),e._v(" "),i("div",{staticClass:"load"},[i("el-button",{attrs:{loading:e.loadMoreLoading,type:"text"}},[e._v(e._s(e.loadMoreLoading?"Tải thêm":"Không có dữ liệu"))])],1)],2)]),e._v(" "),i("examine-handle",{attrs:{show:e.showExamineHandle,id:e.rowID,"examine-type":"oa_examine",status:"2"},on:{close:function(t){e.showExamineHandle=!1},save:e.refreshList}}),e._v(" "),e.isCreate?i("examine-create-view",{attrs:{"category-id":e.createInfo.categoryId,"category-title":e.createInfo.title,type:e.createInfo.type,action:e.createAction},on:{"save-success":e.refreshList,"hiden-view":function(t){e.isCreate=!1}}}):e._e(),e._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:e.showFullDetail,"crm-type":e.detailCRMType,id:e.rowID},on:{"update:visible":function(t){e.showFullDetail=t}}})],1)},[],!1,null,"472c8e13",null);r.options.__file="ExamineLog.vue";t.a=r.exports},"gs/v":function(e,t,i){"use strict";var a=i("ta8G");i.n(a).a},"h+C4":function(e,t,i){"use strict";var a=i("ySAc");i.n(a).a},hIMY:function(e,t,i){"use strict";var a=i("M9eM");i.n(a).a},hdqD:function(e,t,i){"use strict";var a=i("xSw/");i.n(a).a},i68b:function(e,t,i){"use strict";var a=i("QbLZ"),n=i.n(a),s=i("KzkL"),l=i("L2JU");t.a={data:function(){return{followTypes:[],followType:""}},computed:n()({},Object(l.b)(["oa"]),{showOAPermission:function(){return this.oa}}),created:function(){this.getFollowLogType()},methods:{getFollowLogType:function(){var e=this;this.loading=!0,Object(s.x)().then(function(t){e.loading=!1,e.followTypes=t.data.map(function(e){return{type:e,name:e}}),e.followType=t.data.length>0?t.data[0]:""}).catch(function(){e.loading=!1})}},deactivated:function(){}}},i7tK:function(e,t,i){"use strict";var a=i("mcAI");i.n(a).a},i91G:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU2RjI0NjM0RTA5QjExRTg4QTE5QjM2OEE1QUE5MUZBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU2RjI0NjM1RTA5QjExRTg4QTE5QjM2OEE1QUE5MUZBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTZGMjQ2MzJFMDlCMTFFODhBMTlCMzY4QTVBQTkxRkEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTZGMjQ2MzNFMDlCMTFFODhBMTlCMzY4QTVBQTkxRkEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4H2LzoAAAAnklEQVR42mI8c+YMA7WAsbExAxMDlQGygSuA+B8Q/8eD/0HV4QQsSOwwNAtwAZChEcS4kJFIXzES62WqhyFdDESOqH1ocjuwRRQLAQPxRZQHEvsvLKKYKIkAbD5FNvA/kZr/ExuGq5HC6wiauo1I4bWa2IQdDsXYgP+gTTZUN5DYiPpHbDqERRQjAUtXE2sgvojCnnD///8/uCMFIMAAVWsql9WKpTgAAAAASUVORK5CYII="},iEOG:function(e,t,i){"use strict";var a=i("KKWy");i.n(a).a},jCyC:function(e,t,i){"use strict";var a=i("7F7P");i.n(a).a},jJjR:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjlFRDNFMUVGRjEzRTExRThBNjFERkQ5M0I1RDI1OUYzIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjlFRDNFMUYwRjEzRTExRThBNjFERkQ5M0I1RDI1OUYzIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OUVEM0UxRURGMTNFMTFFOEE2MURGRDkzQjVEMjU5RjMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OUVEM0UxRUVGMTNFMTFFOEE2MURGRDkzQjVEMjU5RjMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7Zm7p3AAABUklEQVR42qyUwUoCURSGnaGNtFSqdS8ggQS2sPAJ3AzlIhDzAVr4FJIgroMEFyqzKaFlQS0KxIWtxZZCoTvTndN/4x8QOQdnaC58c2fu/c/PnHvPvZbnebEo2455uK77byPHcf56W5k34wXQA9/AY9/juBYnThyCPqiBIQ2O2A853qdOTnnD7B08gjMw35h/AlXQoC4DPrU/NO9d8ABKgpnf5py/p97WDC/AAbgWTKRSMLp9xomGl+AOLAJu7BI0GScapsFLyGp5BSltU5IsDS3N9W+L/RdIaIZTsCcE+WaW8IdmDWdaygNwGjLlLPjQDFugCOIBzeLUtzTDDtekLgRL6dap72hruGJNvfG9An4Eo11wA/LghFr16I0pMidgBG7BMzfMVEEOlMGEuvG2s+ybHoNzXghXNJtx4ypMcxXkclhPv01CNSvqG9uORdx+BRgAmcBOEZLrcDgAAAAASUVORK5CYII="},kegP:function(e,t,i){"use strict";var a=i("GQeE"),n=i.n(a),s=i("QbLZ"),l=i.n(s),c=i("L2JU"),o=i("2qvR"),r=i("EgJF"),d=i("KzkL"),h=i("vG5h"),u=i("5tgW"),m=i("qbf4"),p=i("YrMO"),f=i("8GhS"),v=i("7Qib"),g={name:"CRMImport",components:{XhUserCell:f.p},props:{show:{type:Boolean,default:!1},crmType:{type:String,default:""}},data:function(){return{loading:!1,fieldList:[],config:1,file:{name:""},user:[],stepsActive:1,stepList:[{icon:"wk wk-upload",title:"Tải file lên",status:"wait"},{icon:"wk wk-data-import",title:"Nhập dữ liệu",status:"wait"},{icon:"wk wk-success",title:"Nhập xong",status:"wait"}],resultData:null,processData:{count:0,status:""},messageId:null,intervalTimer:null,historyPopoverShow:!1}},computed:l()({},Object(c.b)(["userInfo"]),{crmTypeName:function(){return{customer:"Khách hàng chính thức",leads:"Khách hàng tiềm năng",contacts:"Thông tin liên lạc",product:"Sản phẩm"}[this.crmType]||""},sureTitle:function(){return{1:"Nhập ngay",2:"Nén dữ liệu",3:"Sửa lỗi"}[this.stepsActive]},showCancel:function(){return 2!=this.stepsActive},fieldUniqueInfo:function(){return this.fieldList.filter(function(e){return 1==e.isUnique}).map(function(e){return e.name}).join("/")||"0"}}),watch:{show:function(e){e?(1==this.stepsActive&&this.userInfo&&(this.user=[this.userInfo]),this.getField()):(3==this.stepsActive&&this.resetData(),this.fieldList=[])},stepsActive:function(){this.$emit("status",{1:"wait",2:"process",3:"finish"}[this.stepsActive])}},mounted:function(){},methods:{sureClick:function(){var e=this;1==this.stepsActive?"finish"==this.stepList[0].status?(this.stepList[1].status="process",this.stepsActive=2,this.firstUpdateFile(function(t){e.messageId=t.data,e.secondQueryNum(),e.intervalTimer=setInterval(function(){"end"==e.processData.status?(clearInterval(e.intervalTimer),e.intervalTimer=null,e.thirdQueryResult()):e.secondQueryNum()},2e3)})):this.file.name?"customer"==this.crmType||this.user&&0!=this.user.length||this.$message.error("Vui lòng chọn người phụ trách"):this.$message.error("Vui lòng chọn tệp nhập"):this.closeView()},firstUpdateFile:function(e){var t=this,i={};i.repeatHandling=this.config,i.file=this.file,i.ownerUserId=this.user.length>0?this.user[0].userId:"";var a={customer:h.g,leads:u.e,contacts:m.e,product:p.e}[this.crmType];this.loading=!0,a(i).then(function(t){e&&e(t)}).catch(function(){e&&e(!1),t.loading=!1})},secondQueryNum:function(){var e=this;Object(d.m)({messageId:this.messageId}).then(function(t){null===t.data?e.processData.status="end":(e.processData.status="",e.processData.count=t.data)}).catch(function(){})},thirdQueryResult:function(){var e=this;Object(d.l)({messageId:this.messageId}).then(function(t){e.loading=!1,e.stepList[1].status="finish",e.stepsActive=3,e.$emit("status","finish"),t&&(e.resultData=t,t.errSize>0?e.stepList[2].status="error":e.stepList[2].status="finish")}).catch(function(){})},downloadErrData:function(){var e=this;this.loading=!0,Object(d.b)({messageId:this.messageId}).then(function(t){Object(v.a)(t),e.loading=!1}).catch(function(){e.loading=!1})},download:function(){(0,{customer:h.d,leads:u.b,contacts:m.b,product:p.b}[this.crmType])().then(function(e){var t=new Blob([e.data],{type:"application/vnd.ms-excel;charset=utf-8"}),i=document.createElement("a"),a=window.URL.createObjectURL(t);i.href=a,i.download=decodeURI(e.headers["content-disposition"].split("filename=")[1])||"",document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(a)}).catch(function(){})},selectFile:function(){document.getElementById("importInputFile").click()},uploadFile:function(e){var t=e.target.files[0];this.file=t,e.target.value="",this.getFirstStepStatus()},userSelect:function(e){e.value&&e.value.length>0?this.user=e.value:this.user=[],this.getFirstStepStatus()},getFirstStepStatus:function(){var e=this.file&&this.file.size,t=this.user&&this.user.length>0;"customer"===this.crmType?this.stepList[0].status=e?"finish":"wait":this.stepList[0].status=e&&t?"finish":"wait"},closeView:function(){this.$emit("update:show",!1),this.$emit("close",3==this.stepsActive?"finish":"")},resetData:function(){this.config=1,this.file={name:""},this.user=[],this.stepsActive=1,this.stepList=[{icon:"wk wk-upload",title:"Tải tệp lên",status:"wait"},{icon:"wk wk-data-import",title:"Nhập dữ liệu",status:"wait"},{icon:"wk wk-success",title:"Nhập xong",status:"wait"}],this.resultData=null,this.processData={count:0,status:""},this.messageId=null},getField:function(){var e=this,t={label:o.a[this.crmType]};Object(d.y)(t).then(function(t){e.fieldList=t.data}).catch(function(){})}}},b=(i("PZm3"),i("KHd+")),y=Object(b.a)(g,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{visible:e.show,title:"Nhập "+e.crmTypeName,"append-to-body":!0,"close-on-click-modal":!1,width:"600px"},on:{close:e.closeView}},[i("div",{staticClass:"dialog-body"},[1==e.stepsActive?i("div",{staticClass:"step-section"},[i("div",{staticClass:"sections"},[i("div",{staticClass:"sections__title"},[e._v("1. Hãy chuẩn bị dữ liệu cần nhập theo định dạng của mẫu dữ liệu."),i("span",{staticClass:"download",on:{click:e.download}},[e._v("Bấm chuột để tải xuống 《"+e._s(e.crmTypeName)+" tập tin mẫu》")])]),e._v(" "),i("div",{staticClass:"sections__tips"},[e._v("Kích thước giới hạn 2MB（Khoảng 10.000 dòng dữ liệu）")])]),e._v(" "),i("div",{staticClass:"sections"},[i("div",{staticClass:"sections__title"},[e._v("2. Vui lòng chọn phương pháp xử lý khi dữ liệu bị trùng lặp (quy tắc kiểm tra trùng lặp)：【"+e._s(e.fieldUniqueInfo)+"】）")]),e._v(" "),i("div",{staticClass:"sections__tips"},[e._v("Quy tắc kiểm tra trùng lặp là: thêm "+e._s(e.crmTypeName)+" tất cả các trường duy nhất cần được điền vào, các trường duy nhất hiện tại là: "+e._s(e.fieldUniqueInfo))]),e._v(" "),i("div",{staticClass:"content"},[i("el-select",{attrs:{placeholder:"Chọn"},model:{value:e.config,callback:function(t){e.config=t},expression:"config"}},e._l([{name:"Ghi đè dữ liệu gốc của hệ thống",value:1},{name:"Bỏ qua",value:2}],function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.value}})}))],1)]),e._v(" "),i("div",{staticClass:"sections"},[i("div",{staticClass:"sections__title"},[e._v("3. Vui lòng chọn file để nhập")]),e._v(" "),i("div",{staticClass:"content"},[i("flexbox",{staticClass:"file-select"},[i("el-input",{attrs:{disabled:!0},model:{value:e.file.name,callback:function(t){e.$set(e.file,"name",t)},expression:"file.name"}}),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.selectFile}},[e._v("Chọn file")])],1)],1)]),e._v(" "),i("div",{staticClass:"sections"},[i("div",{staticClass:"sections__title"},[e._v("4. Vui lòng chọn người phụ trách（"+e._s("customer"==e.crmType?"Nếu bạn không chọn, khách hàng nhập khẩu sẽ vào bể đầu vào":"Bắt buộc")+"）")]),e._v(" "),i("div",{staticClass:"content"},[i("div",{staticClass:"user-cell"},[i("xh-user-cell",{attrs:{value:e.user},on:{"value-change":e.userSelect}})],1)])])]):2==e.stepsActive?i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"step-section",attrs:{"element-loading-text":"Nhập dữ liệu","element-loading-spinner":"el-icon-loading"}}):3==e.stepsActive?i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"step-section"},[i("div",{staticClass:"result-info"},[i("i",{staticClass:"wk wk-success result-info__icon"}),e._v(" "),i("p",{staticClass:"result-info__des"},[e._v("Nhập dữ liệu hoàn tất")]),e._v(" "),i("p",{staticClass:"result-info__detail"},[e._v("Tổng dữ liệu đã nhập "),i("span",{staticClass:"result-info__detail--all"},[e._v(e._s(e.resultData.totalSize))]),e._v(" dòng, đã nhập thành công "),i("span",{staticClass:"result-info__detail--suc"},[e._v(e._s(e.resultData.totalSize-e.resultData.errSize))]),e._v(" dòng, đã nhập không thành công "),i("span",{staticClass:"result-info__detail--err"},[e._v(e._s(e.resultData.errSize))]),e._v(" dòng")]),e._v(" "),e.resultData&&e.resultData.errSize>0?i("el-button",{staticClass:"result-info__btn--err",attrs:{type:"text"},on:{click:e.downloadErrData}},[e._v("Tải xuống dữ liệu sai")]):e._e()],1)]):e._e(),e._v(" "),i("input",{attrs:{id:"importInputFile",type:"file",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},on:{change:e.uploadFile}})]),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-popover",{attrs:{placement:"top",width:"800","popper-class":"no-padding-popover",trigger:"click"},model:{value:e.historyPopoverShow,callback:function(t){e.historyPopoverShow=t},expression:"historyPopoverShow"}}),e._v(" "),i("el-button",{class:{"is-hidden":!e.showCancel},on:{click:e.closeView}},[e._v("Đóng")]),e._v(" "),e.sureTitle?i("el-button",{attrs:{type:"primary"},on:{click:e.sureClick}},[e._v(e._s(e.sureTitle))]):e._e()],1)])},[],!1,null,"59f87914",null);y.options.__file="CRMImport.vue";var C=y.exports,w=i("UcQx"),I=i("6zBA"),k=i("ooHJ"),T={name:"CRMExport",components:{},props:{show:{type:Boolean,default:!1},crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1},search:{type:String,default:""},scene_id:{type:[Number,String],default:""},filterObj:{type:Object,default:function(){return{}}},exportParams:{type:Object,default:function(){return{}}}},data:function(){return{showDialog:!1,progress:"",error:"",done:!1,cancel:!1,exportQueueIndex:"",tempData:{temp_file:""},sortData:{}}},computed:l()({},Object(c.b)(["userInfo"]),{crmTypeName:function(){return{customer:"Khách hàng chính thức",leads:"Khách hàng tiềm năng",contacts:"Thông tin liên lạc",product:"Sản phẩm"}[this.crmType]||""}}),watch:{show:function(e){var t=this;this.showDialog=e,e?(this.cancel=!1,this.exportInfos(),window.onbeforeunload=function(e){return t.exportInfos({page:-1,temp_file:t.tempData.temp_file}),e}):window.onbeforeunload=null}},mounted:function(){var e=this;this.$bus.off("getSortData"),this.$bus.on("getSortData",function(t){e.sortData=t})},methods:{closeView:function(){this.error="",this.done=!1,this.exportQueueIndex="",this.progress="",this.$emit("close")},beforeClose:function(e){var t=this;this.error||this.done?e():this.$confirm("Thao tác này sẽ chấm dứt quá trình xuất, có tiếp tục không?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){t.cancel=!0,e()}).catch(function(){})},exportInfos:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=l()({export_queue_index:this.exportQueueIndex,search:this.search},this.exportParams,this.sortData,t);for(var a in this.scene_id&&(i.scene_id=this.scene_id),this.filterObj)i[a]=this.filterObj[a];var n="All";i.ids&&(n="");(this.isSeas?h.l:{customer:h.f,customerAll:h.e,leads:u.d,leadsAll:u.c,contacts:m.d,contactsAll:m.c,product:p.d,productAll:p.c,business:w.d,businessAll:w.c,contract:I.d,contractAll:I.c,receivables:k.c,receivablesAll:k.b}[this.crmType+n])(i).then(function(t){if(-1!==t.data.type.indexOf("json")){var i=new Blob([t.data],{type:"application/json"}),a=new FileReader;a.readAsText(i,"utf-8"),a.onload=function(){var t=JSON.parse(a.result);e.tempData=t.data,t.error?e.error=t.error:(e.exportQueueIndex=t.data.export_queue_index,e.cancel?-1!==t.data.page&&e.exportInfos({page:-1,temp_file:t.data.temp_file}):-2===t.data.page?setTimeout(function(){e.exportInfos({page:1,temp_file:t.data.temp_file})},1e3):t.data.page>0&&(e.exportInfos({page:t.data.page,temp_file:t.data.temp_file}),e.progress=String(t.data.done)+" / "+String(t.data.total)))}}else{e.exportQueueIndex="",e.done=!0;i=new Blob([t.data],{type:"application/vnd.ms-excel;charset=utf-8"});var n=document.createElement("a"),s=window.URL.createObjectURL(i);n.href=s,n.download=decodeURI(t.headers["content-disposition"].split("filename=")[1])||"",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(s)}}).catch(function(){})}}},x=(i("UYZx"),Object(b.a)(T,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{visible:e.showDialog,title:"Xuất "+e.crmTypeName,"append-to-body":!0,"close-on-click-modal":!1,"before-close":e.beforeClose,"close-on-press-escape":!1,width:"550px"},on:{"update:visible":function(t){e.showDialog=t},close:e.closeView}},[i("div",{staticClass:"dialog-body"},[e.error?i("p",{staticClass:"error",domProps:{textContent:e._s(e.error)}}):e._e(),e._v(" "),e.done?i("p",{staticClass:"done"},[i("i",{staticClass:"el-icon-success"}),e._v("\n      Xuất hoàn tất\n    ")]):e.cancel?i("p",{staticClass:"cancel"},[i("i",{staticClass:"el-icon-warning"}),e._v("\n      Đã hủy xuất\n    ")]):i("div",[i("i",{staticClass:"el-icon-loading"}),e._v("\n      Đang xuất...\n      "+e._s(e.progress)+"\n    ")])]),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})])},[],!1,null,"7674629f",null));x.options.__file="CRMExport.vue";var _=x.exports,A={name:"CRMListHead",components:{CRMCreateView:r.default,CRMImport:C,CRMExport:_},props:{title:{type:String,default:""},placeholder:{type:String,default:"Vui lòng nhập nội dung"},mainTitle:{type:String,default:""},crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1},search:String,scene_id:{type:[Number,String],default:""},filterObj:{type:Object,default:function(){return{}}}},data:function(){return{inputContent:"",moreTypes:[],createActionInfo:{type:"save"},createCRMType:"",isCreate:!1,showCRMImport:!1,showCRMExport:!1,exportParams:{}}},computed:l()({},Object(c.b)(["crm"]),{canSave:function(){return!this.isSeas&&this.crm[this.crmType].save}}),mounted:function(){this.isSeas?this.crm.pool.excelexport&&this.moreTypes.push({type:"out",name:"Xuất báo cáo"}):(this.crm[this.crmType].excelimport&&this.moreTypes.push({type:"enter",name:"Xuất báo cáo"}),this.crm[this.crmType].excelexport&&this.moreTypes.push({type:"out",name:"Xuất báo cáo"}))},methods:{handleTypeDrop:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("out"==e){var i={};t.__export?delete(i=t).__export:i={},this.exportParams=i,this.showCRMExport=!0}else"enter"==e&&(this.showCRMImport=!0)},createClick:function(){this.createCRMType=this.crmType,this.createActionInfo={type:"save"},this.isCreate=!this.isCreate},inputChange:function(){this.$emit("update:search",this.inputContent)},searchInput:function(){this.$emit("on-search",this.inputContent)},createSaveSuccess:function(e){e&&e.saveAndCreate?"customer"==e.type&&(this.createCRMType="contacts",this.createActionInfo={type:"relative",crmType:"customer",data:{}},this.createActionInfo.data.customer=e.data,this.isCreate=!0):this.$emit("on-handle",{type:"save-success"})},hideView:function(){this.isCreate=!1}}},D=(i("YtBf"),Object(b.a)(A,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"c-container"},[i("div",{staticClass:"title"},[e._v(e._s(e.title))]),e._v(" "),i("el-input",{staticClass:"sc-container",attrs:{placeholder:e.placeholder},on:{input:e.inputChange},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.searchInput(t):null}},model:{value:e.inputContent,callback:function(t){e.inputContent=t},expression:"inputContent"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},nativeOn:{click:function(t){return e.searchInput(t)}},slot:"append"})],1),e._v(" "),i("div",{staticClass:"right-container"},[e.canSave?i("el-button",{attrs:{type:"primary"},on:{click:e.createClick}},[e._v(e._s(e.mainTitle))]):e._e(),e._v(" "),e.moreTypes.length>0?i("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleTypeDrop}},[i("flexbox",{staticClass:"right-more-item"},[i("div",[e._v("Công cụ")]),e._v(" "),i("i",{staticClass:"el-icon-arrow-down el-icon--right",staticStyle:{color:"#777"}})]),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.moreTypes,function(t,a){return i("el-dropdown-item",{key:a,attrs:{command:t.type}},[e._v(e._s(t.name))])}))],1):e._e()],1),e._v(" "),e.isCreate?i("c-r-m-create-view",{attrs:{"crm-type":e.createCRMType,action:e.createActionInfo},on:{"save-success":e.createSaveSuccess,"hiden-view":e.hideView}}):e._e(),e._v(" "),i("c-r-m-import",{attrs:{show:e.showCRMImport,"crm-type":e.crmType},on:{close:function(t){e.showCRMImport=!1}}}),e._v(" "),i("c-r-m-export",{attrs:{show:e.showCRMExport,"crm-type":e.crmType,search:e.search,scene_id:e.scene_id,"filter-obj":e.filterObj,"is-seas":e.isSeas,"export-params":e.exportParams},on:{close:function(t){e.showCRMExport=!1}}})],1)},[],!1,null,"17b31c32",null));D.options.__file="CRMListHead.vue";var N=D.exports,R=i("YEIV"),L=i.n(R),S=i("gDS+"),E=i.n(S),j=i("oWS4"),M=i("NS7n"),O={name:"SceneList",components:{},props:{crmType:{type:String,default:""}},data:function(){return{sceneSelectId:-1,sceneList:[]}},computed:l()({},Object(c.b)(["crm"])),watch:{},mounted:function(){this.crm[this.crmType].index&&this.getSceneList()},methods:{getSceneList:function(){var e=this;Object(d.s)({type:o.a[this.crmType]}).then(function(t){var i=t.data.filter(function(e,t){return 1===e.isDefault});if(i&&i.length>0){var a=i[0];e.sceneSelectId=a.sceneId,e.$emit("scene",{id:a.sceneId,name:a.name,bydata:a.bydata||""})}else e.sceneSelectId="",e.$emit("scene",{id:"",name:"",bydata:""});e.sceneList=t.data}).catch(function(){e.$emit("scene",{id:"",name:"",bydata:""})})},selectScene:function(e,t){this.sceneSelectId=e.sceneId,this.$emit("scene",{id:e.sceneId,name:e.name,bydata:e.bydata}),this.$emit("hidden-scene")},addScene:function(){this.$emit("scene-handle",{type:"add"})},setScene:function(){this.$emit("scene-handle",{type:"set"})}}},F=(i("5u+S"),Object(b.a)(O,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"scene-container"},[a("div",{staticClass:"scene-list"},e._l(e.sceneList,function(t,i){return a("div",{key:i,staticClass:"scene-list-item",class:{"scene-list-item-select":t.sceneId==e.sceneSelectId},on:{click:function(a){e.selectScene(t,i)}}},[e._v("\n      "+e._s(t.name)+"\n    ")])})),e._v(" "),a("div",[a("flexbox",{staticClass:"handle-button",nativeOn:{click:function(t){return e.addScene(t)}}},[a("img",{staticClass:"handle-button-icon",attrs:{src:i("5hU7")}}),e._v(" "),a("div",{staticClass:"handle-button-name"},[e._v("Kịch bản mới")])]),e._v(" "),a("flexbox",{staticClass:"handle-button",nativeOn:{click:function(t){return e.setScene(t)}}},[a("img",{staticClass:"handle-button-icon",attrs:{src:i("HfS2")}}),e._v(" "),a("div",{staticClass:"handle-button-name"},[e._v("Quản lý")])])],1)])},[],!1,null,"38e34ee4",null));F.options.__file="SceneList.vue";var B=F.exports,G=i("t2rG"),Z=i.n(G),U={name:"SceneCreate",components:{XhUserCell:f.p},props:{dialogVisible:{type:Boolean,required:!0,default:!1},fieldList:{type:Array,required:!0,default:function(){return[]}},obj:{type:Object,default:function(){return{}},required:!0},crmType:{type:String,default:""},name:{type:String,default:""},isDefault:{type:Boolean,default:!1},edit_id:{type:String,default:""}},data:function(){return{form:[],visible:!1,showErrors:!1,saveDefault:!1,saveName:null}},watch:{dialogVisible:{handler:function(e){var t=this;if(e){if(this.edit_id){this.form=[];var i=function(e){var i=t.obj.obj[e],a=t.getItem();if(a.fieldName=i.name,a.condition=i.condition,a.formType=i.formType,"date"==i.formType)a.value=[i.start_date,i.end_date];else if("datetime"==i.formType)a.value=[i.start,i.end];else if("business_type"==i.formType){if(a.typeId=i.typeId,a.statusId=i.statusId,a.typeOption=i.setting,i.typeId){var n=i.setting.find(function(e){return e.typeId===i.typeId});a.statusOption=n?n.statusList:[]}}else"user"==i.formType?a.value=i.setting?[i.setting]:[]:(a.setting=i.setting,a.value=i.value);t.form.push(a)};for(var a in this.obj.obj)i(a)}else this.form=Object(v.k)(this.obj.form),0==this.form.length&&this.form.push(this.getItem());this.name?this.saveName=this.name:this.saveName="",this.isDefault?this.saveDefault=this.isDefault:this.saveDefault=!1}this.visible=this.dialogVisible},deep:!0,immediate:!0},form:function(){this.$nextTick(function(){var e=document.getElementById("scene-filter-container");e.scrollTop=e.scrollHeight})}},methods:{getItem:function(){return{fieldName:"",name:"",formType:"",condition:"is",value:"",typeOption:[],statusOption:[],typeId:"",statusId:""}},typeOptionsChange:function(e){if(e.typeId){var t=e.typeOption.find(function(t){return t.typeId===e.typeId});e.statusOption=t.statusList||[]}else e.statusOption=[];e.statusId=""},userValueChange:function(e){e.value.length>0?e.item.value=e.value:e.item.value=[]},calConditionOptions:function(e,t){return"select"==e||"checkbox"==e||"user"==e||"checkStatus"==e?[{value:"is",label:"bằng",disabled:!1},{value:"isNot",label:"không bằng",disabled:!1}]:"module"==e||"text"==e||"textarea"==e?[{value:"is",label:"bằng",disabled:!1},{value:"isNot",label:"không bằng",disabled:!1},{value:"contains",label:"có chứa",disabled:!1},{value:"notContains",label:"không chứa",disabled:!1}]:"floatnumber"==e||"number"==e?[{value:"is",label:"bằng",disabled:!1},{value:"isNot",label:"không bằng",disabled:!1},{value:"contains",label:"có chứa",disabled:!1},{value:"notContains",label:"không chứa",disabled:!1},{value:"isNull",label:"là rỗng",disabled:!1},{value:"isNotNull",label:"không rỗng",disabled:!1},{value:"gt",label:"lớn hơn",disabled:!1},{value:"egt",label:"lớn hơn hoặc bằng",disabled:!1},{value:"lt",label:"nhỏ hơn",disabled:!1},{value:"elt",label:"nhỏ hơn hoặc bằng",disabled:!1}]:[{value:"is",label:"bằng",disabled:!1},{value:"isNot",label:"không bằng",disabled:!1},{value:"contains",label:"có chứa",disabled:!1},{value:"notContains",label:"không chứa",disabled:!1},{value:"startWith",label:"bắt đầu từ",disabled:!1},{value:"endWith",label:"kết thúc lúc",disabled:!1},{value:"isNull",label:"là rỗng",disabled:!1},{value:"isNotNull",label:"không rỗng",disabled:!1},{value:"gt",label:"lớn hơn",disabled:!1},{value:"egt",label:"lớn hơn hoặc bằng",disabled:!1},{value:"lt",label:"nhỏ hơn",disabled:!1},{value:"elt",label:"nhỏ hơn hoặc bằng",disabled:!1}]},fieldChange:function(e){var t=this.fieldList.find(function(t){return t.fieldName===e.fieldName});t&&(e.formType=t.formType,e.name=t.name,"business_type"==e.formType?(e.typeOption=t.setting,e.statusOption=[],e.typeId="",e.statusId=""):"select"==e.formType||"checkStatus"==e.formType?e.setting=t.setting||[]:"date"!==e.formType&&"datetime"!==e.formType&&"user"!==e.formType||(e.value=[])),this.form.filter(function(t){return t.fieldName===e.fieldName}).length>1?this.showErrors=!0:this.showErrors=!1},handleCancel:function(){this.visible=!1,this.$emit("update:dialogVisible",!1)},handleConfirm:function(){if(this.showErrors)this.$message.error("Có sự trùng lắp trong bộ lọc!");else if(this.saveName&&""!==this.saveName){for(var e=0;e<this.form.length;e++){var t=this.form[e];if(!t.fieldName||""===t.fieldName)return void this.$message.error("Tên trường được lọc không được để trống!");if("business_type"==t.formType){if(!t.typeId&&!t.statusId)return void this.$message.error("Vui lòng nhập giá trị của tiêu chí lọc!")}else if("date"==t.formType||"datetime"==t.formType||"user"==t.formType){if(!t.value||0===t.value.length)return void this.$message.error("Vui lòng nhập giá trị của tiêu chí lọc!")}else if(!t.value)return void this.$message.error("Vui lòng nhập giá trị của tiêu chí lọc!")}var i={};this.form.forEach(function(e){"datetime"==e.formType||"date"==e.formType?i[e.fieldName]={start:e.value[0],end:e.value[1],formType:e.formType,name:e.fieldName}:"business_type"==e.formType?i[e.fieldName]={typeId:e.typeId,statusId:e.statusId,formType:e.formType,name:e.fieldName}:"user"==e.formType?i[e.fieldName]={condition:e.condition,value:e.value[0].userId,formType:e.formType,setting:e.value[0],name:e.fieldName}:i[e.fieldName]={condition:e.condition,value:e.value,formType:e.formType,name:e.fieldName}});var a={obj:i,form:this.form,saveDefault:this.saveDefault,saveName:this.saveName};this.requestCreateScene(a)}else this.$message.error("Tên kịch bản không được để trống!")},requestCreateScene:function(e){var t=this;this.edit_id?Object(d.w)({isDefault:e.saveDefault?1:0,name:e.saveName,sceneId:this.edit_id,data:E()(e.obj)}).then(function(e){t.$message({type:"success",message:"Thành công"}),t.$emit("saveSuccess"),t.handleCancel()}).catch(function(){}):Object(d.t)({type:o.a[this.crmType],isDefault:e.saveDefault?1:0,name:e.saveName,data:E()(e.obj)}).then(function(e){t.$message({type:"success",message:"Thành công"}),t.$emit("saveSuccess"),t.handleCancel()}).catch(function(){})},handleAdd:function(){this.form.push(this.getItem())},handleDelete:function(e){var t=this;this.$confirm("Xác nhận xóa?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){t.form.splice(e,1)}).catch(function(){t.$message({type:"info",message:"Không thành công"})})}}},Y=(i("s9Sa"),Object(b.a)(U,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:e.edit_id?"Chỉnh sửa kịch bản":"Thêm kịch bản mới",visible:e.visible,"append-to-body":!0,width:"800px"},on:{"update:visible":function(t){e.visible=t},close:e.handleCancel}},[i("div",{staticClass:"scene-name-container"},[i("div",{staticClass:"scene-name"},[e._v("Tên kịch bản")]),e._v(" "),i("el-input",{staticClass:"scene-input",attrs:{maxlength:10,placeholder:"Vui lòng nhập tên kịch bản, tối đa 10 ký tự"},model:{value:e.saveName,callback:function(t){e.saveName="string"==typeof t?t.trim():t},expression:"saveName"}})],1),e._v(" "),i("div",{staticClass:"scene-name"},[e._v("Bộ lọc dữ liệu")]),e._v(" "),i("el-form",{staticClass:"filter-container",attrs:{id:"scene-filter-container"}},[i("el-form-item",[e._l(e.form,function(t,a){return[i("el-row",{key:a},[i("el-col",{attrs:{span:8}},[i("el-select",{attrs:{placeholder:"Vui lòng chọn tên trường sẽ được lọc"},on:{change:function(i){e.fieldChange(t)}},model:{value:t.fieldName,callback:function(i){e.$set(t,"fieldName",i)},expression:"formItem.fieldName"}},e._l(e.fieldList,function(e){return i("el-option",{key:e.fieldName,attrs:{label:e.name,value:e.fieldName}})}))],1),e._v(" "),"date"!==t.formType&&"datetime"!==t.formType&&"business_type"!==t.formType?i("el-col",{attrs:{span:1}},[e._v(" ")]):e._e(),e._v(" "),"date"!==t.formType&&"datetime"!==t.formType&&"business_type"!==t.formType?i("el-col",{attrs:{span:4}},[i("el-select",{attrs:{placeholder:"Vui lòng chọn điều kiện"},model:{value:t.condition,callback:function(i){e.$set(t,"condition",i)},expression:"formItem.condition"}},e._l(e.calConditionOptions(t.formType,t),function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1):e._e(),e._v(" "),"business_type"==t.formType?i("el-col",{attrs:{span:1}},[e._v(" ")]):e._e(),e._v(" "),"business_type"==t.formType?i("el-col",{attrs:{span:4}},[i("el-select",{attrs:{placeholder:"Vui lòng chọn"},on:{change:function(i){e.typeOptionsChange(t)}},model:{value:t.typeId,callback:function(i){e.$set(t,"typeId",i)},expression:"formItem.typeId"}},e._l(t.typeOption,function(e){return i("el-option",{key:e.typeId,attrs:{label:e.name,value:e.typeId}})}))],1):e._e(),e._v(" "),i("el-col",{attrs:{span:1}},[e._v(" ")]),e._v(" "),i("el-col",{attrs:{span:"datetime"===t.formType||"date"===t.formType?13:8}},["select"===t.formType?i("el-select",{attrs:{placeholder:"Vui lòng chọn tiêu chí bộ lọc"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"formItem.value"}},e._l(t.setting,function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})):"checkStatus"===t.formType?i("el-select",{attrs:{placeholder:"Vui lòng chọn tiêu chí bộ lọc"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"formItem.value"}},e._l(t.setting,function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})):"date"===t.formType||"datetime"===t.formType?i("el-date-picker",{staticStyle:{padding:"0px 10px"},attrs:{"value-format":"date"===t.formType?"yyyy-MM-dd":"yyyy-MM-dd HH:mm:ss",type:"date"===t.formType?"daterange":"datetimerange","range-separator":"-","start-placeholder":"Ngày bắt đầu","end-placeholder":"Ngày kết thúc"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"formItem.value"}}):"business_type"===t.formType?i("el-select",{attrs:{placeholder:"Chọn"},model:{value:t.statusId,callback:function(i){e.$set(t,"statusId",i)},expression:"formItem.statusId"}},e._l(t.statusOption,function(e){return i("el-option",{key:e.statusId,attrs:{label:e.name,value:e.statusId}})})):"user"===t.formType?i("xh-user-cell",{attrs:{item:t,value:t.value},on:{"value-change":e.userValueChange}}):i("el-input",{attrs:{placeholder:"Vui lòng nhập giá trị"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"formItem.value"}})],1),e._v(" "),i("el-col",{staticClass:"delete",attrs:{span:1}},[i("i",{staticClass:"el-icon-error delete-btn",on:{click:function(t){e.handleDelete(a)}}})])],1)]})],2)],1),e._v(" "),i("p",{directives:[{name:"show",rawName:"v-show",value:e.showErrors,expression:"showErrors"}],staticClass:"el-icon-warning warning-info"},[i("span",{staticClass:"desc"},[e._v("Có sự trùng lắp trong các điều kiện bộ lọc!")])]),e._v(" "),i("el-button",{attrs:{type:"text"},on:{click:e.handleAdd}},[e._v("+ Thêm bộ lọc")]),e._v(" "),i("div",{staticClass:"save"},[i("div",{staticClass:"save-setting"},[i("el-checkbox",{model:{value:e.saveDefault,callback:function(t){e.saveDefault=t},expression:"saveDefault"}},[e._v("Đặt làm mặc định")])],1)]),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.handleCancel}},[e._v("Hủy")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("Lưu")])],1)],1)},[],!1,null,"32d28761",null));Y.options.__file="SceneCreate.vue";var z=Y.exports,H={name:"SceneSet",components:{draggable:Z.a,SceneCreate:z},props:{dialogVisible:{type:Boolean,required:!0,default:!1},crmType:{type:String,default:""}},data:function(){return{defaultId:"",visible:!1,isleftIndeterminate:!1,checkleftAll:!1,checkedLeftData:[],leftCheckItems:[],isrightIndeterminate:!1,checkrightAll:!1,checkedRightData:[],rightCheckItems:[],moveItem:{},handlDefaultItem:{},showCreateScene:!1,fieldList:[],filterObj:{form:[]},filterName:"",filterDefault:!1,filterEditId:""}},computed:{},watch:{dialogVisible:{handler:function(e){this.visible=e,e&&this.getSceneList()},deep:!0,immediate:!0}},mounted:function(){},methods:{getSceneList:function(){var e=this;Object(d.u)({type:o.a[this.crmType]}).then(function(t){e.checkedLeftData=t.data.value.map(function(e,t){return e.check=!1,e}),e.checkedRightData=t.data.hide_value.map(function(e,t){return e.check=!1,e});var i=e.checkedLeftData.filter(function(e,t){return 1==e.isDefault});i&&i.length>0?e.defaultId=i[0].sceneId:e.defaultId=""}).catch(function(){})},handleConfirm:function(){var e=this,t=this;0==this.checkedLeftData.filter(function(e,i){return e.sceneId==t.defaultId}).length&&(this.defaultId=""),Object(d.v)({type:o.a[this.crmType],noHideIds:this.checkedLeftData.map(function(e,t,i){return e.sceneId}).join(","),hideIds:this.checkedRightData.map(function(e,t,i){return e.sceneId}).join(",")}).then(function(t){e.$message({type:"success",message:"Thảnh công"}),e.handleCancel(),e.$emit("save-success")}).catch(function(){})},itemHandle:function(e,t,i){var a=this;"edit"==e?this.addAndEditScene("edit",t):"delete"==e?this.$confirm("Bạn có chắc chắn muốn xóa dữ liệu này không?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){Object(d.r)({sceneId:t.sceneId}).then(function(e){a.$message({type:"success",message:"Thành công"}),a.checkedLeftData.splice(i,1),a.leftCheckItemChange(),a.$emit("save-success")}).catch(function(){})}).catch(function(){a.$message({type:"info",message:"Thành công"})}):"default"==e&&(this.handlDefaultItem=t)},defaultHandle:function(){var e=this;Object(d.q)({sceneId:this.handlDefaultItem.sceneId}).then(function(t){e.$message({type:"success",message:"Thành công"}),e.defaultId=e.handlDefaultItem.sceneId}).catch(function(){})},addAndEditScene:function(e,t){var i=this;Object(d.C)({label:o.a[this.crmType]}).then(function(a){i.fieldList=a.data,"edit"==e?(i.filterObj={form:[],obj:t.data},i.filterName=t.name,i.filterDefault=1==t.isDefault,i.filterEditId=t.sceneId.toString()):(i.filterObj={form:[]},i.filterEditId="",i.filterName="",i.filterDefault=!1),i.showCreateScene=!0}).catch(function(){})},handleCancel:function(){this.visible=!1,this.$emit("update:dialogVisible",!1)},rightMoveEnd:function(e){this.moveItem.check=!1,this.leftCheckItemChange(),this.rightCheckItemChange()},rightMove:function(e){this.moveItem=e.draggedContext.element},leftMoveEnd:function(e){this.moveItem.check=!1,this.leftCheckItemChange(),this.rightCheckItemChange()},leftMove:function(e){this.moveItem=e.draggedContext.element},handleleftCheckAllChange:function(e){e&&(this.isleftIndeterminate=!1),this.checkedLeftData=this.checkedLeftData.filter(function(t,i,a){return t.check=e,t}),this.leftCheckItems=e?this.checkedLeftData:[]},leftCheckItemChange:function(){this.leftCheckItems=this.checkedLeftData.filter(function(e,t,i){return 1==e.check}),this.leftCheckItems.length>0?this.leftCheckItems.length==this.checkedLeftData.length?(this.checkleftAll=!0,this.isleftIndeterminate=!1):(this.checkleftAll=!1,this.isleftIndeterminate=!0):(this.checkleftAll=!1,this.isleftIndeterminate=!1)},handlerightCheckAllChange:function(e){e&&(this.isrightIndeterminate=!1),this.checkedRightData=this.checkedRightData.filter(function(t,i,a){return t.check=e,t}),this.rightCheckItems=e?this.checkedRightData:[]},rightCheckItemChange:function(){this.rightCheckItems=this.checkedRightData.filter(function(e,t,i){return 1==e.check}),this.rightCheckItems.length>0?this.rightCheckItems.length==this.checkedRightData.length?(this.checkrightAll=!0,this.isrightIndeterminate=!1):(this.checkrightAll=!1,this.isrightIndeterminate=!0):(this.checkrightAll=!1,this.isrightIndeterminate=!1)},changePositon:function(e){var t=this;"left"==e?(this.checkedRightData=this.checkedRightData.filter(function(e,i,a){var n=!1;return t.rightCheckItems.forEach(function(t,i){e.sceneId==t.sceneId&&(n=!0)}),!n}),this.rightCheckItems.forEach(function(e,i){e.check=!1,t.checkedLeftData.push(e)}),this.rightCheckItems=[],this.isrightIndeterminate=!1,this.checkrightAll=!1,this.leftCheckItemChange(),this.rightCheckItemChange()):(this.checkedLeftData=this.checkedLeftData.filter(function(e,i,a){var n=!1;return t.leftCheckItems.forEach(function(t,i){e.sceneId==t.sceneId&&(n=!0)}),!n}),this.leftCheckItems.forEach(function(e,i){e.check=!1,t.checkedRightData.push(e)}),this.leftCheckItems=[],this.isleftIndeterminate=!1,this.checkleftAll=!1,this.leftCheckItemChange(),this.rightCheckItemChange())}}},V=(i("hdqD"),Object(b.a)(H,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{visible:e.visible,"append-to-body":!0,title:"Quản lý kịch bản",width:"700px"},on:{"update:visible":function(t){e.visible=t},close:e.handleCancel}},[i("div",{staticClass:"scene-name"},[e._v("Bạn có thể quản lý các thẻ bằng cách kéo và thả")]),e._v(" "),i("flexbox",{staticClass:"scene-list"},[i("div",{staticClass:"scene-list-box"},[i("flexbox",{staticClass:"scene-list-head"},[i("el-checkbox",{attrs:{indeterminate:e.isleftIndeterminate},on:{change:e.handleleftCheckAllChange},model:{value:e.checkleftAll,callback:function(t){e.checkleftAll=t},expression:"checkleftAll"}}),e._v(" "),i("div",{staticClass:"scene-list-head-name"},[e._v("Nhãn được hiển thị")]),e._v(" "),i("div",{staticClass:"scene-list-head-detail"},[e._v(e._s(e.leftCheckItems.length+"/"+e.checkedLeftData.length))])],1),e._v(" "),i("div",{staticClass:"scene-list-body"},[e._l(e.checkedLeftData,function(t,a){return 1==t.isSystem?i("flexbox",{key:a,staticClass:"list-item"},[i("div",{staticClass:"default-mark",class:{"default-mark-active":t.sceneId==e.defaultId}}),e._v(" "),i("el-checkbox",{staticClass:"list-item-check",attrs:{disabled:!0},on:{change:e.leftCheckItemChange},model:{value:t.check,callback:function(i){e.$set(t,"check",i)},expression:"item.check"}}),e._v(" "),i("div",{staticClass:"list-item-name"},[e._v(e._s(t.name))]),e._v(" "),i("div",{staticClass:"list-item-handle"},[i("el-dropdown",{attrs:{trigger:"click"},on:{command:e.defaultHandle}},[i("i",{staticClass:"el-icon-arrow-down",on:{click:function(i){e.itemHandle("default",t,a)}}}),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",[e._v("Đặt làm nhãn mặc định")])],1)],1)],1)],1):e._e()}),e._v(" "),i("draggable",{staticStyle:{"min-height":"100px"},attrs:{move:e.leftMove,options:{group:"list",forceFallback:!1,fallbackClass:"draggingStyle"}},on:{end:e.leftMoveEnd},model:{value:e.checkedLeftData,callback:function(t){e.checkedLeftData=t},expression:"checkedLeftData"}},e._l(e.checkedLeftData,function(t,a){return 1!=t.isSystem?i("flexbox",{key:a,staticClass:"list-item"},[i("div",{staticClass:"default-mark",class:{"default-mark-active":t.sceneId==e.defaultId}}),e._v(" "),i("el-checkbox",{staticClass:"list-item-check",on:{change:e.leftCheckItemChange},model:{value:t.check,callback:function(i){e.$set(t,"check",i)},expression:"item.check"}}),e._v(" "),i("div",{staticClass:"list-item-name"},[e._v(e._s(t.name))]),e._v(" "),i("div",{staticClass:"list-item-handle"},[i("i",{staticClass:"el-icon-edit",on:{click:function(i){e.itemHandle("edit",t,a)}}}),e._v(" "),i("i",{staticClass:"el-icon-delete",on:{click:function(i){e.itemHandle("delete",t,a)}}}),e._v(" "),i("el-dropdown",{on:{command:e.defaultHandle}},[i("i",{staticClass:"el-icon-arrow-down",on:{click:function(i){e.itemHandle("default",t,a)}}}),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",[e._v("Đặt làm nhãn mặc định")])],1)],1)],1)],1):e._e()}))],2)],1),e._v(" "),i("div",{staticClass:"scene-middle-list"},[i("el-button",{staticClass:"scene-middle-left-button",class:{"scene-middle-button-select":e.rightCheckItems.length>0},attrs:{disabled:0==e.rightCheckItems.length},on:{click:function(t){e.changePositon("left")}}},[i("i",{staticClass:"el-icon-arrow-left scene-middle-icon"})]),e._v(" "),i("el-button",{staticClass:"scene-middle-right-button",class:{"scene-middle-button-select":e.leftCheckItems.length>0},attrs:{disabled:0==e.leftCheckItems.length},on:{click:function(t){e.changePositon("right")}}},[i("i",{staticClass:"el-icon-arrow-right scene-middle-icon"})])],1),e._v(" "),i("div",{staticClass:"scene-list-box"},[i("flexbox",{staticClass:"scene-list-head"},[i("el-checkbox",{attrs:{indeterminate:e.isrightIndeterminate},on:{change:e.handlerightCheckAllChange},model:{value:e.checkrightAll,callback:function(t){e.checkrightAll=t},expression:"checkrightAll"}}),e._v(" "),i("div",{staticClass:"scene-list-head-name"},[e._v("Nhãn ẩn")]),e._v(" "),i("div",{staticClass:"scene-list-head-detail"},[e._v(e._s(e.rightCheckItems.length+"/"+e.checkedRightData.length))])],1),e._v(" "),i("div",{staticClass:"scene-list-body"},[i("draggable",{staticStyle:{"min-height":"100px"},attrs:{move:e.rightMove,options:{group:"list",forceFallback:!1,fallbackClass:"draggingStyle"}},on:{end:e.rightMoveEnd},model:{value:e.checkedRightData,callback:function(t){e.checkedRightData=t},expression:"checkedRightData"}},e._l(e.checkedRightData,function(t,a){return i("flexbox",{key:a,staticClass:"list-item"},[i("el-checkbox",{staticClass:"list-item-check",staticStyle:{"margin-left":"9px"},on:{change:e.rightCheckItemChange},model:{value:t.check,callback:function(i){e.$set(t,"check",i)},expression:"item.check"}}),e._v(" "),i("div",{staticClass:"list-item-name"},[e._v(e._s(t.name))])],1)}))],1)],1)]),e._v(" "),i("div",{staticClass:"handle-bar"},[i("div",{staticClass:"handle-bar-add",on:{click:function(t){e.addAndEditScene("add",{})}}},[e._v("+ Kịch bản mới")]),e._v(" "),i("div",{staticClass:"handle-bar-save"},[i("el-button",{nativeOn:{click:function(t){return e.handleCancel(t)}}},[e._v("Hủy")]),e._v(" "),i("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.handleConfirm(t)}}},[e._v("Lưu")])],1)]),e._v(" "),i("scene-create",{attrs:{"field-list":e.fieldList,"crm-type":e.crmType,"dialog-visible":e.showCreateScene,obj:e.filterObj,name:e.filterName,edit_id:e.filterEditId,"is-default":e.filterDefault},on:{"update:dialogVisible":function(t){e.showCreateScene=t},saveSuccess:e.getSceneList}})],1)},[],!1,null,"1b9b90f2",null));V.options.__file="SceneSet.vue";var Q=V.exports,J=i("QY39"),P=i("eOzp"),W=i("V47a"),X=i("ZfAJ"),$={name:"CRMTableHead",components:{filterForm:j.a,filterContent:M.a,SceneList:B,TransferHandle:J.a,TeamsHandle:P.a,AllocHandle:W.a,SceneCreate:z,SceneSet:Q,DealStatusHandle:X.a},props:{title:{type:String,default:""},crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1}},data:function(){return{sceneTypes:[{type:"enter",name:"Đầu vào"},{type:"out",name:"Đầu ra"}],sceneType:null,showScene:!1,showFilter:!1,fieldList:[],filterObj:{form:[]},sceneData:{id:"",bydata:"",name:""},showSceneSet:!1,showSceneCreate:!1,sceneFilterObj:{form:[]},selectionList:[],transferDialogShow:!1,teamsDialogShow:!1,teamsTitle:"",allocDialogShow:!1,dealStatusShow:!1}},computed:l()({},Object(c.b)(["crm","CRMConfig"])),watch:{},mounted:function(){},methods:{handleTypeDrop:function(e){this.sceneType=e},showFilterClick:function(){this.getFilterFieldInfo()},getFilterFieldInfo:function(){var e=this;Object(d.C)({label:o.a[this.crmType]}).then(function(t){e.fieldList=t.data,e.showFilter=!0}).catch(function(){})},handleFilter:function(e){var t=this;this.filterObj=e,this.showFilter=!1,e.saveChecked&&Object(d.t)({type:o.a[this.crmType],isDefault:e.saveDefault?1:0,name:e.saveName,data:E()(e.obj)}).then(function(e){t.updateSceneList()}).catch(function(){}),this.$emit("filter",e.obj)},handleDeleteField:function(e){this.filterObj=e.obj,this.$emit("filter",this.filterObj.obj)},sceneSelect:function(e){this.sceneData=e,this.$emit("scene",e)},sceneHandle:function(e){var t=this;"set"==e.type?this.showSceneSet=!0:"add"==e.type&&Object(d.C)({label:o.a[this.crmType]}).then(function(e){t.fieldList=e.data,t.showSceneCreate=!0}).catch(function(){})},updateSceneList:function(){this.$refs.sceneList.getSceneList()},headSelectionChange:function(e){this.selectionList=e},selectionBarClick:function(e){var t=this;if("transfer"==e)this.transferDialogShow=!0;else if("export"==e){var i={};i.ids=this.selectionList.map(function(e){return e[t.crmType+"Id"]}).join(","),i.__export=!0,this.$emit("exportData",i)}else if("transform"==e||"put_seas"==e||"delete"==e||"lock"==e||"unlock"==e||"start"==e||"disable"==e||"get"==e){var a="";"transform"==e?a="Bạn có chắc chắn chuyển đổi những khách hàng tiềm năng này thành khách hàng chính thức không?":"put_seas"==e?a="Bạn có chắc chắn để chuyển đến bể đầu vào?":"delete"==e?a="Bạn có chắc chắn muốn xóa dữ liệu này không?":"lock"==e?a="Bạn có chắc chắn muốn khóa những khách hàng này không? Sau khi bị khóa, nó sẽ không chuyển đến bể đầu vào.":"unlock"==e?a="Bạn có chắc chắn muốn mở khóa những khách hàng này không?":"start"==e?a="Bạn có chắc chắn muốn liệt kê những sản phẩm này không?":"disable"==e?a="Bạn có chắc chắn muốn xóa các sản phẩm này không?":"get"==e&&(a="Bạn có chắc chắn muốn yêu cầu khách hàng này không?"),this.$confirm(a,"Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){t.confirmHandle(e)}).catch(function(){t.$message({type:"info",message:"Thành công"})})}else"add_user"==e?(this.teamsTitle="Thêm thành viên trong nhóm",this.teamsDialogShow=!0):"delete_user"==e?(this.teamsTitle="Xóa các thành viên trong nhóm",this.teamsDialogShow=!0):"alloc"==e?this.allocDialogShow=!0:"deal_status"==e&&(this.dealStatusShow=!0)},confirmHandle:function(e){var t=this;if("lock"===e||"unlock"===e){var i=this.selectionList.map(function(e,t,i){return e.customerId});Object(h.i)({isLock:"lock"===e?"1":"0",ids:i.join(",")}).then(function(i){t.$message({type:"success",message:"Thành công"}),t.$emit("handle",{type:e})}).catch(function(){})}else if("put_seas"===e){i=this.selectionList.map(function(e,t,i){return e.customerId});Object(h.m)({ids:i.join(",")}).then(function(i){t.$message({type:"success",message:"Thành công"}),t.$emit("handle",{type:e})}).catch(function(){})}else if("transform"===e){var a=this.selectionList.map(function(e,t,i){return e.leadsId});Object(u.n)({leadsIds:a.join(",")}).then(function(i){t.$message({type:"success",message:"Thành công"}),t.$emit("handle",{type:e})}).catch(function(){})}else if("start"===e||"disable"===e){var n=this.selectionList.map(function(e,t,i){return e.productId});Object(p.i)({ids:n.join(","),status:"start"===e?"1":"0"}).then(function(i){t.$message({type:"success",message:"Thành công"}),t.$emit("handle",{type:e})}).catch(function(){})}else if("delete"===e){var s=this,l=this.selectionList.map(function(e,t,i){return e[s.crmType+"Id"]});(0,{leads:u.a,customer:h.b,contacts:m.a,business:w.b,contract:I.b,receivables:k.a,product:p.a}[this.crmType])(L()({},this.crmType+"Ids",l.join(","))).then(function(i){t.$message({type:"success",message:"Thành công"}),t.$emit("handle",{type:e})}).catch(function(){})}else if("get"===e){i=this.selectionList.map(function(e,t,i){return e.customerId});Object(h.u)({ids:i.join(",")}).then(function(i){t.$message({type:"success",message:"Thành công"}),t.$emit("handle",{type:e})}).catch(function(){})}},getSelectionHandleItemsInfo:function(){var e={transfer:{name:"Chuyển giao",type:"transfer",icon:i("W1y5")},transform:{name:"Chuyển đổi thành khách hàng",type:"transform",icon:i("rvIm")},export:{name:"Xuất báo cáo",type:"export",icon:i("bwvB")},delete:{name:"Xóa",type:"delete",icon:i("NKOo")},put_seas:{name:"Chuyển sang bể đầu vào",type:"put_seas",icon:i("tmjI")},lock:{name:"Khóa",type:"lock",icon:i("lYrD")},unlock:{name:"Mở khóa",type:"unlock",icon:i("4N2P")},add_user:{name:"Thêm thành viên trong nhóm",type:"add_user",icon:i("jJjR")},delete_user:{name:"Xóa các thành viên trong nhóm",type:"delete_user",icon:i("svWA")},alloc:{name:"Bàn giao",type:"alloc",icon:i("aQEv")},get:{name:"Xem",type:"get",icon:i("lF6w")},start:{name:"Làm nổi bật",type:"start",icon:i("yTN1")},disable:{name:"Ẩn",type:"disable",icon:i("disj")},deal_status:{name:"Thay đổi trạng thái giao dịch",type:"deal_status",icon:i("6c4z")}};return"leads"==this.crmType?this.forSelectionHandleItems(e,["transfer","transform","export","delete"]):"customer"==this.crmType?this.isSeas?this.forSelectionHandleItems(e,["alloc","get","delete","export"]):this.forSelectionHandleItems(e,["transfer","export","deal_status","put_seas","delete","lock","unlock","add_user","delete_user"]):"contacts"==this.crmType?this.forSelectionHandleItems(e,["transfer","export","delete"]):"business"==this.crmType?this.forSelectionHandleItems(e,["transfer","delete","add_user","delete_user","export"]):"contract"==this.crmType?this.forSelectionHandleItems(e,["transfer","delete","add_user","delete_user","export"]):"receivables"==this.crmType?this.forSelectionHandleItems(e,["delete","export"]):"product"==this.crmType?this.forSelectionHandleItems(e,["start","disable","delete","export"]):void 0},forSelectionHandleItems:function(e,t){for(var i=[],a=0;a<t.length;a++)i.push(e[t[a]]);return i},whetherTypeShowByPermision:function(e){if("transfer"==e)return"transform"!=this.sceneData.bydata&&this.crm[this.crmType].transfer;if("transform"==e)return"transform"!=this.sceneData.bydata&&this.crm[this.crmType].transform;if("export"==e)return this.isSeas?this.crm.pool.excelexport:this.crm[this.crmType].excelexport;if("delete"==e)return this.crm[this.crmType].delete;if("put_seas"==e)return this.crm[this.crmType].putinpool;if("lock"==e||"unlock"==e)return this.crm[this.crmType].lock&&1==this.CRMConfig.customerConfig;if("add_user"==e||"delete_user"==e)return this.crm[this.crmType].teamsave;if("alloc"==e)return this.crm.pool.distribute;if("get"==e)return this.crm.pool.receive;if("start"==e){for(var t=0;t<this.selectionList.length;t++){if("Nổi bật"==this.selectionList[t].是否上下架)return!1}return this.crm[this.crmType].status}if("disable"==e){for(var i=0;i<this.selectionList.length;i++){if("Ẩn"==this.selectionList[i].是否上下架)return!1}return this.crm[this.crmType].status}return"deal_status"!=e||this.crm[this.crmType].dealStatus},handleCallBack:function(e){this.$emit("handle",{type:e.type})},getDefaultSceneName:function(){return"leads"==this.crmType?"Khách hàng tiềm năng":"customer"==this.crmType?"Khách hàng chính thức":"contacts"==this.crmType?"Thông tin liên lạc":"business"==this.crmType?"Cơ hội kinh doanh":"contract"==this.crmType?"Hợp đồng":"receivables"==this.crmType?"Doanh thu":"product"==this.crmType?"Sản phẩm":void 0}}},K=(i("enjo"),Object(b.a)($,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("flexbox",{directives:[{name:"show",rawName:"v-show",value:0==e.selectionList.length,expression:"selectionList.length == 0"}],staticClass:"th-container"},[e.isSeas?e._e():a("div",[e._v("Phễu：")]),e._v(" "),e.isSeas?e._e():a("el-popover",{attrs:{trigger:"click","popper-class":"no-padding-popover",width:"150"},model:{value:e.showScene,callback:function(t){e.showScene=t},expression:"showScene"}},[a("flexbox",{attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"condition_title"},[e._v(e._s(e.sceneData.name||e.getDefaultSceneName()))]),e._v(" "),a("i",{staticClass:"el-icon-arrow-down el-icon--right",staticStyle:{color:"#777"}})]),e._v(" "),a("scene-list",{ref:"sceneList",attrs:{"crm-type":e.crmType},on:{scene:e.sceneSelect,"scene-handle":e.sceneHandle,"hidden-scene":function(t){e.showScene=!1}}})],1),e._v(" "),a("img",{staticClass:"c-filtrate",style:{"margin-left":e.isSeas?0:"30px"},attrs:{src:i("3gs7")},on:{click:e.showFilterClick}}),e._v(" "),a("div",{staticClass:"condition_title",on:{click:e.showFilterClick}},[e._v("Lọc")]),e._v(" "),a("filter-form",{attrs:{"field-list":e.fieldList,"dialog-visible":e.showFilter,obj:e.filterObj,"crm-type":e.crmType,"is-seas":e.isSeas},on:{"update:dialogVisible":function(t){e.showFilter=t},filter:e.handleFilter}})],1),e._v(" "),e.selectionList.length>0?a("flexbox",{staticClass:"selection-bar"},[a("div",{staticClass:"selected—title"},[e._v("Đã chọn "),a("span",{staticClass:"selected—count"},[e._v(e._s(e.selectionList.length))]),e._v(" mục")]),e._v(" "),a("flexbox",{staticClass:"selection-items-box"},e._l(e.getSelectionHandleItemsInfo(),function(t,i){return e.whetherTypeShowByPermision(t.type)?a("flexbox",{key:i,staticClass:"selection-item",nativeOn:{click:function(i){e.selectionBarClick(t.type)}}},[a("img",{staticClass:"selection-item-icon",attrs:{src:t.icon}}),e._v(" "),a("div",{staticClass:"selection-item-name"},[e._v(e._s(t.name))])]):e._e()}))],1):e._e(),e._v(" "),e.filterObj.form&&e.filterObj.form.length>0?a("filter-content",{attrs:{obj:e.filterObj},on:{delete:e.handleDeleteField}}):e._e(),e._v(" "),a("transfer-handle",{attrs:{"crm-type":e.crmType,"selection-list":e.selectionList,"dialog-visible":e.transferDialogShow},on:{"update:dialogVisible":function(t){e.transferDialogShow=t},handle:e.handleCallBack}}),e._v(" "),a("teams-handle",{attrs:{"crm-type":e.crmType,title:e.teamsTitle,"selection-list":e.selectionList,"dialog-visible":e.teamsDialogShow},on:{"update:dialogVisible":function(t){e.teamsDialogShow=t},handle:e.handleCallBack}}),e._v(" "),a("alloc-handle",{attrs:{"crm-type":e.crmType,"selection-list":e.selectionList,"dialog-visible":e.allocDialogShow},on:{"update:dialogVisible":function(t){e.allocDialogShow=t},handle:e.handleCallBack}}),e._v(" "),a("deal-status-handle",{attrs:{"crm-type":e.crmType,"selection-list":e.selectionList,visible:e.dealStatusShow},on:{"update:visible":function(t){e.dealStatusShow=t},handle:e.handleCallBack}}),e._v(" "),a("scene-set",{attrs:{"dialog-visible":e.showSceneSet,"crm-type":e.crmType},on:{"update:dialogVisible":function(t){e.showSceneSet=t},"save-success":e.updateSceneList}}),e._v(" "),a("scene-create",{attrs:{"field-list":e.fieldList,"crm-type":e.crmType,"dialog-visible":e.showSceneCreate,obj:e.sceneFilterObj},on:{"update:dialogVisible":function(t){e.showSceneCreate=t},saveSuccess:e.updateSceneList}})],1)},[],!1,null,"505c1de5",null));K.options.__file="CRMTableHead.vue";var q=K.exports,ee={name:"FieldsSet",components:{draggable:Z.a},props:{dialogVisible:{type:Boolean,required:!0,default:!1},crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1}},data:function(){return{visible:!1,isleftIndeterminate:!1,checkleftAll:!1,leftInput:"",checkedLeftData:[],leftCheckItems:[],isrightIndeterminate:!1,checkrightAll:!1,rightInput:"",checkedRightData:[],rightCheckItems:[],moveItem:{},handlDefaultItem:{}}},computed:{},watch:{dialogVisible:{handler:function(e){this.visible=e,e&&0==this.checkedLeftData.length&&0==this.checkedRightData.length&&this.getFieldConfigIndex()},deep:!0,immediate:!0}},mounted:function(){document.body.ondrop=function(e){e.preventDefault(),e.stopPropagation()}},methods:{getFieldConfigIndex:function(){var e=this;Object(d.h)({label:this.isSeas?o.a.pool:o.a[this.crmType]}).then(function(t){e.checkedLeftData=t.data.value.map(function(e,t){return e.check=!1,e.show=!0,e}),e.checkedRightData=t.data.hideValue.map(function(e,t){return e.check=!1,e.show=!0,e})}).catch(function(){})},inputLeftChange:function(e){this.checkedLeftData=this.checkedLeftData.map(function(t,i){return-1!=t.name.indexOf(e)?t.show=!0:t.show=!1,t})},inputRightChange:function(e){this.checkedRightData=this.checkedRightData.map(function(t,i){return-1!=t.name.indexOf(e)?t.show=!0:t.show=!1,t})},handleConfirm:function(){var e=this;this.checkedLeftData.length<2?this.$message.error("Ít nhất hai cột phải được hiển thị"):Object(d.g)({label:this.isSeas?o.a.pool:o.a[this.crmType],noHideIds:this.checkedLeftData.map(function(e){return e.id}).join(","),hideIds:this.checkedRightData.map(function(e){return e.id}).join(",")}).then(function(t){e.$message.success("Thành công"),e.$emit("set-success"),e.handleCancel()}).catch(function(){})},handleCancel:function(){this.visible=!1,this.$emit("update:dialogVisible",!1)},rightMoveEnd:function(e){this.moveItem.check=!1,this.leftCheckItemChange(),this.rightCheckItemChange()},rightMove:function(e){this.moveItem=e.draggedContext.element},leftMoveEnd:function(e){this.moveItem.check=!1,this.leftCheckItemChange(),this.rightCheckItemChange()},leftMove:function(e){this.moveItem=e.draggedContext.element},handleleftCheckAllChange:function(e){e&&(this.isleftIndeterminate=!1),this.checkedLeftData=this.checkedLeftData.filter(function(t,i,a){return t.check=e,t}),this.leftCheckItems=e?this.checkedLeftData:[]},leftCheckItemChange:function(){this.leftCheckItems=this.checkedLeftData.filter(function(e,t,i){return 1==e.check}),this.leftCheckItems.length>0?this.leftCheckItems.length==this.checkedLeftData.length?(this.checkleftAll=!0,this.isleftIndeterminate=!1):(this.checkleftAll=!1,this.isleftIndeterminate=!0):(this.checkleftAll=!1,this.isleftIndeterminate=!1)},handlerightCheckAllChange:function(e){e&&(this.isrightIndeterminate=!1),this.checkedRightData=this.checkedRightData.filter(function(t,i,a){return t.check=e,t}),this.rightCheckItems=e?this.checkedRightData:[]},rightCheckItemChange:function(){this.rightCheckItems=this.checkedRightData.filter(function(e,t,i){return 1==e.check}),this.rightCheckItems.length>0?this.rightCheckItems.length==this.checkedRightData.length?(this.checkrightAll=!0,this.isrightIndeterminate=!1):(this.checkrightAll=!1,this.isrightIndeterminate=!0):(this.checkrightAll=!1,this.isrightIndeterminate=!1)},changePositon:function(e){var t=this;"left"==e?(this.checkedRightData=this.checkedRightData.filter(function(e,i,a){var n=!1;return t.rightCheckItems.forEach(function(t,i){e.id==t.id&&(n=!0)}),!n}),this.rightCheckItems.forEach(function(e,i){e.check=!1,t.checkedLeftData.push(e)}),this.rightCheckItems=[],this.isrightIndeterminate=!1,this.checkrightAll=!1,this.leftCheckItemChange(),this.rightCheckItemChange()):(this.checkedLeftData=this.checkedLeftData.filter(function(e,i,a){var n=!1;return t.leftCheckItems.forEach(function(t,i){e.id==t.id&&(n=!0)}),!n}),this.leftCheckItems.forEach(function(e,i){e.check=!1,t.checkedRightData.push(e)}),this.leftCheckItems=[],this.isleftIndeterminate=!1,this.checkleftAll=!1,this.leftCheckItemChange(),this.rightCheckItemChange())}}},te=(i("C+yI"),Object(b.a)(ee,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{visible:e.visible,"append-to-body":!0,title:"Chỉnh sửa cột",width:"600px"},on:{"update:visible":function(t){e.visible=t},close:e.handleCancel}},[i("div",{staticClass:"scene-name"},[e._v("Bạn có thể sắp xếp cột bằng cách kéo và thả")]),e._v(" "),i("flexbox",{staticClass:"scene-list"},[i("div",{staticClass:"scene-list-box"},[i("flexbox",{staticClass:"scene-list-head"},[i("el-checkbox",{attrs:{indeterminate:e.isleftIndeterminate},on:{change:e.handleleftCheckAllChange},model:{value:e.checkleftAll,callback:function(t){e.checkleftAll=t},expression:"checkleftAll"}}),e._v(" "),i("div",{staticClass:"scene-list-head-name"},[e._v("Cột được hiển thị")]),e._v(" "),i("div",{staticClass:"scene-list-head-detail"},[e._v(e._s(e.leftCheckItems.length+"/"+e.checkedLeftData.length))])],1),e._v(" "),i("div",{staticStyle:{position:"relative"}},[i("div",{staticClass:"scene-list-search"},[i("el-input",{attrs:{placeholder:"Vui lòng nhập",size:"small","suffix-icon":"el-icon-search"},on:{input:e.inputLeftChange},model:{value:e.leftInput,callback:function(t){e.leftInput=t},expression:"leftInput"}})],1),e._v(" "),i("div",{staticClass:"scene-list-body"},[i("draggable",{staticStyle:{"min-height":"100px"},attrs:{move:e.leftMove,options:{group:"list",forceFallback:!0}},on:{end:e.leftMoveEnd},model:{value:e.checkedLeftData,callback:function(t){e.checkedLeftData=t},expression:"checkedLeftData"}},e._l(e.checkedLeftData,function(t,a){return t.show?i("flexbox",{key:a,staticClass:"list-item"},[i("el-checkbox",{staticClass:"list-item-check",on:{change:e.leftCheckItemChange},model:{value:t.check,callback:function(i){e.$set(t,"check",i)},expression:"item.check"}}),e._v(" "),i("div",{staticClass:"list-item-name"},[e._v(e._s(t.name))])],1):e._e()}))],1)])],1),e._v(" "),i("div",{staticClass:"scene-middle-list"},[i("el-button",{staticClass:"scene-middle-left-button",class:{"scene-middle-button-select":e.rightCheckItems.length>0},attrs:{disabled:0==e.rightCheckItems.length},on:{click:function(t){e.changePositon("left")}}},[i("i",{staticClass:"el-icon-arrow-left scene-middle-icon"})]),e._v(" "),i("el-button",{staticClass:"scene-middle-right-button",class:{"scene-middle-button-select":e.leftCheckItems.length>0},attrs:{disabled:0==e.leftCheckItems.length},on:{click:function(t){e.changePositon("right")}}},[i("i",{staticClass:"el-icon-arrow-right scene-middle-icon"})])],1),e._v(" "),i("div",{staticClass:"scene-list-box"},[i("flexbox",{staticClass:"scene-list-head"},[i("el-checkbox",{attrs:{indeterminate:e.isrightIndeterminate},on:{change:e.handlerightCheckAllChange},model:{value:e.checkrightAll,callback:function(t){e.checkrightAll=t},expression:"checkrightAll"}}),e._v(" "),i("div",{staticClass:"scene-list-head-name"},[e._v("Cột ẩn")]),e._v(" "),i("div",{staticClass:"scene-list-head-detail"},[e._v(e._s(e.rightCheckItems.length+"/"+e.checkedRightData.length))])],1),e._v(" "),i("div",{staticStyle:{position:"relative"}},[i("div",{staticClass:"scene-list-body"},[i("div",{staticClass:"scene-list-search"},[i("el-input",{attrs:{placeholder:"Vui lòng nhập",size:"small","suffix-icon":"el-icon-search"},on:{input:e.inputRightChange},model:{value:e.rightInput,callback:function(t){e.rightInput=t},expression:"rightInput"}})],1),e._v(" "),i("draggable",{staticStyle:{"min-height":"100px"},attrs:{move:e.rightMove,options:{group:"list",forceFallback:!0}},on:{end:e.rightMoveEnd},model:{value:e.checkedRightData,callback:function(t){e.checkedRightData=t},expression:"checkedRightData"}},e._l(e.checkedRightData,function(t,a){return t.show?i("flexbox",{key:a,staticClass:"list-item"},[i("el-checkbox",{staticClass:"list-item-check",on:{change:e.rightCheckItemChange},model:{value:t.check,callback:function(i){e.$set(t,"check",i)},expression:"item.check"}}),e._v(" "),i("div",{staticClass:"list-item-name"},[e._v(e._s(t.name))])],1):e._e()}))],1)])],1)]),e._v(" "),i("div",{staticClass:"handle-bar"},[i("div",{staticClass:"handle-bar-save"},[i("el-button",{nativeOn:{click:function(t){return e.handleCancel(t)}}},[e._v("Hủy")]),e._v(" "),i("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.handleConfirm(t)}}},[e._v("Lưu")])],1)])],1)},[],!1,null,"b52f77fe",null));te.options.__file="FieldsSet.vue";var ie=te.exports,ae=i("4peS"),ne=i.n(ae),se=i("XJYT");t.a={components:{CRMListHead:N,CRMTableHead:q,FieldsSet:ie},data:function(){return{loading:!1,tableHeight:document.documentElement.clientHeight-240,list:[],fieldList:[],sortData:{},currentPage:1,pageSize:ne.a.get("crmPageSizes")||15,pageSizes:[15,30,60,100],total:0,search:"",rowID:"",rowType:"",showDview:!1,filterObj:{},sceneId:"",sceneName:"",showFieldSet:!1,selectionList:[],formatterRules:{}}},computed:l()({},Object(c.b)(["crm"])),mounted:function(){var e=this;window.onresize=function(){e.updateTableHeight()},this.isSeas&&this.crm.pool.index?this.getFieldList():this.crm[this.crmType].index&&(this.loading=!0)},methods:{getList:function(){var e=this;this.loading=!0;var t=this.getIndexRequest(),i={page:this.currentPage,limit:this.pageSize,search:this.search,type:this.isSeas?o.a.pool:o.a[this.crmType]};this.sortData.order&&(i.sortField=this.sortData.prop,i.order="ascending"==this.sortData.order?2:1),this.sceneId&&(i.sceneId=this.sceneId),this.filterObj&&n()(this.filterObj).length>0&&(i.data=this.filterObj),t(i).then(function(t){"customer"===e.crmType?e.list=t.data.list.map(function(e){return 1===e.dealStatus?e.dealStatus="Chốt deal":e.dealStatus="Chưa chốt",e.show=!1,e}):("contract"===e.crmType&&(e.moneyData=t.data.money),e.list=t.data.list),e.total=t.data.totalRow,e.loading=!1}).catch(function(){e.loading=!1})},getIndexRequest:function(){return"leads"===this.crmType?u.f:"customer"===this.crmType?this.isSeas?h.j:h.h:"contacts"===this.crmType?m.f:"business"===this.crmType?w.e:"contract"===this.crmType?I.e:"product"===this.crmType?p.f:"receivables"===this.crmType?k.d:void 0},getFieldList:function(){var e=this;0==this.fieldList.length?(this.loading=!0,Object(d.A)({label:this.isSeas?o.a.pool:o.a[this.crmType]}).then(function(t){for(var i=0;i<t.data.length;i++){var a=t.data[i],n=0;n=a.width?a.width:a.name&&a.name.length<=6?15*a.name.length+45:140,"floatnumber"===a.formType&&(e.formatterRules[a.fieldName]={type:"floatnumber",formatter:function(e){return Object(v.j)(e)}}),e.fieldList.push({prop:a.fieldName,label:a.name,width:n})}e.getList()}).catch(function(){e.loading=!1})):this.getList()},fieldFormatter:function(e,t){var i=this.formatterRules[t.property];return i?i.formatter(e[t.property]):e[t.property]||"--"},crmSearch:function(e){this.currentPage=1,this.search=e,this.fieldList.length&&this.getList()},handleRowClick:function(e,t,i){if("selection"!==t.type)if("leads"===this.crmType)"leadsName"===t.property?(this.rowID=e.leadsId,this.showDview=!0):this.showDview=!1;else if("customer"===this.crmType){if("businessCheck"===t.property&&e.businessCount>0)return;"customerName"===t.property?(this.rowID=e.customerId,this.rowType="customer",this.showDview=!0):this.showDview=!1}else"contacts"===this.crmType?"customerName"===t.property?(this.rowID=e.customerId,this.rowType="customer",this.showDview=!0):"name"===t.property?(this.rowID=e.contactsId,this.rowType="contacts",this.showDview=!0):this.showDview=!1:"business"===this.crmType?"customerName"===t.property?(this.rowID=e.customerId,this.rowType="customer",this.showDview=!0):"businessName"===t.property?(this.rowID=e.businessId,this.rowType="business",this.showDview=!0):this.showDview=!1:"contract"===this.crmType?"customerName"===t.property?(this.rowID=e.customerId,this.rowType="customer",this.showDview=!0):"businessName"===t.property?(this.rowID=e.businessId,this.rowType="business",this.showDview=!0):"contactsName"===t.property?(this.rowID=e.contactsId,this.rowType="contacts",this.showDview=!0):"num"===t.property?(this.rowID=e.contractId,this.rowType="contract",this.showDview=!0):this.showDview=!1:"product"===this.crmType?"name"===t.property?(this.rowID=e.productId,this.showDview=!0):this.showDview=!1:"receivables"===this.crmType&&("customerName"===t.property?(this.rowID=e.customerId,this.rowType="customer",this.showDview=!0):"contractNum"===t.property?(this.rowID=e.contractId,this.rowType="contract",this.showDview=!0):"number"===t.property?(this.rowID=e.receivablesId,this.rowType="receivables",this.showDview=!0):this.showDview=!1)},exportInfos:function(){var e={search:this.search};this.sceneId&&(e.sceneId=this.sceneId),this.filterObj&&n()(this.filterObj).length>0&&(e.data=this.filterObj);var t=void 0;t=this.isSeas?h.k:{customer:h.e,leads:u.c,contacts:m.c,product:p.c}[this.crmType];var i=se.Loading.service({fullscreen:!0,text:"Xuất báo cáo..."});t(e).then(function(e){var t=new Blob([e.data],{type:"application/vnd.ms-excel;charset=utf-8"}),a=document.createElement("a"),n=window.URL.createObjectURL(t);a.href=n,a.download=decodeURI(e.headers["content-disposition"].split("filename=")[1])||"",document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(n),i.close()}).catch(function(){i.close()})},handleFilter:function(e){this.filterObj=e;var t=document.documentElement.clientHeight,i=n()(this.filterObj).length>0?310:240;this.tableHeight=t-i,this.currentPage=1,this.getList()},handleScene:function(e){this.sceneId=e.id,this.sceneName=e.name,this.currentPage=1,this.getFieldList()},handleHandle:function(e){"alloc"!==e.type&&"get"!==e.type&&"transfer"!==e.type&&"transform"!==e.type&&"delete"!==e.type&&"put_seas"!==e.type||(this.showDview=!1),"edit"!==e.type&&this.getList()},setSave:function(){this.fieldList=[],this.getFieldList()},listHeadHandle:function(e){"save-success"===e.type&&(this.currentPage=1,this.getList())},handleTableSet:function(){this.showFieldSet=!0},sortChange:function(e,t,i){this.currentPage=1,this.sortData=e,this.getList()},handleSelectionChange:function(e){this.selectionList=e,this.$refs.crmTableHead.headSelectionChange(e)},handleHeaderDragend:function(e,t,i,a){if(i.property){var n=this.isSeas?this.crmType+"_pool":this.crmType;Object(d.f)({types:"crm_"+n,field:i.property,width:e}).then(function(e){}).catch(function(){})}},handleSizeChange:function(e){ne.a.set("crmPageSizes",e),this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currentPage=e,this.getList()},getStatusStyle:function(e){return 0==e?{"border-color":"#E6A23C","background-color":"#FDF6EC",color:"#E6A23C"}:3==e?{"border-color":"#409EFF","background-color":"#ECF5FF",color:"#409EFF"}:1==e?{"border-color":"#67C23A","background-color":"#F0F9EB",color:"#67C23A"}:2==e?{"border-color":"#F56C6B","background-color":"#FEF0F0",color:"#F56C6B"}:4==e||5==e?{"background-color":"#FFFFFF"}:6==e?{"border-color":"#E9E9EB","background-color":"#F4F4F5",color:"#909399"}:void 0},getStatusName:function(e){return 0==e?"Đang chờ xử lý":1==e?"bởi":2==e?"Từ chối":3==e?"Đang xem xét":4==e?"Rút lại":5==e?"Chưa gửi":6==e?"Hủy":""},updateTableHeight:function(){var e=document.documentElement.clientHeight,t=n()(this.filterObj).length>0?310:240;this.tableHeight=e-t},exportData:function(e){this.$refs.listHead.handleTypeDrop("out",e)}},beforeDestroy:function(){}}},l4ns:function(e,t,i){},mTTq:function(e,t,i){"use strict";var a=i("UllR");i.n(a).a},mcAI:function(e,t,i){},migV:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkJGNkIxREZBNDE2NTExRTlBQkY1RjdBNzY2QThDRUY2IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkJGNkIxREZCNDE2NTExRTlBQkY1RjdBNzY2QThDRUY2Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QkY2QjFERjg0MTY1MTFFOUFCRjVGN0E3NjZBOENFRjYiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QkY2QjFERjk0MTY1MTFFOUFCRjVGN0E3NjZBOENFRjYiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7u8NAUAAABfklEQVR42qSVsUoDQRCG5y5imfo0gk0C9la+RYQY4gOENNokkOALCBqIFlrlBYJBjfgaimCbKxSUpE4phDg/zJLd2wmnuR9+WHZmv9ud25sLFo0GKdpkl8UH7G32D/uL/cZ+ZD/JnKMNBXbIvmQXlYfsiY/ZMbvDfrCTQmucY19IQpHShZx7WZPTdnjObtP/ZdZ07B1W1oTZ0IoBojZXTrhQIGq1iPJ5fynmEEOOq2uwADxi7zihWo2oVCJqNl0oxphDDDmu8IRqKFfDVb9PNJ0SRdESamCYQww5vsoB38MPHuyqR7MBkBn3ekSzmQb8xA4jtcxYgIVmp+kwaCvUbnsWAThRI8kjJ2uqawLgeyoMx7SPvxr6AuDIm67X/Zola4ocXyMAh9JFlhoMiMZj/wUYKGLIcfUNViDtC5f7LuP7qAJovmXsspsB1hWG077O2DdrwG5lrdcP5+xT6RrxH0CxlOpE1q7s2Giaz5KM7r0vH74p/Kv8AobaR/ErwAAhLXvaJ0ohPQAAAABJRU5ErkJggg=="},n5gA:function(e,t,i){"use strict";var a=i("x5wg");i.n(a).a},oWS4:function(e,t,i){"use strict";var a=i("7Qib"),n=i("8GhS"),s=i("eE85"),l=i.n(s),c={name:"Index",components:{XhUserCell:n.p,XhProuctCate:n.j,VDistpicker:l.a},props:{dialogVisible:{type:Boolean,required:!0,default:!1},fieldList:{type:Array,required:!0,default:function(){return[]}},obj:{type:Object,required:!0,default:function(){return{}}},crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1}},data:function(){return{form:[],visible:!1,showErrors:!1,saveChecked:!1,saveDefault:!1,saveName:null}},watch:{dialogVisible:{handler:function(e){e&&(this.form=Object(a.k)(this.obj.form),0==this.form.length&&this.form.push({fieldName:"",name:"",formType:"",condition:"is",value:"",typeOption:[],statusOption:[],typeId:"",statusId:"",address:{state:"",city:"",area:""}}),this.saveChecked=!1,this.saveDefault=!1,this.saveName=null),this.visible=this.dialogVisible},deep:!0,immediate:!0},form:function(){this.$nextTick(function(){var e=document.getElementById("filter-container");e.scrollTop=e.scrollHeight})}},methods:{selectProvince:function(e,t){t.address.state=e.value},selectCity:function(e,t){t.address.city=e.value},selectArea:function(e,t){t.address.area=e.value},typeOptionsChange:function(e){if(e.typeId){var t=e.typeOption.find(function(t){return t.typeId===e.typeId});e.statusOption=t.statusList||[]}else e.statusOption=[];e.statusId=""},arrayValueChange:function(e){e.value.length>0?(e.item.value=e.value,e.item.valueContent=e.valueContent):e.item.value=[]},showCalCondition:function(e){return"date"!=e&&"datetime"!=e&&"business_type"!=e&&"category"!=e&&"map_address"!=e},calConditionOptions:function(e,t){return"select"==e||"checkbox"==e||"user"==e||"checkStatus"==e?[{value:"is",label:"bằng",disabled:!1},{value:"isNot",label:"không bằng",disabled:!1}]:"module"==e||"text"==e||"textarea"==e?[{value:"is",label:"bằng",disabled:!1},{value:"isNot",label:"không bằng",disabled:!1},{value:"contains",label:"chứa",disabled:!1},{value:"notContains",label:"không chứa",disabled:!1}]:"floatnumber"==e||"number"==e?[{value:"is",label:"bằng",disabled:!1},{value:"isNot",label:"không bằng",disabled:!1},{value:"contains",label:"chứa",disabled:!1},{value:"notContains",label:"không chứa",disabled:!1},{value:"isNull",label:"rỗng",disabled:!1},{value:"isNotNull",label:"không rỗng",disabled:!1},{value:"gt",label:"lớn hơn",disabled:!1},{value:"egt",label:"lớn hơn hoặc bằng",disabled:!1},{value:"lt",label:"nhỏ hơn",disabled:!1},{value:"elt",label:"nhỏ hơn hoặc bằng",disabled:!1}]:"category"==e?[{value:"is",label:"bằng",disabled:!1},{value:"isnot",label:"không bằng",disabled:!1},{value:"contains",label:"chứa",disabled:!1},{value:"not_contain",label:"không chứa",disabled:!1}]:[{value:"is",label:"bằng",disabled:!1},{value:"isNot",label:"không bằng",disabled:!1},{value:"contains",label:"chứa",disabled:!1},{value:"notContains",label:"không chứa",disabled:!1},{value:"startWith",label:"bắt đầu từ ngày",disabled:!1},{value:"endWith",label:"kết thức vào ngày",disabled:!1},{value:"isNull",label:"rỗng",disabled:!1},{value:"isNotNull",label:"không rỗng",disabled:!1},{value:"gt",label:"lớn hơn",disabled:!1},{value:"egt",label:"lớn hơn hoặc bằng",disabled:!1},{value:"lt",label:"nhỏ hơn",disabled:!1},{value:"elt",label:"nhỏ hơn hoặc bằng",disabled:!1}]},fieldChange:function(e){var t=this.fieldList.find(function(t){return t.fieldName===e.fieldName});t&&(e.formType=t.formType,e.name=t.name,"business_type"==e.formType?(e.typeOption=t.setting,e.statusOption=[],e.typeId="",e.statusId="",e.value=""):"select"==e.formType||"checkStatus"==e.formType?(e.setting=t.setting||[],e.value=""):"map_address"==e.formType?e.address={state:"",city:"",area:""}:"date"===e.formType||"datetime"===e.formType||"user"===e.formType||"category"===e.formType?e.value=[]:e.value=""),this.form.filter(function(t){return t.fieldName===e.fieldName}).length>1?this.showErrors=!0:this.showErrors=!1},handleCancel:function(){this.$emit("update:dialogVisible",!1)},handleConfirm:function(){if(this.showErrors)this.$message.error("Có sự trùng lắp trong bộ lọc!");else if(!this.saveChecked||this.saveName&&""!==this.saveName){for(var e=0;e<this.form.length;e++){var t=this.form[e];if(!t.fieldName||""===t.fieldName)return void this.$message.error("Tên trường được lọc không được để trống!");if("business_type"==t.formType){if(!t.typeId&&!t.statusId)return void this.$message.error("Vui lòng nhập giá trị của tiêu chí lọc!")}else if("map_address"==t.formType){if(!t.address.state&&!t.address.city&&!t.address.area)return void this.$message.error("Vui lòng chọn giá trị của tiêu chí bộ lọc!")}else if("date"==t.formType||"datetime"==t.formType||"user"==t.formType||"category"==t.formType){if(!t.value||0===t.value.length)return void this.$message.error("Vui lòng chọn giá trị của tiêu chí bộ lọc!")}else if(!t.value&&0!==t.value)return void this.$message.error("Vui lòng nhập giá trị của tiêu chí lọc!")}var i={};this.form.forEach(function(e){if("datetime"==e.formType||"date"==e.formType)i[e.fieldName]={start:e.value[0],end:e.value[1],formType:e.formType,name:e.fieldName};else if("business_type"==e.formType)i[e.fieldName]={typeId:e.typeId,statusId:e.statusId,formType:e.formType,name:e.fieldName};else if("user"==e.formType)i[e.fieldName]={condition:e.condition,value:e.value[0].userId,formType:e.formType,name:e.fieldName};else if("category"==e.formType)i[e.fieldName]={condition:"is",value:e.value[e.value.length-1],formType:e.formType,name:e.fieldName};else if("map_address"==e.formType){var t="";for(var a in e.address)e.address[a]&&(t+=e.address[a]+",");i[e.fieldName]={value:t,formType:e.formType,name:e.fieldName}}else i[e.fieldName]={condition:e.condition,value:e.value,formType:e.formType,name:e.fieldName}});var a={obj:i,form:this.form,saveChecked:this.saveChecked,saveDefault:this.saveDefault,saveName:this.saveName};this.$emit("filter",a)}else this.$message.error("Tên kịch bảng không được để trống!")},handleAdd:function(){this.form.push({fieldName:"",condition:"is",value:"",formType:"",setting:[],typeOption:[],statusOption:[],typeId:"",statusId:""})},handleDelete:function(e){var t=this;this.$confirm("Bạn có chắc chắn muốn xóa phần dữ liệu này không?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){t.form.splice(e,1)}).catch(function(){t.$message({type:"info",message:"Không thành công"})})}}},o=(i("YsaG"),i("KHd+")),r=Object(o.a)(c,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{visible:e.visible,title:"Bộ lọc",width:"900px"},on:{"update:visible":function(t){e.visible=t},close:e.handleCancel}},[i("div",{staticStyle:{"margin-bottom":"10px"}},[e._v("Điều kiện lọc")]),e._v(" "),i("el-form",{staticClass:"filter-container",attrs:{id:"filter-container"}},[i("el-form-item",[e._l(e.form,function(t,a){return[i("el-row",{key:a},[i("el-col",{attrs:{span:8}},[i("el-select",{attrs:{placeholder:"Vui lòng chọn tên trường sẽ được lọc"},on:{change:function(i){e.fieldChange(t)}},model:{value:t.fieldName,callback:function(i){e.$set(t,"fieldName",i)},expression:"formItem.fieldName"}},e._l(e.fieldList,function(e){return i("el-option",{key:e.fieldName,attrs:{label:e.name,value:e.fieldName}})}))],1),e._v(" "),e.showCalCondition(t.formType)?i("el-col",{attrs:{span:1}},[e._v(" ")]):e._e(),e._v(" "),e.showCalCondition(t.formType)?i("el-col",{attrs:{span:4}},[i("el-select",{attrs:{placeholder:"Vui lòng chọn điều kiện lọc"},model:{value:t.condition,callback:function(i){e.$set(t,"condition",i)},expression:"formItem.condition"}},e._l(e.calConditionOptions(t.formType,t),function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1):e._e(),e._v(" "),"business_type"==t.formType?i("el-col",{attrs:{span:1}},[e._v(" ")]):e._e(),e._v(" "),"business_type"==t.formType?i("el-col",{attrs:{span:4}},[i("el-select",{attrs:{placeholder:"Chọn"},on:{change:function(i){e.typeOptionsChange(t)}},model:{value:t.typeId,callback:function(i){e.$set(t,"typeId",i)},expression:"formItem.typeId"}},e._l(t.typeOption,function(e){return i("el-option",{key:e.typeId,attrs:{label:e.name,value:e.typeId}})}))],1):e._e(),e._v(" "),i("el-col",{attrs:{span:1}},[e._v(" ")]),e._v(" "),i("el-col",{attrs:{span:"datetime"===t.formType||"date"===t.formType||"map_address"===t.formType?13:8}},["select"===t.formType?i("el-select",{attrs:{placeholder:"Vui lòng chọn tiêu chí bộ lọc"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"formItem.value"}},e._l(t.setting,function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})):"checkStatus"===t.formType?i("el-select",{attrs:{placeholder:"Vui lòng chọn tiêu chí bộ lọc"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"formItem.value"}},e._l(t.setting,function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})):"date"===t.formType||"datetime"===t.formType?i("el-date-picker",{staticStyle:{padding:"0px 10px"},attrs:{"value-format":"date"===t.formType?"yyyy-MM-dd":"yyyy-MM-dd HH:mm:ss",type:"date"===t.formType?"daterange":"datetimerange","range-separator":"-","start-placeholder":"Ngày bắt đầu","end-placeholder":"Ngày kết thúc"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"formItem.value"}}):"business_type"===t.formType?i("el-select",{attrs:{placeholder:"Vui lòng chọn"},model:{value:t.statusId,callback:function(i){e.$set(t,"statusId",i)},expression:"formItem.statusId"}},e._l(t.statusOption,function(e){return i("el-option",{key:e.statusId,attrs:{label:e.name,value:e.statusId}})})):"user"===t.formType?i("xh-user-cell",{attrs:{item:t,"info-params":{m:"crm",c:e.crmType,a:"index"}},on:{"value-change":e.arrayValueChange}}):"category"===t.formType?i("xh-prouct-cate",{attrs:{item:t},on:{"value-change":e.arrayValueChange}}):"map_address"===t.formType?i("v-distpicker",{attrs:{province:t.address.state,city:t.address.city,area:t.address.area},on:{province:function(i){e.selectProvince(i,t)},city:function(i){e.selectCity(i,t)},area:function(i){e.selectArea(i,t)}}}):i("el-input",{attrs:{placeholder:"Vui lòng nhập tiêu chí bộ lọc"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"formItem.value"}})],1),e._v(" "),i("el-col",{staticClass:"delete",attrs:{span:1}},[i("i",{staticClass:"el-icon-error delete-btn",on:{click:function(t){e.handleDelete(a)}}})])],1)]})],2)],1),e._v(" "),i("p",{directives:[{name:"show",rawName:"v-show",value:e.showErrors,expression:"showErrors"}],staticClass:"el-icon-warning warning-info"},[i("span",{staticClass:"desc"},[e._v("Có các sự trùng lắp trong bộ lọc!")])]),e._v(" "),i("el-button",{attrs:{type:"text"},on:{click:e.handleAdd}},[e._v("+ Thêm bộ lọc")]),e._v(" "),e.isSeas?e._e():i("div",{staticClass:"save"},[i("el-checkbox",{model:{value:e.saveChecked,callback:function(t){e.saveChecked=t},expression:"saveChecked"}},[e._v("Lưu kịch bản")]),e._v(" "),i("el-input",{directives:[{name:"show",rawName:"v-show",value:e.saveChecked,expression:"saveChecked"}],staticClass:"name",attrs:{maxlength:10,placeholder:"Vui lòng nhập tên kịch bản, tối đa 10 ký tự"},model:{value:e.saveName,callback:function(t){e.saveName="string"==typeof t?t.trim():t},expression:"saveName"}}),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.saveChecked,expression:"saveChecked"}],staticClass:"save-setting"},[i("el-checkbox",{model:{value:e.saveDefault,callback:function(t){e.saveDefault=t},expression:"saveDefault"}},[e._v("Đặt làm mặc định")])],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.handleCancel}},[e._v("Hủy")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("Lưu")])],1)],1)},[],!1,null,"e623702a",null);r.options.__file="index.vue";t.a=r.exports},ppJE:function(e,t,i){"use strict";var a=i("vG5h"),n=i("Ew9n"),s=i("F03V"),l=i("UEWd"),c=i("QJC7"),o=i("8KPp"),r=i("gd5k"),d=i("aQg/"),h=i("y9lt"),u=i("i68b"),m={name:"CustomerFollow",components:{MixAdd:l.a,RecordLog:c.a,JournalLog:o.a,ExamineLog:r.a,TaskLog:d.a,ScheduleLog:h.a},mixins:[u.a],props:{id:[String,Number],crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1}},data:function(){return{sendLoading:!1,nextTime:"",isEvent:!1,logType:"record"}},computed:{logTypes:function(){return this.oa?[{type:"record",name:"Hồ sơ theo dõi"},{type:"log",name:"Nhật ký"},{type:"examine",name:"Đề xuất"},{type:"task",name:"Công việc"},{type:"schedule",name:"Lịch biểu"}]:[{type:"record",name:"Hồ sơ theo dõi"}]},componentsName:function(){return"record"==this.logType?"RecordLog":"log"==this.logType?"JournalLog":"examine"==this.logType?"ExamineLog":"task"==this.logType?"TaskLog":"schedule"==this.logType?"ScheduleLog":""}},watch:{id:function(e){}},mounted:function(){},activated:function(){},deactivated:function(){},methods:{handleTypeDrop:function(e){this.followType=e},logTabsClick:function(e,t){this.logType=e.type},sendInfo:function(){this.$refs.mixadd.$emit("submit-info")},submitInfo:function(e){var t=this;if(!this.isEvent||this.nextTime)if(e.content){var i={};i.typesId=this.id,i.content=e.content,i.category=this.followType;var n=e.business.map(function(e,t,i){return e.businessId}),s=e.contacts.map(function(e,t,i){return e.contactsId});i.batchId=e.batchId,i.businessIds=n.join(","),i.contactsIds=s.join(","),i.isEvent=this.isEvent?1:0,i.nextTime=this.nextTime||"",this.sendLoading=!0,Object(a.w)(i).then(function(e){t.sendLoading=!1,t.$message.success("Thành công"),t.$refs.mixadd.resetInfo(),t.isEvent=!1,t.nextTime="",t.$bus.emit("follow-log-refresh",{type:"record-log"})}).catch(function(){t.sendLoading=!1})}else this.$message.error("Vui lòng nhập nội dung tiếp theo");else this.$message.error("Vui lòng chọn thời gian liên hệ tiếp theo")}}},p=(i("R8hg"),i("KHd+")),f=Object(p.a)(m,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"f-container"},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.sendLoading,expression:"sendLoading"}]},[i("mix-add",{ref:"mixadd",attrs:{"crm-type":e.crmType,id:e.id,"show-relative-business":!0,"show-relative-contacts":!0},on:{"mixadd-info":e.submitInfo}}),e._v(" "),i("flexbox",{staticClass:"se-section"},[i("div",{staticClass:"se-name"},[e._v("Cách liên lạc")]),e._v(" "),i("el-dropdown",{staticStyle:{"margin-right":"20px"},attrs:{trigger:"click"},on:{command:e.handleTypeDrop}},[i("flexbox",{staticClass:"se-select"},[i("div",{staticClass:"se-select-name"},[e._v(e._s(e.followType?e.followType:"Chọn"))]),e._v(" "),i("i",{staticClass:"el-icon-arrow-down el-icon--right",staticStyle:{color:"#ccc"}})]),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.followTypes,function(t,a){return i("el-dropdown-item",{key:a,attrs:{command:t.type}},[e._v(e._s(t.name))])}))],1),e._v(" "),i("div",{staticClass:"se-name"},[e._v("Lần liên hệ tiếp theo")]),e._v(" "),i("el-date-picker",{staticClass:"se-datepicker",attrs:{"default-value":new Date,editable:!1,type:"datetime",placeholder:"Chọn","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.nextTime,callback:function(t){e.nextTime=t},expression:"nextTime"}}),e._v(" "),e.showOAPermission?i("el-checkbox",{model:{value:e.isEvent,callback:function(t){e.isEvent=t},expression:"isEvent"}},[e._v("Thêm vào lời nhắc lịch trình làm việc")]):e._e(),e._v(" "),i("el-button",{staticClass:"se-send",attrs:{type:"primary"},nativeOn:{click:function(t){return e.sendInfo(t)}}},[e._v("Gởi")])],1)],1),e._v(" "),i("div",{staticClass:"log-cont"},[i("flexbox",{staticStyle:{"border-bottom":"1px solid #E6E6E6"}},e._l(e.logTypes,function(t,a){return i("flexbox",{key:a,staticStyle:{width:"auto"},nativeOn:{click:function(i){e.logTabsClick(t,a)}}},[i("div",{staticClass:"log-tabs-item",style:{color:e.logType==t.type?"#F18C70":"#777"}},[e._v(e._s(t.name))]),e._v(" "),e.logTypes.length-1!=a?i("div",{staticClass:"log-tabs-line"}):e._e()])})),e._v(" "),i("keep-alive",[i(e.componentsName,{tag:"component",attrs:{id:e.id,"crm-type":e.crmType}})],1)],1)])},[],!1,null,"1fc36098",null);f.options.__file="CustomerFollow.vue";var v=f.exports,g=i("U05J"),b=i("/U9q"),y=i("5j45"),C=i("cYid"),w=i("+NTD"),I=i("C+sD"),k=i("8DbX"),T=i("DUlf"),x=i("EgJF"),_=i("4+0Q"),A={name:"CustomerDetail",components:{SlideView:n.a,CustomerFollow:v,CRMDetailHead:s.a,CRMBaseInfo:g.a,RelativeContacts:b.a,RelativeBusiness:y.a,RelativeContract:C.a,RelativeReturnMoney:w.a,RelativeFiles:I.a,RelativeHandle:k.a,RelativeTeam:T.a,CRMCreateView:x.default},mixins:[_.a],props:{id:[String,Number],listenerIDs:{type:Array,default:function(){return["crm-main-container"]}},noListenerIDs:{type:Array,default:function(){return[]}},noListenerClass:{type:Array,default:function(){return["el-table__body"]}}},data:function(){return{loading:!1,crmType:"customer",detailData:{},headDetails:[{title:"Cấp bậc khách hàng",value:""},{title:"Trạng thái giao dịch",value:""},{title:"Người thanh toán",value:""},{title:"Ngày cập nhật",value:""}],tabCurrentName:"followlog",isCreate:!1}},computed:{tabName:function(){return"followlog"==this.tabCurrentName?"customer-follow":"basicinfo"==this.tabCurrentName?"c-r-m-base-info":"contacts"==this.tabCurrentName?"relative-contacts":"team"==this.tabCurrentName?"relative-team":"business"==this.tabCurrentName?"relative-business":"contract"==this.tabCurrentName?"relative-contract":"returnedmoney"==this.tabCurrentName?"relative-return-money":"file"==this.tabCurrentName?"relative-files":"operationlog"==this.tabCurrentName?"relative-handle":""},tabnames:function(){var e=[];return e.push({label:"Hồ sơ theo dõi",name:"followlog"}),this.crm.customer&&this.crm.customer.read&&e.push({label:"Thông tin cơ bản",name:"basicinfo"}),this.crm.contacts&&this.crm.contacts.index&&e.push({label:"Thông tin liên hệ",name:"contacts"}),e.push({label:"Đội nhóm",name:"team"}),this.crm.business&&this.crm.business.index&&e.push({label:"Mối quan hệ kinh doanh",name:"business"}),this.crm.contract&&this.crm.contract.index&&e.push({label:"Hợp đồng",name:"contract"}),this.crm.receivables&&this.crm.receivables.index&&e.push({label:"Thông tin thanh toán",name:"returnedmoney"}),e.push({label:"Đính kèm",name:"file"}),e.push({label:"Lịch sử",name:"operationlog"}),e},isSeasDetail:function(){return this.detailData&&this.detailData.hasOwnProperty("isPool")?1==this.detailData.isPool:this.isSeas}},mounted:function(){},methods:{getDetial:function(){var e=this;this.loading=!0,Object(a.t)({customerId:this.id}).then(function(t){e.loading=!1,e.detailData=t.data,e.headDetails[0].value=t.data.客户级别,e.headDetails[1].value=1==t.data.dealStatus?"Chốt deal":"Chưa bán",e.headDetails[2].value=t.data.ownerUserName,e.headDetails[3].value=t.data.updateTime}).catch(function(){e.loading=!1})},hideView:function(){this.$emit("hide-view")},handleClick:function(e,t){},editSaveSuccess:function(){this.$emit("handle",{type:"save-success"}),this.getDetial()}}},D=(i("mTTq"),Object(p.a)(A,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("slide-view",{directives:[{name:"empty",rawName:"v-empty",value:!e.canShowDetail,expression:"!canShowDetail"}],attrs:{"listener-ids":e.listenerIDs,"no-listener-ids":e.noListenerIDs,"no-listener-class":e.noListenerClass,"body-style":{padding:0,height:"100%"},"xs-empty-icon":"nopermission","xs-empty-text":"Không có quyền"},on:{"side-close":e.hideView}},[e.canShowDetail?i("flexbox",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"d-container",attrs:{direction:"column",align:"stretch"}},[i("c-r-m-detail-head",{attrs:{"is-seas":e.isSeasDetail,detail:e.detailData,"head-details":e.headDetails,id:e.id,"crm-type":"customer"},on:{handle:e.detailHeadHandle,close:e.hideView}}),e._v(" "),i("div",{staticClass:"tabs"},[i("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.tabCurrentName,callback:function(t){e.tabCurrentName=t},expression:"tabCurrentName"}},e._l(e.tabnames,function(e,t){return i("el-tab-pane",{key:t,attrs:{label:e.label,name:e.name}})}))],1),e._v(" "),i("div",{staticClass:"t-loading-content",attrs:{id:"follow-log-content"}},[i("keep-alive",[i(e.tabName,{tag:"component",attrs:{detail:e.detailData,id:e.id,"is-seas":e.isSeasDetail,"crm-type":"customer"}})],1)],1)],1):e._e(),e._v(" "),e.isCreate?i("c-r-m-create-view",{attrs:{action:{type:"update",id:e.id,batchId:e.detailData.batchId},"crm-type":"customer"},on:{"save-success":e.editSaveSuccess,"hiden-view":function(t){e.isCreate=!1}}}):e._e()],1)},[],!1,null,"1d978e83",null));D.options.__file="CustomerDetail.vue";t.a=D.exports},qThd:function(e,t,i){},"qd/y":function(e,t,i){},rl4O:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjUzM0EzN0E0RTA5QjExRTg4MTZEOEM2ODYxNjE5QjM3IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjUzM0EzN0E1RTA5QjExRTg4MTZEOEM2ODYxNjE5QjM3Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTMzQTM3QTJFMDlCMTFFODgxNkQ4QzY4NjE2MTlCMzciIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTMzQTM3QTNFMDlCMTFFODgxNkQ4QzY4NjE2MTlCMzciLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7neeY0AAABL0lEQVR42syUv0tCURSA1Vzam5ya+h8ag5DG3GpqqsAiwVFoECJc+jGpCFZrLTpFUjQ7PPwjClxyiCY3+y6cB5fLud0rOXjhG965j++de865L5skSWaRK5dZ8JpHmIUG/MAA1v4jNLIWVKAO6/CmSWOFO3AAJbiCLVjVpLHCV9iAF3ke+6S5wDFr8Az78Ons29LHkNDImnAO3/AAZeU9I+3AZhrI/9EAU7Nd6egIbuEJJk5tL2RPzVCTpfGZ0qieZF/TMvTJzmT+TqzsbFnZ/pidYUORHcKNzF87JHMzPJXUB1ZsBY6gGyNzhUM4lhEYS6ztqZkqc4+8B1N4h4LSgH5I5gq/YFuRprL7kEwbm4kjrYrsLkbmuymp9AMu4VpGZhZz6fOeuJEWl+KP/SvAAHR5UyjSji44AAAAAElFTkSuQmCC"},rq0Q:function(e,t,i){"use strict";var a=i("71zx");i.n(a).a},s9Sa:function(e,t,i){"use strict";var a=i("1AAk");i.n(a).a},so1z:function(e,t,i){"use strict";var a=i("/BxL");i.n(a).a},svWA:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkE1NUY2OTMzRjEzRTExRTg4NDAxQkEzQkYwMjU3REExIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkE1NUY2OTM0RjEzRTExRTg4NDAxQkEzQkYwMjU3REExIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QTU1RjY5MzFGMTNFMTFFODg0MDFCQTNCRjAyNTdEQTEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QTU1RjY5MzJGMTNFMTFFODg0MDFCQTNCRjAyNTdEQTEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz70mGn0AAABSElEQVR42qyUsUoDQRRFs4tNsFTU2h8QQQQtVPwCm0UtBFE/wCJfIQrBWlBIYWQbDVgqaKEQLGItsRQU00Xtsp6RuyBhXtzFfXB2hpk7l30zbyZIkqRUZAy5TxzH/zaKouinDY15N74ODXiDRG1D49Y678QkNOEAWjKYVtvSeFM6f8p9ZvdwCUvQ7Zu/gj04lG4Onq0/dP0zuIAtj1kaXc2fSx9ahmswAbsZz8HpxrXOa7gBx/CZ0fALTrTOazgDNzmr5RamrEMZVWmkMajiA7WvMGIZvsOYZ9GgcHvYsVJ+gMWcKS/Ao2VYg00oZzQrS1+zDOvak2pGw6r0dWsPe6qpO/Ur8OExGoZ9WIF5ac2r15bI3YAnOIJrHZirgmXYgRfp2n/d5dR0Flb1IGzLrKODqyjNXpbH4Xf6pyJXBEW/2GGp4PgWYAAHtEsSK3MhmAAAAABJRU5ErkJggg=="},t8nM:function(e,t,i){"use strict";i.r(t);var a=i("JXju"),n=i("kegP"),s={name:"ContractIndex",components:{CRMAllDetail:a.a},mixins:[n.a],data:function(){return{crmType:"contract",moneyData:null}},computed:{moneyPageData:function(){if(0==this.selectionList.length&&this.moneyData)return this.moneyData;for(var e=0,t=0,i=0;i<this.selectionList.length;i++){var a=this.selectionList[i];1==a.checkStatus&&(e+=parseFloat(a.money),t+=parseFloat(a.receivedMoney))}return{contractMoney:e.toFixed(2),receivedMoney:t.toFixed(2)}}},mounted:function(){},methods:{cellStyle:function(e){e.row;var t=e.column;e.rowIndex,e.columnIndex;return"num"===t.property||"customerName"===t.property||"businessName"===t.property||"contactsName"===t.property?{color:"#3E84E9",cursor:"pointer"}:""},genTableHeader:function(e){return(e=e.toLowerCase()).charAt(0).toUpperCase()+e.slice(1)}}},l=(i("jCyC"),i("KHd+")),c=Object(l.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("c-r-m-list-head",{ref:"listHead",attrs:{search:e.search,"crm-type":e.crmType,title:"Quản lí hợp đồng",placeholder:"Vui lòng nhập tên hợp đồng","main-title":"Liên hệ mới"},on:{"update:search":function(t){e.search=t},"on-handle":e.listHeadHandle,"on-search":e.crmSearch}}),e._v(" "),a("div",{directives:[{name:"empty",rawName:"v-empty",value:!e.crm.contract.index,expression:"!crm.contract.index"}],staticClass:"crm-container",attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"Không có quyền"}},[a("c-r-m-table-head",{ref:"crmTableHead",attrs:{"crm-type":e.crmType},on:{exportData:e.exportData,filter:e.handleFilter,handle:e.handleHandle,scene:e.handleScene}}),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"n-table--border",staticStyle:{width:"100%"},attrs:{id:"crm-table",data:e.list,height:e.tableHeight,"cell-style":e.cellStyle,stripe:"",border:"","highlight-current-row":""},on:{"row-click":e.handleRowClick,"sort-change":e.sortChange,"header-dragend":e.handleHeaderDragend,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"selection",align:"center",width:"55"}}),e._v(" "),e._l(e.fieldList,function(t,i){return a("el-table-column",{key:i,attrs:{fixed:0==i,prop:t.prop,label:e.genTableHeader(t.label),width:150,formatter:e.fieldFormatter,sortable:"custom","show-overflow-tooltip":""},scopedSlots:e._u([{key:"header",fn:function(t){return[a("div",{staticClass:"table-head-name"},[e._v(e._s(t.column.label))])]}}])})}),e._v(" "),a("el-table-column",{attrs:{resizable:!1,"show-overflow-tooltip":"",prop:"checkStatus",label:"Trạng thái",width:"100",align:"center",fixed:"right"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("div",{staticClass:"table-head-name"},[e._v(e._s(t.column.label))])]}},{key:"default",fn:function(t){return[a("div",{staticClass:"status_button",style:e.getStatusStyle(t.row.checkStatus)},[e._v("\n            "+e._s(e.getStatusName(t.row.checkStatus))+"\n          ")])]}}])}),e._v(" "),a("el-table-column"),e._v(" "),a("el-table-column",{attrs:{fixed:"right",width:"36"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("img",{staticClass:"table-set",attrs:{src:i("zbTZ")},on:{click:e.handleTableSet}})]}}])})],2),e._v(" "),a("div",{staticClass:"p-contianer"},[a("el-pagination",{staticClass:"p-bar",attrs:{"current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:pageSize":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),a("span",{staticClass:"money-bar"},[e._v("Tổng số tiền của hợp đồng："+e._s(e.moneyPageData.contractMoney||0)+" / Số tiền đã thanh toán："+e._s(e.moneyPageData.receivedMoney||0))])],1)],1),e._v(" "),a("c-r-m-all-detail",{staticClass:"d-view",attrs:{visible:e.showDview,"crm-type":e.rowType,id:e.rowID},on:{"update:visible":function(t){e.showDview=t},handle:e.handleHandle}}),e._v(" "),a("fields-set",{attrs:{"crm-type":e.crmType,"dialog-visible":e.showFieldSet},on:{"update:dialogVisible":function(t){e.showFieldSet=t},"set-success":e.setSave}})],1)},[],!1,null,"32233942",null);c.options.__file="ContractIndex.vue";t.default=c.exports},tWWo:function(e,t,i){},ta8G:function(e,t,i){},u3Hk:function(e,t,i){},uumG:function(e,t,i){"use strict";var a=i("LEQn");i.n(a).a},vPra:function(e,t,i){"use strict";i.d(t,"c",function(){return n}),i.d(t,"a",function(){return s}),i.d(t,"b",function(){return l});var a=i("t3Un");function n(e){return Object(a.a)({url:"comment/setComment",method:"post",data:e})}function s(e){return Object(a.a)({url:"comment/deleteComment",method:"post",data:e})}function l(e){return Object(a.a)({url:"comment/queryCommentList",method:"post",data:e})}},vkES:function(e,t,i){"use strict";var a=i("x333");i.n(a).a},w1wW:function(e,t,i){},wlfA:function(e,t,i){"use strict";var a=i("5X97");i.n(a).a},woiz:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjhGQTE4Q0EzRjM4ODExRThCNjlDOEQxMEUxMzYwREE0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjhGQTE4Q0E0RjM4ODExRThCNjlDOEQxMEUxMzYwREE0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OEZBMThDQTFGMzg4MTFFOEI2OUM4RDEwRTEzNjBEQTQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OEZBMThDQTJGMzg4MTFFOEI2OUM4RDEwRTEzNjBEQTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4R34ZtAAABfUlEQVR42pzUPUsDQRDG8eTQVBZiQhqxU6KoWKiFhaAQ21gqQcXGTxDFSsRKBOMXsBGi+NLFlBYighbmClGLgFZiE1+wECGd/4HnZDmSIA78uNzN7LC3t5touVyOhKINS5jGIDrwgTsUsYsvd4AXapBFBaPIoxdRXfN6XlHdb7Q4v9exgAz8UPNXlGQYJ+jBhtskqwZjqEaah6+6azxh39MabGPmDw2CqKp+B+3WZBHnCFb4UuqFm7P6M8x5WoNCqDjaZBZuzsZlbE36nVlYjDdpEM7dYsBmksBb5H/xjrinHwknUUOswaCY8kHEbbw1uceIk3jWHqgX9vzFuR/CgzU5xbyTONTGqxdroY9g44rWZA+Tzmw20Ykj9KFVV7vvwpbqrH4q2Gx2mFZUlMQ30jojJeVLuk8rn1R9Dp/Btj9AN660E329Ur3XsrNzrNcqhA+gHaZHrdGF1sbX549r+rOYwKq9RqO/AptRCjdY1n9ITV8wp02ZchtY/AgwAM3YV79CKIEGAAAAAElFTkSuQmCC"},"wu/m":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkJFRDI1M0Q1NDE2NTExRTk4NTFFODEzNjdCN0UzRTFCIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkJFRDI1M0Q2NDE2NTExRTk4NTFFODEzNjdCN0UzRTFCIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QkVEMjUzRDM0MTY1MTFFOTg1MUU4MTM2N0I3RTNFMUIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QkVEMjUzRDQ0MTY1MTFFOTg1MUU4MTM2N0I3RTNFMUIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4ZL3N5AAABQklEQVR42mJ0O3ueAQtgA+IAKLYEYikg/gXET4AYpGE9EG+EiqEAFiyGBQJxFxCrYLFEA4ojgfgOEJcD8TpkRUxIbGYg7oQqUGEgDEBq1kL1MGNzYRsQlzGQDmB6ypFdGEKmYciGhsAMBIVNPz7VvWqqYEwATACZBfJyKBDL4FOpw8NNjCulgTiMCZo0qAUCQAaaUtFAE5CXJbCFGTZv7jQygLOvfPnKUHzrNroSSSZsqZ0YwIhDHOTC50DMiyyIbjPMZe7nLhCy5znIhZeoGIZnQAZuoKKBG0AGroaWIjgBKAKuAjEB8BRkFgs0UoqAeBUulVhiExsoBOKfsLwMcmU3BV7thpqBUnxVAvEUMgybCtWLUR7+BeJcaKlxhwiD7kDLgRyoXpwlNqjQ3AxVDCq9jaEZHxbwZ6FVwGpsmQIgwAD7IEenGBpwRwAAAABJRU5ErkJggg=="},x333:function(e,t,i){},x5wg:function(e,t,i){},x6i0:function(e,t,i){"use strict";var a=i("u3Hk");i.n(a).a},"xSw/":function(e,t,i){},"xfX+":function(e,t,i){"use strict";var a=i("6zBA"),n=i("Ew9n"),s=i("F03V"),l=i("UEWd"),c=i("QJC7"),o=i("8KPp"),r=i("gd5k"),d=i("aQg/"),h=i("y9lt"),u=i("i68b"),m={name:"ContractFollow",components:{MixAdd:l.a,RecordLog:c.a,JournalLog:o.a,ExamineLog:r.a,TaskLog:d.a,ScheduleLog:h.a},mixins:[u.a],props:{id:[String,Number],crmType:{type:String,default:""}},data:function(){return{sendLoading:!1,nextTime:"",isEvent:!1,logType:"record"}},computed:{logTypes:function(){return this.oa?[{type:"record",name:"Bản ghi"},{type:"log",name:"Nhật ký"},{type:"examine",name:"Để xuất"},{type:"task",name:"Công việc"},{type:"schedule",name:"Lịch biểu"}]:[{type:"record",name:"Bản ghi"}]},componentsName:function(){return"record"==this.logType?"RecordLog":"log"==this.logType?"JournalLog":"examine"==this.logType?"ExamineLog":"task"==this.logType?"TaskLog":"schedule"==this.logType?"ScheduleLog":""}},mounted:function(){},activated:function(){},deactivated:function(){},methods:{handleTypeDrop:function(e){this.followType=e},logTabsClick:function(e,t){this.logType=e.type},sendInfo:function(){this.$refs.mixadd.$emit("submit-info")},submitInfo:function(e){var t=this;if(!this.isEvent||this.nextTime)if(e.content){var i={};i.typesId=this.id,i.content=e.content,i.category=this.followType,i.batchId=e.batchId,i.isEvent=this.isEvent?1:0,i.nextTime=this.nextTime||"",this.sendLoading=!0,Object(a.k)(i).then(function(e){t.sendLoading=!1,t.$message.success("Thành công"),t.$refs.mixadd.resetInfo(),t.isEvent=!1,t.nextTime="",t.$bus.emit("follow-log-refresh",{type:"record-log"})}).catch(function(){t.sendLoading=!1})}else this.$message.error("Vui lòng nhập nội dung tiếp theo");else this.$message.error("Vui lòng chọn thời gian liên hệ tiếp theo")}}},p=(i("e9ks"),i("KHd+")),f=Object(p.a)(m,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"f-container"},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.sendLoading,expression:"sendLoading"}]},[i("mix-add",{ref:"mixadd",attrs:{"crm-type":e.crmType,id:e.id},on:{"mixadd-info":e.submitInfo}}),e._v(" "),i("flexbox",{staticClass:"se-section"},[i("div",{staticClass:"se-name"},[e._v("Cách liên lạc")]),e._v(" "),i("el-dropdown",{staticStyle:{"margin-right":"20px"},attrs:{trigger:"click"},on:{command:e.handleTypeDrop}},[i("flexbox",{staticClass:"se-select"},[i("div",{staticClass:"se-select-name"},[e._v(e._s(e.followType?e.followType:"Vui lòng chọn"))]),e._v(" "),i("i",{staticClass:"el-icon-arrow-down el-icon--right",staticStyle:{color:"#ccc"}})]),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.followTypes,function(t,a){return i("el-dropdown-item",{key:a,attrs:{command:t.type}},[e._v(e._s(t.name))])}))],1),e._v(" "),i("div",{staticClass:"se-name"},[e._v("Lần liên hệ tiếp theo")]),e._v(" "),i("el-date-picker",{staticClass:"se-datepicker",attrs:{"default-value":new Date,editable:!1,type:"datetime",placeholder:"Chọn","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.nextTime,callback:function(t){e.nextTime=t},expression:"nextTime"}}),e._v(" "),e.showOAPermission?i("el-checkbox",{model:{value:e.isEvent,callback:function(t){e.isEvent=t},expression:"isEvent"}},[e._v("Thêm vào lời nhắc lịch trình làm việc")]):e._e(),e._v(" "),i("el-button",{staticClass:"se-send",attrs:{type:"primary"},nativeOn:{click:function(t){return e.sendInfo(t)}}},[e._v("Gởi")])],1)],1),e._v(" "),i("div",{staticClass:"log-cont"},[i("flexbox",{staticStyle:{"border-bottom":"1px solid #E6E6E6"}},e._l(e.logTypes,function(t,a){return i("flexbox",{key:a,staticStyle:{width:"auto"},nativeOn:{click:function(i){e.logTabsClick(t,a)}}},[i("div",{staticClass:"log-tabs-item",style:{color:e.logType==t.type?"#F18C70":"#777"}},[e._v(e._s(t.name))]),e._v(" "),e.logTypes.length-1!=a?i("div",{staticClass:"log-tabs-line"}):e._e()])})),e._v(" "),i("keep-alive",[i(e.componentsName,{tag:"component",attrs:{id:e.id,"crm-type":e.crmType}})],1)],1)])},[],!1,null,"3fbaf602",null);f.options.__file="ContractFollow.vue";var v=f.exports,g=i("U05J"),b=i("8DbX"),y=i("DUlf"),C=i("SE13"),w=i("+NTD"),I=i("C+sD"),k=i("3biH"),T=i("EgJF"),x=i("4+0Q"),_={name:"ContractDetail",components:{SlideView:n.a,CRMDetailHead:s.a,ContractFollow:v,CRMBaseInfo:g.a,RelativeHandle:b.a,RelativeTeam:y.a,RelativeProduct:C.a,RelativeReturnMoney:w.a,RelativeFiles:I.a,ExamineInfo:k.a,CRMCreateView:T.default},mixins:[x.a],props:{id:[String,Number],listenerIDs:{type:Array,default:function(){return["crm-main-container"]}},noListenerIDs:{type:Array,default:function(){return[]}},noListenerClass:{type:Array,default:function(){return["el-table__body"]}}},data:function(){return{loading:!1,crmType:"contract",detailData:{},headDetails:[{title:"Mã hợp đồng",value:""},{title:"Tên khách hàng",value:""},{title:"Số tiền hợp đồng (đồng)",value:""},{title:"Thời gian ký kết",value:""},{title:"Số tiền đã thanh toán (đồng)",value:""},{title:"Người thanh toán",value:""}],tabCurrentName:"followlog",isCreate:!1}},computed:{tabName:function(){return"followlog"==this.tabCurrentName?"contract-follow":"basicinfo"==this.tabCurrentName?"c-r-m-base-info":"team"==this.tabCurrentName?"relative-team":"contract"==this.tabCurrentName?"relative-contract":"operationlog"==this.tabCurrentName?"relative-handle":"product"==this.tabCurrentName?"relative-product":"returnedmoney"==this.tabCurrentName?"relative-return-money":"file"==this.tabCurrentName?"relative-files":""},tabnames:function(){var e=[];return e.push({label:"Hồ sơ theo dõi",name:"followlog"}),this.crm.contract&&this.crm.contract.read&&e.push({label:"Thông tin cơ bản",name:"basicinfo"}),this.crm.product&&this.crm.product.index&&e.push({label:"Sản phẩm",name:"product"}),this.crm.receivables&&this.crm.receivables.index&&e.push({label:"Số tiền đã thanh toán",name:"returnedmoney"}),e.push({label:"Nhóm",name:"team"}),e.push({label:"Đính kèm",name:"file"}),e.push({label:"Nhật ký",name:"operationlog"}),e}},mounted:function(){},methods:{getDetial:function(){var e=this;this.loading=!0,Object(a.i)({contractId:this.id}).then(function(t){e.loading=!1,e.detailData=t.data,e.headDetails[0].value=t.data.num,e.headDetails[1].value=t.data.customerName,e.headDetails[2].value=e.moneyFormat(t.data.money),e.headDetails[3].value=t.data.orderDate,e.headDetails[4].value=e.moneyFormat(t.data.receivablesMoney),e.headDetails[5].value=t.data.ownerUserName}).catch(function(){e.loading=!1})},hideView:function(){this.$emit("hide-view")},handleClick:function(e,t){},editSaveSuccess:function(){this.$emit("handle",{type:"save-success"}),this.getDetial()}}},A=(i("N99G"),Object(p.a)(_,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("slide-view",{directives:[{name:"empty",rawName:"v-empty",value:!e.canShowDetail,expression:"!canShowDetail"}],attrs:{"listener-ids":e.listenerIDs,"no-listener-ids":e.noListenerIDs,"no-listener-class":e.noListenerClass,"body-style":{padding:0,height:"100%"},"xs-empty-icon":"nopermission","xs-empty-text":"Không có quyền"},on:{"side-close":e.hideView}},[e.canShowDetail?i("flexbox",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"d-container",attrs:{direction:"column",align:"stretch"}},[i("c-r-m-detail-head",{attrs:{detail:e.detailData,"head-details":e.headDetails,id:e.id,"crm-type":"contract"},on:{handle:e.detailHeadHandle,close:e.hideView}}),e._v(" "),i("div",{staticClass:"examine-info"},[i("examine-info",{staticClass:"examine-info-border",attrs:{id:e.id,"record-id":e.detailData.examineRecordId,"owner-user-id":e.detailData.ownerUserId,"examine-type":"crm_contract"}})],1),e._v(" "),i("div",{staticClass:"tabs"},[i("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.tabCurrentName,callback:function(t){e.tabCurrentName=t},expression:"tabCurrentName"}},e._l(e.tabnames,function(e,t){return i("el-tab-pane",{key:t,attrs:{label:e.label,name:e.name}})}))],1),e._v(" "),i("div",{staticClass:"t-loading-content",attrs:{id:"follow-log-content"}},[i("keep-alive",[i(e.tabName,{tag:"component",attrs:{detail:e.detailData,id:e.id,"crm-type":"contract"}})],1)],1)],1):e._e(),e._v(" "),e.isCreate?i("c-r-m-create-view",{attrs:{action:{type:"update",id:e.id,batchId:e.detailData.batchId},"crm-type":"contract"},on:{"save-success":e.editSaveSuccess,"hiden-view":function(t){e.isCreate=!1}}}):e._e()],1)},[],!1,null,"1ad4cca6",null));A.options.__file="ContractDetail.vue";t.a=A.exports},y4JV:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkMwMDM5QTNCNDE2NTExRTk5ODY1RTZGN0EwMzg2MEE4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkMwMDM5QTNDNDE2NTExRTk5ODY1RTZGN0EwMzg2MEE4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QzAwMzlBMzk0MTY1MTFFOTk4NjVFNkY3QTAzODYwQTgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QzAwMzlBM0E0MTY1MTFFOTk4NjVFNkY3QTAzODYwQTgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5ZqqPOAAAB00lEQVR42mJ0O3ueAQtgA+IAKLYEYikg/gXET4AYpGE9EG+EiqEAFiyGBQJxFxCrYLFEA4ojgfgOEJcD8TpkRUxIbGYg7oQqUGEgDEBq1kL1MGNzYRsQlzGQDmB6ypFdGEKmYciGhsAMBIVNPwPlYALILJCBoUAsQwUDpYE4jAmaNEgCMuzsDHO0NBh61DDiLgBkoCkphqlycTH0qqsyyHJwMPz69x9d2gRkoARGYAA1TNdUZxBjY0MRN+TlZehWVWEQYGFhOP7xI0PjvfvoWiWZsKV2kMVKnJwM/UCDFTg5wGK2AgIMLSpKDJzMTAw7375jaLr3gOHnv38YPmAEZr2bQFoNWZCTiYmhVkmRwZiPl+HL378MO968ZQgSE2VgYmRkWPXyFcO8p88Y/mMPkYcgF15CF/0OtLnu7j2Gg+8/MPAwMzOEiIsxMAINm/XkKcNc3IaBwBmQgRuwyfz5/5+h/f4DhvWvXoNd2f3gEcNaIJsA2ADyMijk71IhLT4FYmVYpBRRIWEXAvFPWF5eDcTdFBjWDTUDpfiqBOIpZBg2FaoXozz8C8S50FLjDhEG3YGWAzlQvThLbFChuRmqGFR6G0MzPizgz0KrgNXYMgVAgAEAQ6R42TeJ/UsAAAAASUVORK5CYII="},y9lt:function(e,t,i){"use strict";var a=i("FyfS"),n=i.n(a),s=i("KzkL"),l={name:"FollowScheduleCell",components:{},filters:{getRemindtypeText:function(e){switch(e){case 0:return"Không";case 1:return"Nhắc nhở đúng giờ";case 2:return"Trước 5 phút";case 3:return"Trước 15 phút";case 4:return"Trước 30 phút";case 5:return"Trước 1 giờ";case 6:return"Trước 2 giờ";case 7:return"Trước 1 ngày";case 8:return"Trước 2 ngày";case 9:return"Trước 1 tuần"}return""}},props:{data:Object},data:function(){return{}},computed:{},mounted:function(){},methods:{checkRelatedDetail:function(e,t){this.$emit("on-handle",{type:"related-detail",data:{type:e,item:t}})},handleCommand:function(e){this.$emit("on-handle",{type:e,data:{item:this.data}})}}},c=(i("0T5w"),i("KHd+")),o=Object(c.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fl-c"},[a("flexbox",{staticClass:"fl-h"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:e.data.createUser,expression:"data.createUser"},{name:"lazy",rawName:"v-lazy:background-image",value:e.$options.filters.filterUserLazyImg(e.data.createUser.img),expression:"$options.filters.filterUserLazyImg(data.createUser.img)",arg:"background-image"}],staticClass:"div-photo fl-h-img"}),e._v(" "),a("div",{staticClass:"fl-h-b"},[a("div",{staticClass:"fl-h-name"},[e._v(e._s(e.data.createUser.realname))]),e._v(" "),a("div",{staticClass:"fl-h-time"},[e._v(e._s(e.data.createTime))])]),e._v(" "),!e.data.permission||1!=e.data.permission.isUpdate&&1!=e.data.permission.isDelete?e._e():a("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},[a("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD"}}),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e.data.permission&&1==e.data.permission.isUpdate?a("el-dropdown-item",{attrs:{command:"edit"}},[e._v("Chỉnh sửa")]):e._e(),e._v(" "),e.data.permission&&1==e.data.permission.isDelete?a("el-dropdown-item",{attrs:{command:"delete"}},[e._v("Xóa")]):e._e()],1)],1)],1),e._v(" "),a("div",{staticClass:"fl-b"},[a("div",[a("div",{staticClass:"state-color",style:{"background-color":e.data.color?e.data.color:"#fff"}}),e._v(e._s(e.data.title)+"\n    ")]),e._v(" "),a("div",{staticClass:"fl-b-des"},[a("flexbox",{staticClass:"fl-b-des-item"},[a("div",{staticClass:"fl-b-des-item-name"},[e._v("Người tham gia:")]),e._v(" "),a("div",{staticClass:"owner-list"},e._l(e.data.ownerList,function(t,i){return a("span",{key:i},[a("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",[e._v(e._s(t.realname))])]),e._v(" "),a("div",{directives:[{name:"photo",rawName:"v-photo",value:t,expression:"k"},{name:"lazy",rawName:"v-lazy:background-image",value:e.$options.filters.filterUserLazyImg(t.img),expression:"$options.filters.filterUserLazyImg(k.img)",arg:"background-image"}],key:t.img,staticClass:"div-photo header-circle"})])],1)}))]),e._v(" "),a("flexbox",{staticClass:"fl-b-des-item"},[a("div",{staticClass:"fl-b-des-item-name"},[e._v("Thời gian bắt đầu:")]),e._v(" "),a("div",[e._v(e._s(e.data.startTime))])]),e._v(" "),a("flexbox",{staticClass:"fl-b-des-item"},[a("div",{staticClass:"fl-b-des-item-name"},[e._v("Thời gian kết thúc:")]),e._v(" "),a("div",[e._v(e._s(e.data.endTime))])]),e._v(" "),a("flexbox",{staticClass:"fl-b-des-item"},[a("div",{staticClass:"fl-b-des-item-name"},[e._v("Mô tả:")]),e._v(" "),a("div",[e._v(e._s(e.data.remark))])])],1),e._v(" "),e.data.contactsList.length>0||e.data.customerList.length>0||e.data.businessList.length>0||e.data.contractList.length>0?a("div",{staticClass:"related-business"},[a("div",{staticClass:"label"},[e._v("Cơ hội kinh doanh liên quan")]),e._v(" "),e._l(e.data.contactsList,function(t,n){return a("p",{key:"contacts"+n,on:{click:function(i){e.checkRelatedDetail("contacts",t)}}},[a("img",{attrs:{src:i("AFlK"),alt:""}}),e._v("\n        Người liên hệ-"+e._s(t.name)+"\n      ")])}),e._v(" "),e._l(e.data.customerList,function(t,n){return a("p",{key:"customer"+n,on:{click:function(i){e.checkRelatedDetail("customer",t)}}},[a("img",{attrs:{src:i("AFlK"),alt:""}}),e._v("\n        Khách hàng-"+e._s(t.customerName)+"\n      ")])}),e._v(" "),e._l(e.data.businessList,function(t,n){return a("p",{key:"business"+n,on:{click:function(i){e.checkRelatedDetail("business",t)}}},[a("img",{attrs:{src:i("AFlK"),alt:""}}),e._v("\n        Kinh doanh-"+e._s(t.businessName)+"\n      ")])}),e._v(" "),e._l(e.data.contractList,function(t,n){return a("p",{key:"contract"+n,on:{click:function(i){e.checkRelatedDetail("contract",t)}}},[a("img",{attrs:{src:i("AFlK"),alt:""}}),e._v("\n        Hợp đồng-"+e._s(t.name)+"\n      ")])})],2):e._e()])],1)},[],!1,null,"54d48002",null);o.options.__file="FollowScheduleCell.vue";var r=o.exports,d=i("Dh/N"),h={name:"ScheduleLog",components:{FollowScheduleCell:r,CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-660d"),i.e("chunk-4b7d"),i.e("chunk-7962")]).then(i.bind(null,"uMjE"))},CreateSchedule:i("BuGm").default},props:{id:[String,Number],crmType:{type:String,default:""}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[],showFullDetail:!1,detailCRMType:"",rowID:"",showDialog:!1,formData:{checkList:[]},newtext:""}},computed:{},watch:{id:function(e){this.refreshList()}},mounted:function(){var e=this,t=document.getElementById("follow-log-content");t.onscroll=function(){var i=t.scrollTop+t.clientHeight-t.scrollHeight;Math.abs(i)<10&&1==e.loadMoreLoading&&(e.isPost?e.loadMoreLoading=!1:(e.isPost=!0,e.page++,e.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var e=this;this.loading=!0;var t={page:this.page,limit:10};t[this.crmType+"Ids"]=this.id,Object(s.j)(t).then(function(t){e.list=e.list.concat(t.data.list),t.data.list.length<10?e.loadMoreLoading=!1:e.loadMoreLoading=!0,e.loading=!1,e.isPost=!1}).catch(function(){e.isPost=!1,e.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},examineCellHandle:function(e){var t=this;if("edit"==e.type){this.newText="Chỉnh sửa lịch biểu";var i=e.data.item;i.startTime=i.startTime,i.endTime=i.endTime,i.ownerUserIds=[];var a=!0,s=!1,l=void 0;try{for(var c,o=n()(i.ownerList);!(a=(c=o.next()).done);a=!0){var r=c.value;i.ownerUserIds.push(r.userId)}}catch(e){s=!0,l=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw l}}this.formData=i,this.showDialog=!0}else"delete"==e.type?this.$confirm("Xác nhận xóa?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){Object(d.b)({eventId:e.data.item.eventId}).then(function(e){t.refreshList(),t.$message({type:"success",message:"Thành công!"})})}).catch(function(){t.$message({type:"info",message:"Không thành công"})}):"related-detail"==e.type&&(this.rowID=e.data.item[e.data.type+"Id"],this.detailCRMType=e.data.type,this.showFullDetail=!0)},onSubmit:function(e,t){this.refreshList(),this.newText,this.$message.success("Thành công"),this.showDialog=!1}}},u=(i("bH4c"),Object(c.a)(h,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:0===e.list.length,expression:"list.length === 0"}]},[i("div",{staticClass:"log-items"},[e._l(e.list,function(t,a){return i("follow-schedule-cell",{key:a,attrs:{data:t},on:{"on-handle":e.examineCellHandle}})}),e._v(" "),i("div",{staticClass:"load"},[i("el-button",{attrs:{loading:e.loadMoreLoading,type:"text"}},[e._v(e._s(e.loadMoreLoading?"Tải thêm":"Không có dữ liệu"))])],1)],2)]),e._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:e.showFullDetail,"crm-type":e.detailCRMType,id:e.rowID},on:{"update:visible":function(t){e.showFullDetail=t}}}),e._v(" "),e.showDialog?i("create-schedule",{attrs:{text:e.newText,"form-data":e.formData,"append-to-body":!0},on:{onSubmit:e.onSubmit,closeDialog:function(t){e.showDialog=!1}}}):e._e()],1)},[],!1,null,"fa4e4034",null));u.options.__file="ScheduleLog.vue";t.a=u.exports},ySAc:function(e,t,i){},zbTZ:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjdGRTgyQUFEQzBBMzExRTg4RTlCRTNDNzA5Q0RDRTJBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjdGRTgyQUFFQzBBMzExRTg4RTlCRTNDNzA5Q0RDRTJBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6N0ZFODJBQUJDMEEzMTFFODhFOUJFM0M3MDlDRENFMkEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6N0ZFODJBQUNDMEEzMTFFODhFOUJFM0M3MDlDRENFMkEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7S8sG0AAABaklEQVR42qyUPUsDQRCG94IgGAiagELsU6WxUmITEKwEQYJop6U2/gTxH1gldrFWEASrQDgbP4oDmzR2WqQ4IQiBCAcWviOzsA5zeyf6wtPMx8vu7dwEURQZj7pgT8TOwX5aQ8H4taDE5n0NruG0yDXAstKzwjmj9VrDWfAKQtACl+AOlBXDMueoZod7XtjDTHHRCV+PaJp8ajHG8TiiE9bBofm7yKNOJzx1Tqrpg69IWgUzKXXfXnTCicesD2pgnalxLE0TMtxMufIIbIGhExtybKTUH5CXfeVQKeiBsRIfc04qzDPYv5Y11EaFvllJiZc4J9W0htegoxRUwBVYdGJVjlWU+jPyoqcuem6wBp7F2PjqiwG2DQ32U8Ys5tEnWKIrD0D7H96DPAb2UY5BDG7BLv/4WboA29wTs4cJnAVLKygR6+sGzAmjd7AB7sX6SuQcJqKRGh6Vkz0Isx+9WYMdK7E3X8OXAAMApsZGDBJcTHwAAAAASUVORK5CYII="}}]);