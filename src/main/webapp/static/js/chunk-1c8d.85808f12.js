(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1c8d"],{"+9th":function(t,e,a){"use strict";a.d(e,"k",function(){return n}),a.d(e,"a",function(){return r}),a.d(e,"d",function(){return o}),a.d(e,"e",function(){return l}),a.d(e,"g",function(){return i}),a.d(e,"h",function(){return c}),a.d(e,"b",function(){return u}),a.d(e,"f",function(){return d}),a.d(e,"c",function(){return f}),a.d(e,"j",function(){return h}),a.d(e,"i",function(){return m});var s=a("t3Un");function n(t){return Object(s.a)({url:"task/queryTaskList",method:"post",data:t})}function r(t){return Object(s.a)({url:"task/setTask",method:"post",data:t})}function o(t){return Object(s.a)({url:"task/deleteTask",method:"post",data:t})}function l(t){return Object(s.a)({url:"task/queryTaskInfo",method:"post",data:t})}function i(t){return Object(s.a)({url:"task/setTask",method:"post",data:t})}function c(t){return Object(s.a)({url:"task/saveTaskRelation",method:"post",data:t})}function u(t){return Object(s.a)({url:"taskLabel/setLabel",method:"post",data:t})}function d(t){return Object(s.a)({url:"taskLabel/setLabel",method:"post",data:t})}function f(t){return Object(s.a)({url:"taskLabel/deleteLabel",method:"post",data:t})}function h(t){return Object(s.a)({url:"taskLabel/getLabelList",method:"post",data:t})}function m(t){return Object(s.a)({url:"task/queryWorkTaskLog",method:"post",data:t})}},"1RnH":function(t,e,a){"use strict";var s=a("QbLZ"),n=a.n(s),r=a("+9th"),o=a("mkuN"),l=a("Er7M"),i=a("7Qib"),c=a("L2JU"),u={components:{CrmRelative:o.a,RelatedBusinessCell:l.a},props:{marginLeft:{type:String,default:"20px"},allData:{type:Object,default:function(){return{contacts:[],customer:[],business:[],contract:[]}}},isTask:{type:Boolean,default:!1},taskID:Number,alterable:{type:Boolean,default:!0},alterableColor:{type:String,default:"#999"}},data:function(){return{showTypes:["customer","contacts","business","contract"],showPopover:!1,relevanceAll:{customerIds:[],contractIds:[],contactsIds:[],businessIds:[]},relatedListData:{},showRelative:!1,showTaskRelative:!1}},computed:n()({},Object(c.b)(["crm"]),{showCRMPermission:function(){return this.crm}}),watch:{allData:function(){this.relatedListData=this.allData}},mounted:function(){this.relatedListData=this.allData},methods:{crmrelativeClose:function(){this.showPopover=!1},checkInfos:function(t){var e=this;this.showPopover=!1,this.relatedListData=t.data;var a=function(a){var s=t.data[a];e.relevanceAll[a+"Ids"]=s.map(function(t,e,s){return t[a+"Id"]})};for(var s in t.data)a(s);this.$emit("checkInfos",this.relevanceAll)},delRelevance:function(t,e,a){var s=this;this.$confirm("Xác nhận xóa?","Thông báo",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning",customClass:"is-particulars"}).then(function(){var a={taskId:s.taskID},n=Object(i.k)(s.relatedListData);n[t].splice(e,1);for(var o=function(t){var e=s.showTypes[t],r=n[e]||[];a[e+"Ids"]=r.map(function(t){return t[e+"Id"]}).join(",")},l=0;l<s.showTypes.length;l++)o(l);Object(r.h)(a).then(function(a){s.relatedListData[t].splice(e,1),s.relatedListData=Object(i.k)(s.relatedListData),s.$message.success("Thành công")}).catch(function(){})}).catch(function(){s.$message.info("Không thành công")})},checkRelatedDetail:function(t,e){e.key=e[t+"Id"],this.$emit("checkRelatedDetail",t,e)}}},d=(a("uumG"),a("KHd+")),f=Object(d.a)(u,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"related-business",style:{"margin-left":t.marginLeft}},[!t.isTask&&t.alterable?s("el-popover",{attrs:{placement:"bottom",width:"800","popper-class":"no-padding-popover",trigger:"click"},model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}},[t.showRelative?s("crm-relative",{ref:"crmrelative",attrs:{show:t.showPopover,radio:!1,"selected-data":t.relatedListData,"show-types":t.showTypes},on:{close:t.crmrelativeClose,changeCheckout:t.checkInfos}}):t._e(),t._v(" "),t.showCRMPermission?s("p",{staticClass:"add-file",attrs:{slot:"reference"},on:{click:function(e){t.showRelative=!0}},slot:"reference"},[s("img",{attrs:{src:a("AFlK"),alt:""}}),t._v("\n      Cơ hội kinh doanh liên quan\n    ")]):t._e()],1):t._e(),t._v(" "),t.alterable?t._e():s("p",{staticClass:"alterable-p",style:{color:t.alterableColor}},[t._v("Cơ hội kinh doanh liên quan")]),t._v(" "),t._l(t.relatedListData,function(e,a){return s("div",{key:a},t._l(e,function(e,n){return s("related-business-cell",{key:n,attrs:{data:e,"cell-index":n,type:a,"show-foot":t.isTask},on:{unbind:t.delRelevance,detail:function(s){t.checkRelatedDetail(a,e)}}})}))}),t._v(" "),t.isTask?s("el-popover",{attrs:{placement:"bottom",width:"800","popper-class":"no-padding-popover",trigger:"click"},model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}},[t.showTaskRelative?s("crm-relative",{ref:"crmrelative",attrs:{radio:!1,show:t.showPopover,"selected-data":t.relatedListData,"show-types":t.showTypes},on:{close:t.crmrelativeClose,changeCheckout:t.checkInfos}}):t._e(),t._v(" "),t.showCRMPermission?s("p",{staticClass:"add-file",attrs:{slot:"reference"},on:{click:function(e){t.showTaskRelative=!0}},slot:"reference"},[s("img",{attrs:{src:a("AFlK"),alt:""}}),t._v("\n      Liên kết\n    ")]):t._e()],1):t._e()],2)},[],!1,null,"bcec8706",null);f.options.__file="relatedBusiness.vue";e.a=f.exports},BuGm:function(t,e,a){"use strict";a.r(e);var s=a("gDS+"),n=a.n(s),r=a("FyfS"),o=a.n(r),l=a("Dh/N"),i=a("1RnH"),c=a("0hym"),u=a("7Qib"),d={components:{relatedBusiness:i.a,XhUser:c.a},props:{formData:{type:Object,default:function(){return{color:""}}},text:{type:String,default:"Tạo lịch biểu"},appendToBody:{type:Boolean,default:!1}},data:function(){var t=this,e=function(e,a,s){t.formData.startTime&&t.formData.endTime&&Object(u.e)(t.formData.startTime)>=Object(u.e)(t.formData.endTime)&&s(new Error("Thời gian bắt đầu phải nhỏ hơn thời gian kết thúc")),s()};return{zIndex:Object(u.h)(),formList:[{label:"Tên",field:"title",type:"color"},{label:"Giờ bắt đầu",field:"startTime",type:"time"},{label:"Giờ kết thức",field:"endTime",type:"time"},{label:"Người tham dự",field:"ownerUserIds",type:"participant"},{label:"Mô tả",field:"remark",type:"textarea",width:"100%"}],options:[{value:0,label:"Không nhắc"},{value:1,label:"Nhắc đúng giờ"},{value:2,label:"Nhắc trước 5 phút"},{value:3,label:"Nhắc trước 15 phút"},{value:4,label:"Nhắc trước 30 phút"},{value:5,label:"Nhắc trước 1 giờ"},{value:6,label:"Nhắc trước 2 giờ"},{value:7,label:"Nhắc trước 1 ngày"},{value:8,label:"Nhắc trước 2 ngày"},{value:9,label:"Nhắc trước 1 tuần"}],fileList:[],loading:!1,colorList:["#3E8EF7","#11C06C","#0BB2D4","#EB6709","#FF4C52","#526069","#9262F4"],rules:{title:[{required:!0,message:"Tên không được trống",trigger:"blur"},{max:50,message:"Tên tối đa 50 ký tự",trigger:"blur"}],startTime:[{required:!0,message:"Phải chọn giờ bắt đầu",trigger:"blur"},{validator:e,trigger:"blur"}],endTime:[{required:!0,message:"Phải chọn giờ kết thúc",trigger:"blur"},{validator:e,trigger:"blur"}]},relevanceAll:{},allData:{},colleaguesList:[]}},created:function(){},mounted:function(){this.appendToBody&&document.body.appendChild(this.$el),this.allData.business=this.formData.businessList?this.formData.businessList:[],this.allData.contacts=this.formData.contactsList?this.formData.contactsList:[],this.allData.contract=this.formData.contractList?this.formData.contractList:[],this.allData.customer=this.formData.customerList?this.formData.customerList:[],this.formData.ownerList&&(this.colleaguesList=[].concat(this.formData.ownerList)),"Tạo lịch biểu"==this.text&&this.$set(this.formData,"color","#3E8EF7")},beforeDestroy:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},methods:{close:function(){1==this.$route.query.routerKey?this.$router.go(-1):this.$emit("closeDialog")},checkInfos:function(t){this.relevanceAll=t},onSubmit:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return!1;t.loading=!0;var a=t.formData,s=[],r=!0,i=!1,c=void 0;try{for(var u,d=o()(t.colleaguesList);!(r=(u=d.next()).done);r=!0){var f=u.value;s.push(f.userId)}}catch(t){i=!0,c=t}finally{try{!r&&d.return&&d.return()}finally{if(i)throw c}}if("Tạo lịch biểu"==t.text)Object(l.a)({title:a.title,startTime:a.startTime,endTime:a.endTime,ownerUserIds:s.join(","),remark:a.remark,color:a.color,customerIds:t.relevanceAll.customerIds?t.relevanceAll.customerIds.join(","):[],contactsIds:t.relevanceAll.contactsIds?t.relevanceAll.contactsIds.join(","):[],businessIds:t.relevanceAll.businessIds?t.relevanceAll.businessIds.join(","):[],contractIds:t.relevanceAll.contractIds?t.relevanceAll.contractIds.join(","):[]}).then(function(e){1==t.$route.query.routerKey?t.$router.push("schedule"):t.$emit("onSubmit"),t.loading=!1}).catch(function(){t.loading=!1});else{var h={customerIds:[],contractIds:[],contactsIds:[],businessIds:[]};if(t.allData.customer){var m=!0,p=!1,v=void 0;try{for(var b,g=o()(t.allData.customer);!(m=(b=g.next()).done);m=!0){var k=b.value;h.customerIds.push(k.customerId)}}catch(t){p=!0,v=t}finally{try{!m&&g.return&&g.return()}finally{if(p)throw v}}}if(t.allData.contract){var y=!0,D=!1,I=void 0;try{for(var w,L=o()(t.allData.contract);!(y=(w=L.next()).done);y=!0){var C=w.value;h.contractIds.push(C.contractId)}}catch(t){D=!0,I=t}finally{try{!y&&L.return&&L.return()}finally{if(D)throw I}}}if(t.allData.contacts){var T=!0,_=!1,j=void 0;try{for(var x,O=o()(t.allData.contacts);!(T=(x=O.next()).done);T=!0){var $=x.value;h.contactsIds.push($.contactsId)}}catch(t){_=!0,j=t}finally{try{!T&&O.return&&O.return()}finally{if(_)throw j}}}if(t.allData.business){var R=!0,A=!1,N=void 0;try{for(var P,B=o()(t.allData.business);!(R=(P=B.next()).done);R=!0){var E=P.value;h.businessIds.push(E.businessId)}}catch(t){A=!0,N=t}finally{try{!R&&B.return&&B.return()}finally{if(A)throw N}}}var q="{}"==n()(t.relevanceAll)?h:t.relevanceAll;Object(l.c)({eventId:a.eventId,title:a.title,startTime:a.startTime,endTime:a.endTime,ownerUserIds:s.join(","),remark:a.remark,color:a.color,customerIds:q.customerIds.join(","),contactsIds:q.contactsIds.join(","),businessIds:q.businessIds.join(","),contractIds:q.contractIds.join(",")}).then(function(e){t.$emit("onSubmit"),t.loading=!1}).catch(function(){t.loading=!1})}})},httpRequest:function(t){this.fileList.push(t.file)},onRemove:function(t){for(var e in this.fileList)this.fileList[e].uid==t.uid&&this.fileList.splice(e,1)},changeColor:function(t){this.$set(this.formData,"color",t)},changeCheckout:function(t){this.colleaguesList=t.data},selectDelect:function(t,e){this.$refs.xhuser[0].cancelCheckItem(t),this.colleaguesList.splice(e,1)}}},f=(a("h+C4"),a("KHd+")),h=Object(f.a)(d,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"create-schedule",style:{"z-index":t.zIndex}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"add-schedule"},[s("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[s("span",{staticClass:"text"},[t._v(t._s(t.text))]),t._v(" "),s("img",{staticClass:"el-icon-close rt",attrs:{src:a("cjwK"),alt:""},on:{click:t.close}})]),t._v(" "),s("div",{staticClass:"content"},[s("el-form",{ref:"form",attrs:{model:t.formData,rules:t.rules}},t._l(t.formList,function(e,a){return s("el-form-item",{key:a,class:"el-form-item-"+e.field,style:{width:e.width},attrs:{prop:e.field,label:e.label}},["time"==e.type?[s("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"Chọn"},model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}})]:"textarea"==e.type?[s("el-input",{attrs:{autosize:{minRows:6},type:"textarea",placeholder:"Vui lòng nhập nội dung"},model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}})]:"participant"==e.type?[s("el-popover",{attrs:{placement:"bottom-end",width:"280",trigger:"click"}},[s("xh-user",{ref:"xhuser",refInFor:!0,attrs:{"selected-data":t.colleaguesList},on:{changeCheckout:t.changeCheckout}}),t._v(" "),s("div",{staticClass:"select-box",attrs:{slot:"reference"},slot:"reference"},[t._l(t.colleaguesList,function(e,a){return s("span",{key:a,staticClass:"select-box-span"},[t._v("\n                  "+t._s(e.realname)+"\n                  "),s("span",{staticClass:"el-icon-close",on:{click:function(s){s.stopPropagation(),t.selectDelect(e,a)}}})])}),t._v(" "),s("span",{staticClass:"el-icon-plus"})],2)],1)]:"select"==e.type?[s("el-select",{attrs:{placeholder:"Chọn"},model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}},t._l(t.options,function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))]:"color"==e.type?[s("el-input",{attrs:{placeholder:"Vui lòng nhập nội dung"},model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}},[s("i",{staticClass:"el-input__icon",attrs:{slot:"prefix"},slot:"prefix"},[s("span",{staticClass:"bg-color",style:{background:t.formData.color}})])]),t._v(" "),s("div",{staticClass:"color-box"},t._l(t.colorList,function(e,a){return s("span",{key:a,style:{background:e},on:{click:function(a){t.changeColor(e)}}})}))]:s("el-input",{model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}})],2)})),t._v(" "),s("related-business",{attrs:{"all-data":t.allData},on:{checkInfos:t.checkInfos}})],1),t._v(" "),s("div",{staticClass:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("Lưu")]),t._v(" "),s("el-button",{on:{click:t.close}},[t._v("Hủy")])],1)])])},[],!1,null,"4bb86ca4",null);h.options.__file="createSchedule.vue";e.default=h.exports},"Dh/N":function(t,e,a){"use strict";a.d(e,"d",function(){return n}),a.d(e,"a",function(){return r}),a.d(e,"b",function(){return o}),a.d(e,"c",function(){return l});var s=a("t3Un");function n(t){return Object(s.a)({url:"OaEvent/queryList",method:"post",data:t})}function r(t){return Object(s.a)({url:"OaEvent/add",method:"post",data:t})}function o(t){return Object(s.a)({url:"OaEvent/delete",method:"post",data:t})}function l(t){return Object(s.a)({url:"OaEvent/update",method:"post",data:t})}},LEQn:function(t,e,a){},"h+C4":function(t,e,a){"use strict";var s=a("ySAc");a.n(s).a},uumG:function(t,e,a){"use strict";var s=a("LEQn");a.n(s).a},ySAc:function(t,e,a){}}]);